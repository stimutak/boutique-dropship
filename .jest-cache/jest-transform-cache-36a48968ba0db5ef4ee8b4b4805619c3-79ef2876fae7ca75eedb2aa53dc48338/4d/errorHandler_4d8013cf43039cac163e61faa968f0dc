42e8abb9a43fce32d70e3d3760c4734a
const {
  logger
} = require('../utils/logger');

// Custom error class for application errors
class AppError extends Error {
  constructor(message, statusCode, code = null, isOperational = true) {
    super(message);
    this.statusCode = statusCode;
    this.code = code;
    this.isOperational = isOperational;
    this.status = `${statusCode}`.startsWith('4') ? 'fail' : 'error';
    Error.captureStackTrace(this, this.constructor);
  }
}

// Error handling for different error types
const handleCastErrorDB = err => {
  const message = `Invalid ${err.path}: ${err.value}`;
  return new AppError(message, 400, 'INVALID_ID');
};
const handleDuplicateFieldsDB = err => {
  const value = err.errmsg.match(/(["'])(\\?.)*?\1/)[0];
  const message = `Duplicate field value: ${value}. Please use another value!`;
  return new AppError(message, 400, 'DUPLICATE_FIELD');
};
const handleValidationErrorDB = err => {
  const errors = Object.values(err.errors).map(el => el.message);
  const message = `Invalid input data. ${errors.join('. ')}`;
  return new AppError(message, 400, 'VALIDATION_ERROR');
};
const handleJWTError = () => new AppError('Invalid token. Please log in again!', 401, 'INVALID_TOKEN');
const handleJWTExpiredError = () => new AppError('Your token has expired! Please log in again.', 401, 'TOKEN_EXPIRED');

// Send error response in development
const sendErrorDev = (err, req, res) => {
  // Log error details
  logger.error('Error in development:', {
    error: err.message,
    stack: err.stack,
    url: req.originalUrl,
    method: req.method,
    ip: req.ip,
    userAgent: req.get('User-Agent')
  });
  return res.status(err.statusCode).json({
    success: false,
    error: {
      code: err.code,
      message: err.message,
      stack: err.stack,
      details: err
    }
  });
};

// Send error response in production
const sendErrorProd = (err, req, res) => {
  // Log error details
  logger.error('Production error:', {
    error: err.message,
    code: err.code,
    url: req.originalUrl,
    method: req.method,
    ip: req.ip,
    statusCode: err.statusCode
  });

  // Operational, trusted error: send message to client
  if (err.isOperational) {
    return res.status(err.statusCode).json({
      success: false,
      error: {
        code: err.code,
        message: err.message
      }
    });
  }

  // Programming or other unknown error: don't leak error details
  logger.error('Unknown error:', {
    error: err,
    stack: err.stack
  });
  return res.status(500).json({
    success: false,
    error: {
      code: 'INTERNAL_ERROR',
      message: 'Something went wrong!'
    }
  });
};

// Global error handling middleware
const globalErrorHandler = (err, req, res, next) => {
  err.statusCode = err.statusCode || 500;
  err.status = err.status || 'error';
  if (process.env.NODE_ENV === 'development') {
    sendErrorDev(err, req, res);
  } else {
    let error = {
      ...err
    };
    error.message = err.message;

    // Handle specific error types
    if (error.name === 'CastError') error = handleCastErrorDB(error);
    if (error.code === 11000) error = handleDuplicateFieldsDB(error);
    if (error.name === 'ValidationError') error = handleValidationErrorDB(error);
    if (error.name === 'JsonWebTokenError') error = handleJWTError();
    if (error.name === 'TokenExpiredError') error = handleJWTExpiredError();
    sendErrorProd(error, req, res);
  }
};

// Async error wrapper
const catchAsync = fn => {
  return (req, res, next) => {
    fn(req, res, next).catch(next);
  };
};

// Handle unhandled promise rejections
process.on('unhandledRejection', (err, promise) => {
  logger.error('Unhandled Promise Rejection:', {
    error: err.message,
    stack: err.stack,
    promise: promise
  });

  // Close server gracefully
  process.exit(1);
});

// Handle uncaught exceptions
process.on('uncaughtException', err => {
  logger.error('Uncaught Exception:', {
    error: err.message,
    stack: err.stack
  });

  // Close server gracefully
  process.exit(1);
});
module.exports = {
  AppError,
  globalErrorHandler,
  catchAsync
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJsb2dnZXIiLCJyZXF1aXJlIiwiQXBwRXJyb3IiLCJFcnJvciIsImNvbnN0cnVjdG9yIiwibWVzc2FnZSIsInN0YXR1c0NvZGUiLCJjb2RlIiwiaXNPcGVyYXRpb25hbCIsInN0YXR1cyIsInN0YXJ0c1dpdGgiLCJjYXB0dXJlU3RhY2tUcmFjZSIsImhhbmRsZUNhc3RFcnJvckRCIiwiZXJyIiwicGF0aCIsInZhbHVlIiwiaGFuZGxlRHVwbGljYXRlRmllbGRzREIiLCJlcnJtc2ciLCJtYXRjaCIsImhhbmRsZVZhbGlkYXRpb25FcnJvckRCIiwiZXJyb3JzIiwiT2JqZWN0IiwidmFsdWVzIiwibWFwIiwiZWwiLCJqb2luIiwiaGFuZGxlSldURXJyb3IiLCJoYW5kbGVKV1RFeHBpcmVkRXJyb3IiLCJzZW5kRXJyb3JEZXYiLCJyZXEiLCJyZXMiLCJlcnJvciIsInN0YWNrIiwidXJsIiwib3JpZ2luYWxVcmwiLCJtZXRob2QiLCJpcCIsInVzZXJBZ2VudCIsImdldCIsImpzb24iLCJzdWNjZXNzIiwiZGV0YWlscyIsInNlbmRFcnJvclByb2QiLCJnbG9iYWxFcnJvckhhbmRsZXIiLCJuZXh0IiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwibmFtZSIsImNhdGNoQXN5bmMiLCJmbiIsImNhdGNoIiwib24iLCJwcm9taXNlIiwiZXhpdCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJlcnJvckhhbmRsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBsb2dnZXIgfSA9IHJlcXVpcmUoJy4uL3V0aWxzL2xvZ2dlcicpO1xuXG4vLyBDdXN0b20gZXJyb3IgY2xhc3MgZm9yIGFwcGxpY2F0aW9uIGVycm9yc1xuY2xhc3MgQXBwRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UsIHN0YXR1c0NvZGUsIGNvZGUgPSBudWxsLCBpc09wZXJhdGlvbmFsID0gdHJ1ZSkge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIHRoaXMuc3RhdHVzQ29kZSA9IHN0YXR1c0NvZGU7XG4gICAgdGhpcy5jb2RlID0gY29kZTtcbiAgICB0aGlzLmlzT3BlcmF0aW9uYWwgPSBpc09wZXJhdGlvbmFsO1xuICAgIHRoaXMuc3RhdHVzID0gYCR7c3RhdHVzQ29kZX1gLnN0YXJ0c1dpdGgoJzQnKSA/ICdmYWlsJyA6ICdlcnJvcic7XG5cbiAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTtcbiAgfVxufVxuXG4vLyBFcnJvciBoYW5kbGluZyBmb3IgZGlmZmVyZW50IGVycm9yIHR5cGVzXG5jb25zdCBoYW5kbGVDYXN0RXJyb3JEQiA9IChlcnIpID0+IHtcbiAgY29uc3QgbWVzc2FnZSA9IGBJbnZhbGlkICR7ZXJyLnBhdGh9OiAke2Vyci52YWx1ZX1gO1xuICByZXR1cm4gbmV3IEFwcEVycm9yKG1lc3NhZ2UsIDQwMCwgJ0lOVkFMSURfSUQnKTtcbn07XG5cbmNvbnN0IGhhbmRsZUR1cGxpY2F0ZUZpZWxkc0RCID0gKGVycikgPT4ge1xuICBjb25zdCB2YWx1ZSA9IGVyci5lcnJtc2cubWF0Y2goLyhbXCInXSkoXFxcXD8uKSo/XFwxLylbMF07XG4gIGNvbnN0IG1lc3NhZ2UgPSBgRHVwbGljYXRlIGZpZWxkIHZhbHVlOiAke3ZhbHVlfS4gUGxlYXNlIHVzZSBhbm90aGVyIHZhbHVlIWA7XG4gIHJldHVybiBuZXcgQXBwRXJyb3IobWVzc2FnZSwgNDAwLCAnRFVQTElDQVRFX0ZJRUxEJyk7XG59O1xuXG5jb25zdCBoYW5kbGVWYWxpZGF0aW9uRXJyb3JEQiA9IChlcnIpID0+IHtcbiAgY29uc3QgZXJyb3JzID0gT2JqZWN0LnZhbHVlcyhlcnIuZXJyb3JzKS5tYXAoZWwgPT4gZWwubWVzc2FnZSk7XG4gIGNvbnN0IG1lc3NhZ2UgPSBgSW52YWxpZCBpbnB1dCBkYXRhLiAke2Vycm9ycy5qb2luKCcuICcpfWA7XG4gIHJldHVybiBuZXcgQXBwRXJyb3IobWVzc2FnZSwgNDAwLCAnVkFMSURBVElPTl9FUlJPUicpO1xufTtcblxuY29uc3QgaGFuZGxlSldURXJyb3IgPSAoKSA9PlxuICBuZXcgQXBwRXJyb3IoJ0ludmFsaWQgdG9rZW4uIFBsZWFzZSBsb2cgaW4gYWdhaW4hJywgNDAxLCAnSU5WQUxJRF9UT0tFTicpO1xuXG5jb25zdCBoYW5kbGVKV1RFeHBpcmVkRXJyb3IgPSAoKSA9PlxuICBuZXcgQXBwRXJyb3IoJ1lvdXIgdG9rZW4gaGFzIGV4cGlyZWQhIFBsZWFzZSBsb2cgaW4gYWdhaW4uJywgNDAxLCAnVE9LRU5fRVhQSVJFRCcpO1xuXG4vLyBTZW5kIGVycm9yIHJlc3BvbnNlIGluIGRldmVsb3BtZW50XG5jb25zdCBzZW5kRXJyb3JEZXYgPSAoZXJyLCByZXEsIHJlcykgPT4ge1xuICAvLyBMb2cgZXJyb3IgZGV0YWlsc1xuICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGluIGRldmVsb3BtZW50OicsIHtcbiAgICBlcnJvcjogZXJyLm1lc3NhZ2UsXG4gICAgc3RhY2s6IGVyci5zdGFjayxcbiAgICB1cmw6IHJlcS5vcmlnaW5hbFVybCxcbiAgICBtZXRob2Q6IHJlcS5tZXRob2QsXG4gICAgaXA6IHJlcS5pcCxcbiAgICB1c2VyQWdlbnQ6IHJlcS5nZXQoJ1VzZXItQWdlbnQnKVxuICB9KTtcblxuICByZXR1cm4gcmVzLnN0YXR1cyhlcnIuc3RhdHVzQ29kZSkuanNvbih7XG4gICAgc3VjY2VzczogZmFsc2UsXG4gICAgZXJyb3I6IHtcbiAgICAgIGNvZGU6IGVyci5jb2RlLFxuICAgICAgbWVzc2FnZTogZXJyLm1lc3NhZ2UsXG4gICAgICBzdGFjazogZXJyLnN0YWNrLFxuICAgICAgZGV0YWlsczogZXJyXG4gICAgfVxuICB9KTtcbn07XG5cbi8vIFNlbmQgZXJyb3IgcmVzcG9uc2UgaW4gcHJvZHVjdGlvblxuY29uc3Qgc2VuZEVycm9yUHJvZCA9IChlcnIsIHJlcSwgcmVzKSA9PiB7XG4gIC8vIExvZyBlcnJvciBkZXRhaWxzXG4gIGxvZ2dlci5lcnJvcignUHJvZHVjdGlvbiBlcnJvcjonLCB7XG4gICAgZXJyb3I6IGVyci5tZXNzYWdlLFxuICAgIGNvZGU6IGVyci5jb2RlLFxuICAgIHVybDogcmVxLm9yaWdpbmFsVXJsLFxuICAgIG1ldGhvZDogcmVxLm1ldGhvZCxcbiAgICBpcDogcmVxLmlwLFxuICAgIHN0YXR1c0NvZGU6IGVyci5zdGF0dXNDb2RlXG4gIH0pO1xuXG4gIC8vIE9wZXJhdGlvbmFsLCB0cnVzdGVkIGVycm9yOiBzZW5kIG1lc3NhZ2UgdG8gY2xpZW50XG4gIGlmIChlcnIuaXNPcGVyYXRpb25hbCkge1xuICAgIHJldHVybiByZXMuc3RhdHVzKGVyci5zdGF0dXNDb2RlKS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogZXJyLmNvZGUsXG4gICAgICAgIG1lc3NhZ2U6IGVyci5tZXNzYWdlXG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvLyBQcm9ncmFtbWluZyBvciBvdGhlciB1bmtub3duIGVycm9yOiBkb24ndCBsZWFrIGVycm9yIGRldGFpbHNcbiAgbG9nZ2VyLmVycm9yKCdVbmtub3duIGVycm9yOicsIHtcbiAgICBlcnJvcjogZXJyLFxuICAgIHN0YWNrOiBlcnIuc3RhY2tcbiAgfSk7XG5cbiAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICBlcnJvcjoge1xuICAgICAgY29kZTogJ0lOVEVSTkFMX0VSUk9SJyxcbiAgICAgIG1lc3NhZ2U6ICdTb21ldGhpbmcgd2VudCB3cm9uZyEnXG4gICAgfVxuICB9KTtcbn07XG5cbi8vIEdsb2JhbCBlcnJvciBoYW5kbGluZyBtaWRkbGV3YXJlXG5jb25zdCBnbG9iYWxFcnJvckhhbmRsZXIgPSAoZXJyLCByZXEsIHJlcywgbmV4dCkgPT4ge1xuICBlcnIuc3RhdHVzQ29kZSA9IGVyci5zdGF0dXNDb2RlIHx8IDUwMDtcbiAgZXJyLnN0YXR1cyA9IGVyci5zdGF0dXMgfHwgJ2Vycm9yJztcblxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgICBzZW5kRXJyb3JEZXYoZXJyLCByZXEsIHJlcyk7XG4gIH0gZWxzZSB7XG4gICAgbGV0IGVycm9yID0geyAuLi5lcnIgfTtcbiAgICBlcnJvci5tZXNzYWdlID0gZXJyLm1lc3NhZ2U7XG5cbiAgICAvLyBIYW5kbGUgc3BlY2lmaWMgZXJyb3IgdHlwZXNcbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0Nhc3RFcnJvcicpIGVycm9yID0gaGFuZGxlQ2FzdEVycm9yREIoZXJyb3IpO1xuICAgIGlmIChlcnJvci5jb2RlID09PSAxMTAwMCkgZXJyb3IgPSBoYW5kbGVEdXBsaWNhdGVGaWVsZHNEQihlcnJvcik7XG4gICAgaWYgKGVycm9yLm5hbWUgPT09ICdWYWxpZGF0aW9uRXJyb3InKSBlcnJvciA9IGhhbmRsZVZhbGlkYXRpb25FcnJvckRCKGVycm9yKTtcbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0pzb25XZWJUb2tlbkVycm9yJykgZXJyb3IgPSBoYW5kbGVKV1RFcnJvcigpO1xuICAgIGlmIChlcnJvci5uYW1lID09PSAnVG9rZW5FeHBpcmVkRXJyb3InKSBlcnJvciA9IGhhbmRsZUpXVEV4cGlyZWRFcnJvcigpO1xuXG4gICAgc2VuZEVycm9yUHJvZChlcnJvciwgcmVxLCByZXMpO1xuICB9XG59O1xuXG4vLyBBc3luYyBlcnJvciB3cmFwcGVyXG5jb25zdCBjYXRjaEFzeW5jID0gKGZuKSA9PiB7XG4gIHJldHVybiAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBmbihyZXEsIHJlcywgbmV4dCkuY2F0Y2gobmV4dCk7XG4gIH07XG59O1xuXG4vLyBIYW5kbGUgdW5oYW5kbGVkIHByb21pc2UgcmVqZWN0aW9uc1xucHJvY2Vzcy5vbigndW5oYW5kbGVkUmVqZWN0aW9uJywgKGVyciwgcHJvbWlzZSkgPT4ge1xuICBsb2dnZXIuZXJyb3IoJ1VuaGFuZGxlZCBQcm9taXNlIFJlamVjdGlvbjonLCB7XG4gICAgZXJyb3I6IGVyci5tZXNzYWdlLFxuICAgIHN0YWNrOiBlcnIuc3RhY2ssXG4gICAgcHJvbWlzZTogcHJvbWlzZVxuICB9KTtcbiAgXG4gIC8vIENsb3NlIHNlcnZlciBncmFjZWZ1bGx5XG4gIHByb2Nlc3MuZXhpdCgxKTtcbn0pO1xuXG4vLyBIYW5kbGUgdW5jYXVnaHQgZXhjZXB0aW9uc1xucHJvY2Vzcy5vbigndW5jYXVnaHRFeGNlcHRpb24nLCAoZXJyKSA9PiB7XG4gIGxvZ2dlci5lcnJvcignVW5jYXVnaHQgRXhjZXB0aW9uOicsIHtcbiAgICBlcnJvcjogZXJyLm1lc3NhZ2UsXG4gICAgc3RhY2s6IGVyci5zdGFja1xuICB9KTtcbiAgXG4gIC8vIENsb3NlIHNlcnZlciBncmFjZWZ1bGx5XG4gIHByb2Nlc3MuZXhpdCgxKTtcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgQXBwRXJyb3IsXG4gIGdsb2JhbEVycm9ySGFuZGxlcixcbiAgY2F0Y2hBc3luY1xufTsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU07RUFBRUE7QUFBTyxDQUFDLEdBQUdDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQzs7QUFFN0M7QUFDQSxNQUFNQyxRQUFRLFNBQVNDLEtBQUssQ0FBQztFQUMzQkMsV0FBV0EsQ0FBQ0MsT0FBTyxFQUFFQyxVQUFVLEVBQUVDLElBQUksR0FBRyxJQUFJLEVBQUVDLGFBQWEsR0FBRyxJQUFJLEVBQUU7SUFDbEUsS0FBSyxDQUFDSCxPQUFPLENBQUM7SUFDZCxJQUFJLENBQUNDLFVBQVUsR0FBR0EsVUFBVTtJQUM1QixJQUFJLENBQUNDLElBQUksR0FBR0EsSUFBSTtJQUNoQixJQUFJLENBQUNDLGFBQWEsR0FBR0EsYUFBYTtJQUNsQyxJQUFJLENBQUNDLE1BQU0sR0FBRyxHQUFHSCxVQUFVLEVBQUUsQ0FBQ0ksVUFBVSxDQUFDLEdBQUcsQ0FBQyxHQUFHLE1BQU0sR0FBRyxPQUFPO0lBRWhFUCxLQUFLLENBQUNRLGlCQUFpQixDQUFDLElBQUksRUFBRSxJQUFJLENBQUNQLFdBQVcs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