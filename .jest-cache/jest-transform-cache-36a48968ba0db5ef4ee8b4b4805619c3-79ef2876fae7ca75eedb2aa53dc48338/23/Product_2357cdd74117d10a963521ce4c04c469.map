{"version":3,"names":["cov_2cl75mtc4s","actualCoverage","mongoose","s","require","productSchema","Schema","name","type","String","required","trim","index","slug","unique","lowercase","description","shortDescription","maxlength","price","Number","min","compareAtPrice","images","url","alt","isPrimary","Boolean","default","category","enum","tags","properties","chakra","element","zodiac","healing","origin","size","weight","wholesaler","email","productCode","cost","minOrderQty","seo","title","keywords","isActive","isFeatured","crossSiteIntegration","enabled","referenceKey","relatedContent","timestamps","methods","toPublicJSON","f","product","toObject","statics","findPublic","query","b","find","select","getCrossSiteData","_id","pre","next","module","exports","model"],"sources":["Product.js"],"sourcesContent":["const mongoose = require('mongoose');\n\nconst productSchema = new mongoose.Schema({\n  name: {\n    type: String,\n    required: true,\n    trim: true,\n    index: true\n  },\n  slug: {\n    type: String,\n    required: true,\n    unique: true,\n    lowercase: true\n  },\n  description: {\n    type: String,\n    required: true\n  },\n  shortDescription: {\n    type: String,\n    required: true,\n    maxlength: 200\n  },\n  price: {\n    type: Number,\n    required: true,\n    min: 0\n  },\n  compareAtPrice: {\n    type: Number,\n    min: 0\n  },\n  images: [{\n    url: { type: String, required: true },\n    alt: { type: String, required: true },\n    isPrimary: { type: Boolean, default: false }\n  }],\n  category: {\n    type: String,\n    required: true,\n    enum: ['crystals', 'herbs', 'oils', 'supplements', 'books', 'accessories', 'other']\n  },\n  tags: [String],\n  properties: {\n    chakra: [String],\n    element: [String],\n    zodiac: [String],\n    healing: [String],\n    origin: String,\n    size: String,\n    weight: String\n  },\n  wholesaler: {\n    name: { type: String, required: true },\n    email: { type: String, required: true },\n    productCode: { type: String, required: true },\n    cost: { type: Number, required: true },\n    minOrderQty: { type: Number, default: 1 }\n  },\n  seo: {\n    title: String,\n    description: String,\n    keywords: [String]\n  },\n  isActive: {\n    type: Boolean,\n    default: true\n  },\n  isFeatured: {\n    type: Boolean,\n    default: false\n  },\n  crossSiteIntegration: {\n    enabled: { type: Boolean, default: true },\n    referenceKey: String, // For linking from sister sites\n    relatedContent: [String] // URLs or content IDs from sister sites\n  }\n}, {\n  timestamps: true\n});\n\n// Indexes for performance\nproductSchema.index({ name: 'text', description: 'text', tags: 'text' });\nproductSchema.index({ category: 1, isActive: 1 });\nproductSchema.index({ slug: 1 });\nproductSchema.index({ 'crossSiteIntegration.referenceKey': 1 });\nproductSchema.index({ tags: 1 });\nproductSchema.index({ isFeatured: 1, isActive: 1 });\n\n// Method to get public product data (excludes wholesaler info)\nproductSchema.methods.toPublicJSON = function() {\n  const product = this.toObject();\n  delete product.wholesaler;\n  return product;\n};\n\n// Static method to get products for public API\nproductSchema.statics.findPublic = function(query = {}) {\n  return this.find({ ...query, isActive: true }).select('-wholesaler');\n};\n\n// Method to get cross-site integration data\nproductSchema.methods.getCrossSiteData = function() {\n  return {\n    _id: this._id,\n    name: this.name,\n    slug: this.slug,\n    shortDescription: this.shortDescription,\n    price: this.price,\n    compareAtPrice: this.compareAtPrice,\n    images: this.images,\n    category: this.category,\n    properties: this.properties,\n    seo: this.seo,\n    crossSiteIntegration: this.crossSiteIntegration\n  };\n};\n\n// Validation for cross-site integration\nproductSchema.pre('save', function(next) {\n  if (this.crossSiteIntegration.enabled && !this.crossSiteIntegration.referenceKey) {\n    this.crossSiteIntegration.referenceKey = this.slug;\n  }\n  next();\n});\n\nmodule.exports = mongoose.model('Product', productSchema);"],"mappings":"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","ignoreList":[]}