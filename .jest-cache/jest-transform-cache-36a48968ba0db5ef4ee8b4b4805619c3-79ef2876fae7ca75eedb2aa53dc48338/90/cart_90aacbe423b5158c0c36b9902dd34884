e77048aa644efe2769c2d5471437cf40
const express = require('express');
const router = express.Router();
const Product = require('../models/Product');
const User = require('../models/User');
const Cart = require('../models/Cart');
const {
  authenticateToken
} = require('../middleware/auth');
const {
  validateCSRFToken
} = require('../middleware/sessionCSRF');
const {
  getCurrencyForLocale,
  formatPrice
} = require('../utils/currency');
const {
  ErrorCodes
} = require('../utils/errorHandler');

// Helper function to get user's currency from request
function getUserCurrency(req) {
  // Check for explicit currency in query or header
  if (req.query.currency) return req.query.currency;
  if (req.headers['x-currency']) return req.headers['x-currency'];

  // Get from locale header (set by frontend based on i18n)
  const locale = req.headers['x-locale'] || 'en';
  return getCurrencyForLocale(locale);
}

// Helper to enhance product with currency info
function enhanceProductWithCurrency(product, currency, locale = 'en') {
  const productObj = product.toPublicJSON();

  // Get price in user's currency
  const priceInCurrency = product.prices && product.prices[currency] ? product.prices[currency] : product.price; // Fallback to USD price

  return {
    ...productObj,
    displayPrice: formatPrice(priceInCurrency, currency, locale),
    displayCurrency: currency,
    priceInCurrency: priceInCurrency
  };
}

// Helper function to get or create cart - Fixed cart persistence bug
const getOrCreateCart = async req => {
  if (req.user) {
    // For authenticated users, use user's cart
    const user = await User.findById(req.user._id);
    if (!user.cart) {
      user.cart = {
        items: [],
        updatedAt: new Date()
      };
      await user.save();
    }
    return {
      type: 'user',
      cart: user.cart,
      user
    };
  } else {
    // For guests, use session-based cart with database storage
    // Get session ID from header (frontend managed) or create new one
    let sessionId = req.headers['x-guest-session-id'];

    // If no session ID from frontend, this is a new session
    if (!sessionId || !sessionId.startsWith('guest_')) {
      sessionId = `guest_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
      console.log('Created new guest session:', sessionId);
    }

    // Clean up any duplicate carts for this session BEFORE creating/fetching
    const existingCarts = await Cart.find({
      sessionId
    });
    if (existingCarts.length > 1) {
      console.warn(`Found ${existingCarts.length} carts for session ${sessionId}, cleaning up duplicates`);
      // Keep the most recently updated cart and delete the rest
      const sortedCarts = existingCarts.sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt));
      const cartsToDelete = sortedCarts.slice(1);
      for (const cartToDelete of cartsToDelete) {
        await Cart.deleteOne({
          _id: cartToDelete._id
        });
      }
    }

    // Get or create the cart - use findOneAndUpdate for atomic operation with fallback
    let cart;
    try {
      cart = await Cart.findOneAndUpdate({
        sessionId
      }, {
        $setOnInsert: {
          sessionId,
          items: []
        },
        $set: {
          lastAccessed: new Date()
        }
      }, {
        new: true,
        upsert: true
      });
    } catch (error) {
      console.warn('findOneAndUpdate failed, using fallback:', error.message);
      cart = null;
    }
    if (!cart) {
      // Fallback: try to find existing cart or create new one
      cart = await Cart.findOne({
        sessionId
      });
      if (!cart) {
        cart = new Cart({
          sessionId,
          items: []
        });
        await cart.save();
        console.log('Created new guest cart for session (fallback):', sessionId);
      }
    }
    return {
      type: 'guest',
      cart,
      sessionId
    };
  }
};

// Get cart contents with performance optimization
router.get('/', authenticateToken, async (req, res) => {
  try {
    // Get cart data directly
    const cartData = await getOrCreateCart(req);
    const {
      type,
      cart,
      user
    } = cartData;

    // Populate product details for cart items
    const populatedCart = await Promise.all(cart.items.map(async item => {
      try {
        const product = await Product.findById(item.product).select('-wholesaler');
        if (!product || !product.isActive) {
          return null; // Filter out inactive products
        }
        const userCurrency = getUserCurrency(req);
        const locale = req.headers['x-locale'] || 'en';
        return {
          _id: item.product,
          product: enhanceProductWithCurrency(product, userCurrency, locale),
          quantity: item.quantity,
          price: item.price,
          subtotal: item.price * item.quantity
        };
      } catch (error) {
        console.error('Error populating cart item:', error);
        return null;
      }
    }));

    // Filter out null items (inactive products)
    const validCartItems = populatedCart.filter(item => item !== null);

    // Calculate totals
    const itemCount = validCartItems.reduce((total, item) => total + item.quantity, 0);
    const subtotal = validCartItems.reduce((total, item) => total + item.subtotal, 0);
    res.json({
      success: true,
      data: {
        cart: {
          items: validCartItems,
          itemCount,
          subtotal: Math.round(subtotal * 100) / 100,
          total: Math.round(subtotal * 100) / 100,
          isEmpty: validCartItems.length === 0
        }
      }
    });
  } catch (error) {
    console.error('Error fetching cart:', error);
    res.error(500, ErrorCodes.CART_FETCH_ERROR, 'Failed to fetch cart');
  }
});

// Add item to cart with optimistic updates
router.post('/add', authenticateToken, validateCSRFToken, async (req, res) => {
  try {
    const {
      productId,
      quantity = 1
    } = req.body;

    // Debug logging for Docker environment
    if (process.env.NODE_ENV === 'development') {
      console.log('Add to cart request:', {
        productId,
        quantity,
        user: req.user ? 'authenticated' : 'guest',
        sessionId: req.sessionID,
        guestSessionId: req.headers['x-guest-session-id'],
        csrfToken: req.headers['x-csrf-token'] ? 'present' : 'missing'
      });
    }

    // Validation
    if (!productId) {
      return res.error(400, ErrorCodes.MISSING_PRODUCT_ID, 'Product ID is required');
    }

    // Enhanced quantity validation to prevent integer overflow and other edge cases
    if (!Number.isInteger(quantity) || quantity < 1 || quantity > 99) {
      return res.error(400, ErrorCodes.INVALID_QUANTITY, 'Quantity must be between 1 and 99');
    }

    // Additional safety check for potential integer overflow
    if (quantity > Number.MAX_SAFE_INTEGER) {
      return res.error(400, ErrorCodes.INVALID_QUANTITY, 'Quantity value is too large');
    }

    // Validate product ID format
    if (!productId.match(/^[0-9a-fA-F]{24}$/)) {
      return res.error(400, ErrorCodes.INVALID_PRODUCT_ID, 'Invalid product ID format');
    }

    // Check if product exists and is active
    const product = await Product.findById(productId);
    if (!product) {
      return res.error(404, ErrorCodes.PRODUCT_NOT_FOUND, 'Product not found');
    }
    if (!product.isActive) {
      return res.error(404, ErrorCodes.PRODUCT_NOT_FOUND, 'Product not found or inactive');
    }

    // Check for existing item and validate maximum quantity
    const {
      type,
      cart,
      user
    } = await getOrCreateCart(req);
    if (type === 'user') {
      const existingItemIndex = user.cart.items.findIndex(item => item.product.toString() === productId.toString());
      if (existingItemIndex >= 0) {
        const currentQuantity = user.cart.items[existingItemIndex].quantity;
        const newQuantity = currentQuantity + quantity;

        // Check for integer overflow and maximum quantity
        if (newQuantity > 99 || newQuantity < currentQuantity) {
          return res.error(400, ErrorCodes.MAX_QUANTITY_EXCEEDED, 'Cannot exceed maximum quantity of 99');
        }
      }
    } else {
      const existingItemIndex = cart.items.findIndex(item => item.product.toString() === productId.toString());
      if (existingItemIndex >= 0) {
        const currentQuantity = cart.items[existingItemIndex].quantity;
        const newQuantity = currentQuantity + quantity;

        // Check for integer overflow and maximum quantity
        if (newQuantity > 99 || newQuantity < currentQuantity) {
          return res.error(400, ErrorCodes.MAX_QUANTITY_EXCEEDED, 'Cannot exceed maximum quantity of 99');
        }
      }
    }

    // Add item to cart directly
    const cartData = await getOrCreateCart(req);
    if (cartData.type === 'user') {
      // Add to user's cart
      const existingItemIndex = cartData.user.cart.items.findIndex(item => item.product.toString() === productId.toString());
      if (existingItemIndex >= 0) {
        cartData.user.cart.items[existingItemIndex].quantity += quantity;
        cartData.user.cart.items[existingItemIndex].addedAt = new Date();
      } else {
        cartData.user.cart.items.push({
          product: productId,
          quantity,
          price: product.price,
          addedAt: new Date()
        });
      }
      cartData.user.cart.updatedAt = new Date();
      await cartData.user.save();
    } else {
      // Add to guest cart
      const existingItemIndex = cartData.cart.items.findIndex(item => item.product.toString() === productId.toString());
      if (existingItemIndex >= 0) {
        cartData.cart.items[existingItemIndex].quantity += quantity;
        cartData.cart.items[existingItemIndex].addedAt = new Date();
      } else {
        cartData.cart.items.push({
          product: productId,
          quantity,
          price: product.price,
          addedAt: new Date()
        });
      }
      await cartData.cart.save();
    }

    // Return updated cart
    const updatedCartData = await getOrCreateCart(req);
    const populatedCart = await Promise.all(updatedCartData.cart.items.map(async item => {
      const prod = await Product.findById(item.product).select('-wholesaler');
      if (!prod) {
        return null; // Filter out missing products
      }
      const userCurrency = getUserCurrency(req);
      const locale = req.headers['x-locale'] || 'en';
      return {
        _id: item.product,
        product: enhanceProductWithCurrency(prod, userCurrency, locale),
        quantity: item.quantity,
        price: item.price,
        subtotal: item.price * item.quantity
      };
    })).then(items => items.filter(item => item !== null));
    const itemCount = populatedCart.reduce((total, item) => total + item.quantity, 0);
    const subtotal = populatedCart.reduce((total, item) => total + item.subtotal, 0);
    res.json({
      success: true,
      message: 'Item added to cart',
      data: {
        cart: {
          items: populatedCart,
          itemCount,
          subtotal: Math.round(subtotal * 100) / 100,
          total: Math.round(subtotal * 100) / 100
        }
      }
    });
  } catch (error) {
    console.error('Error adding to cart:', error);
    console.error('Full stack:', error.stack);
    res.error(500, ErrorCodes.CART_ADD_ERROR, 'Failed to add item to cart', {
      details: process.env.NODE_ENV === 'development' ? error.message : undefined,
      stack: process.env.NODE_ENV === 'development' ? error.stack : undefined
    });
  }
});

// Update cart item quantity
router.put('/update', authenticateToken, validateCSRFToken, async (req, res) => {
  try {
    const {
      productId,
      quantity
    } = req.body;

    // Validation
    if (!productId) {
      return res.error(400, ErrorCodes.MISSING_PRODUCT_ID, 'Product ID is required');
    }
    if (!Number.isInteger(quantity) || quantity < 0 || quantity > 99) {
      return res.error(400, ErrorCodes.INVALID_QUANTITY, 'Quantity must be between 0 and 99');
    }
    const {
      type,
      cart,
      user
    } = await getOrCreateCart(req);
    if (type === 'user') {
      // Update user's cart
      const itemIndex = user.cart.items.findIndex(item => item.product.toString() === productId.toString());
      if (itemIndex >= 0) {
        if (quantity === 0) {
          user.cart.items.splice(itemIndex, 1);
        } else {
          user.cart.items[itemIndex].quantity = quantity;
          user.cart.items[itemIndex].addedAt = new Date();
        }
        user.cart.updatedAt = new Date();
        await user.save();
      } else {
        return res.error(404, ErrorCodes.ITEM_NOT_FOUND, 'Item not found in cart');
      }
    } else {
      // Update guest cart
      const itemIndex = cart.items.findIndex(item => item.product.toString() === productId.toString());
      if (itemIndex >= 0) {
        // Always use direct database update for consistency
        let updatedItems = [...cart.items];
        if (quantity === 0) {
          updatedItems.splice(itemIndex, 1);
        } else {
          updatedItems[itemIndex] = {
            ...updatedItems[itemIndex],
            quantity,
            addedAt: new Date()
          };
        }

        // Use atomic update to prevent race conditions
        const updatedCart = await Cart.findByIdAndUpdate(cart._id, {
          items: updatedItems,
          updatedAt: new Date()
        }, {
          new: true
        });
        cart.items = updatedCart.items;
      } else {
        return res.error(404, ErrorCodes.ITEM_NOT_FOUND, 'Item not found in cart');
      }
    }

    // Return updated cart - use the already modified data instead of refetching
    const cartItems = type === 'user' ? user.cart.items : cart.items;
    const populatedCart = await Promise.all(cartItems.map(async item => {
      const product = await Product.findById(item.product).select('-wholesaler');
      if (!product || !product.isActive) return null;
      return {
        _id: item.product,
        product: product.toPublicJSON(),
        quantity: item.quantity,
        price: item.price,
        subtotal: item.price * item.quantity
      };
    }));
    const validCartItems = populatedCart.filter(item => item !== null);
    const itemCount = validCartItems.reduce((total, item) => total + item.quantity, 0);
    const subtotal = validCartItems.reduce((total, item) => total + item.subtotal, 0);

    // Check if item was removed (quantity was 0)
    const wasRemoved = quantity === 0;
    res.json({
      success: true,
      message: wasRemoved ? 'Item removed from cart' : 'Cart updated',
      data: {
        cart: {
          items: validCartItems,
          itemCount,
          subtotal: Math.round(subtotal * 100) / 100,
          total: Math.round(subtotal * 100) / 100
        }
      },
      cartItemCount: itemCount
    });
  } catch (error) {
    console.error('Error updating cart:', error);
    res.error(500, ErrorCodes.CART_UPDATE_ERROR, 'Failed to update cart');
  }
});

// Remove item from cart
router.delete('/remove', authenticateToken, validateCSRFToken, async (req, res) => {
  try {
    const {
      productId
    } = req.body;
    if (!productId) {
      return res.error(400, ErrorCodes.MISSING_PRODUCT_ID, 'Product ID is required');
    }
    const {
      type,
      cart,
      user
    } = await getOrCreateCart(req);
    if (type === 'user') {
      // Remove from user's cart
      const itemIndex = user.cart.items.findIndex(item => item.product.toString() === productId.toString());
      if (itemIndex >= 0) {
        user.cart.items.splice(itemIndex, 1);
        user.cart.updatedAt = new Date();
        await user.save();
      } else {
        return res.error(404, ErrorCodes.ITEM_NOT_FOUND, 'Item not found in cart');
      }
    } else {
      // Remove from guest cart
      const itemIndex = cart.items.findIndex(item => item.product.toString() === productId.toString());
      if (itemIndex >= 0) {
        // Always use direct database update for consistency
        let updatedItems = [...cart.items];
        updatedItems.splice(itemIndex, 1);

        // Use atomic update to prevent race conditions
        const updatedCart = await Cart.findByIdAndUpdate(cart._id, {
          items: updatedItems,
          updatedAt: new Date()
        }, {
          new: true
        });
        cart.items = updatedCart.items;
      } else {
        return res.error(404, ErrorCodes.ITEM_NOT_FOUND, 'Item not found in cart');
      }
    }

    // Return updated cart - use the already modified data instead of refetching
    const cartItems = type === 'user' ? user.cart.items : cart.items;
    const populatedCart = await Promise.all(cartItems.map(async item => {
      const product = await Product.findById(item.product).select('-wholesaler');
      if (!product || !product.isActive) return null;
      return {
        _id: item.product,
        product: product.toPublicJSON(),
        quantity: item.quantity,
        price: item.price,
        subtotal: item.price * item.quantity
      };
    }));
    const validCartItems = populatedCart.filter(item => item !== null);
    const itemCount = validCartItems.reduce((total, item) => total + item.quantity, 0);
    const subtotal = validCartItems.reduce((total, item) => total + item.subtotal, 0);
    res.json({
      success: true,
      message: 'Item removed from cart',
      data: {
        cart: {
          items: validCartItems,
          itemCount,
          subtotal: Math.round(subtotal * 100) / 100,
          total: Math.round(subtotal * 100) / 100
        }
      },
      cartItemCount: itemCount
    });
  } catch (error) {
    console.error('Error removing from cart:', error);
    res.error(500, ErrorCodes.CART_REMOVE_ERROR, 'Failed to remove item from cart');
  }
});

// Clear cart
router.delete('/clear', authenticateToken, validateCSRFToken, async (req, res) => {
  try {
    const {
      type,
      cart,
      user
    } = await getOrCreateCart(req);
    if (type === 'user') {
      // Clear user's cart
      user.cart.items = [];
      user.cart.updatedAt = new Date();
      await user.save();
      console.log('Cleared user cart for user:', user._id);
    } else {
      // Clear guest cart - use atomic update instead of delete/recreate
      console.log('Clearing guest cart for session:', cart.sessionId);

      // First, delete ALL carts with this session ID to handle duplicates
      const deleteResult = await Cart.deleteMany({
        sessionId: cart.sessionId
      });
      console.log(`Deleted ${deleteResult?.deletedCount || 0} cart(s) for session ${cart.sessionId}`);

      // Create a single fresh cart
      const newCart = new Cart({
        sessionId: cart.sessionId,
        items: []
      });
      await newCart.save();
      console.log('Created fresh guest cart for session:', cart.sessionId);
    }
    res.json({
      success: true,
      message: 'Cart cleared',
      data: {
        cart: {
          items: [],
          itemCount: 0,
          subtotal: 0,
          total: 0,
          isEmpty: true
        }
      },
      cartItemCount: 0
    });
  } catch (error) {
    console.error('Error clearing cart:', error);
    res.error(500, ErrorCodes.CART_CLEAR_ERROR, 'Failed to clear cart');
  }
});

// Merge guest cart with user cart with conflict resolution
router.post('/merge', authenticateToken, async (req, res) => {
  try {
    if (!req.user) {
      return res.error(401, ErrorCodes.AUTHENTICATION_REQUIRED, 'User must be authenticated to merge cart');
    }
    const {
      guestCartItems,
      sessionId
    } = req.body;
    console.log('Cart merge request:', {
      userId: req.user._id,
      sessionId,
      guestItemCount: guestCartItems?.length || 0
    });

    // Merge cart logic directly
    const user = await User.findById(req.user._id);
    if (!user.cart) {
      user.cart = {
        items: [],
        updatedAt: new Date()
      };
    }
    let mergedItems = 0;

    // Process guest cart items - use either guestCartItems OR session-based cart, not both
    if (guestCartItems && Array.isArray(guestCartItems) && guestCartItems.length > 0) {
      // Frontend sent cart items directly, use those
      for (const guestItem of guestCartItems) {
        const product = await Product.findById(guestItem.productId || guestItem.product);
        if (!product || !product.isActive) {
          continue;
        }
        const productId = guestItem.productId || guestItem.product;
        const quantity = guestItem.quantity || 1;
        const existingItemIndex = user.cart.items.findIndex(item => item.product.toString() === productId.toString());
        if (existingItemIndex >= 0) {
          // Add guest quantity to existing user cart quantity
          user.cart.items[existingItemIndex].quantity += quantity;
          user.cart.items[existingItemIndex].addedAt = new Date();
        } else {
          user.cart.items.push({
            product: productId,
            quantity,
            price: product.price,
            addedAt: new Date()
          });
        }
        mergedItems++;
      }

      // Clean up the guest cart from database if sessionId provided
      if (sessionId) {
        await Cart.deleteOne({
          sessionId
        });
        console.log('Deleted guest cart for session:', sessionId);
      }
    } else if (sessionId) {
      // No items sent from frontend, try to load from database
      const guestCart = await Cart.findOne({
        sessionId
      });
      if (guestCart && guestCart.items.length > 0) {
        console.log('Found guest cart with', guestCart.items.length, 'items for session:', sessionId);
        for (const guestItem of guestCart.items) {
          const product = await Product.findById(guestItem.product);
          if (!product || !product.isActive) {
            continue;
          }
          const existingItemIndex = user.cart.items.findIndex(item => item.product.toString() === guestItem.product.toString());
          if (existingItemIndex >= 0) {
            // Add guest quantity to existing user cart quantity
            user.cart.items[existingItemIndex].quantity += guestItem.quantity;
            user.cart.items[existingItemIndex].addedAt = new Date();
          } else {
            user.cart.items.push({
              product: guestItem.product,
              quantity: guestItem.quantity,
              price: guestItem.price,
              addedAt: new Date()
            });
          }
          mergedItems++;
        }

        // Clean up the guest cart after merge
        await Cart.deleteOne({
          sessionId
        });
        console.log('Deleted guest cart for session:', sessionId);
      } else {
        console.log('No guest cart found for session:', sessionId);
      }
    }
    user.cart.updatedAt = new Date();
    await user.save();
    const mergeResult = {
      mergedItems,
      conflicts: [],
      duration: 0
    };

    // Get updated cart data
    const updatedCartData = await getOrCreateCart(req);

    // Return updated user cart
    const populatedCart = await Promise.all(updatedCartData.cart.items.map(async item => {
      try {
        const product = await Product.findById(item.product).select('-wholesaler');
        if (!product || !product.isActive) {
          return null; // Filter out inactive products
        }
        const userCurrency = getUserCurrency(req);
        const locale = req.headers['x-locale'] || 'en';
        return {
          _id: item.product,
          product: enhanceProductWithCurrency(product, userCurrency, locale),
          quantity: item.quantity,
          price: item.price,
          subtotal: item.price * item.quantity
        };
      } catch (error) {
        console.error('Error populating cart item:', error);
        return null;
      }
    }));

    // Filter out null items (inactive products)
    const validCartItems = populatedCart.filter(item => item !== null);
    const itemCount = validCartItems.reduce((total, item) => total + item.quantity, 0);
    const subtotal = validCartItems.reduce((total, item) => total + item.subtotal, 0);
    res.json({
      success: true,
      message: `Successfully merged ${mergeResult.mergedItems} items into your cart`,
      data: {
        cart: {
          items: validCartItems,
          itemCount,
          subtotal: Math.round(subtotal * 100) / 100,
          total: Math.round(subtotal * 100) / 100,
          isEmpty: validCartItems.length === 0
        },
        merge: {
          mergedItems: mergeResult.mergedItems,
          conflicts: mergeResult.conflicts,
          duration: mergeResult.duration
        }
      }
    });
  } catch (error) {
    console.error('Error merging guest cart:', error);
    res.error(500, ErrorCodes.CART_MERGE_ERROR, 'Failed to merge guest cart', {
      details: process.env.NODE_ENV === 'development' ? error.message : undefined
    });
  }
});

// Reset guest cart session - helps fix cart persistence issues
router.post('/reset-guest-session', async (req, res) => {
  try {
    // Only allow this for non-authenticated users (guests)
    if (req.user) {
      return res.error(400, ErrorCodes.NOT_GUEST_USER, 'This endpoint is only for guest users');
    }

    // Get the old session ID from header
    const oldSessionId = req.headers['x-guest-session-id'];

    // Delete old guest cart if it exists
    if (oldSessionId && oldSessionId.startsWith('guest_')) {
      const deleteResult = await Cart.deleteMany({
        sessionId: oldSessionId
      });
      console.log(`Deleted ${deleteResult?.deletedCount || 0} guest cart(s) for old session ${oldSessionId}`);
    }

    // Create a fresh guest session ID
    const newSessionId = `guest_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;

    // Create a fresh empty cart
    const newCart = new Cart({
      sessionId: newSessionId,
      items: []
    });
    await newCart.save();
    res.json({
      success: true,
      message: 'Guest cart session reset successfully',
      data: {
        sessionId: newSessionId,
        cart: {
          items: [],
          itemCount: 0,
          subtotal: 0,
          total: 0,
          isEmpty: true
        }
      }
    });
  } catch (error) {
    console.error('Error resetting guest cart session:', error);
    res.error(500, ErrorCodes.RESET_SESSION_ERROR, 'Failed to reset guest cart session');
  }
});

// Debug endpoint to see all guest carts (development only)
if (process.env.NODE_ENV === 'development') {
  router.get('/debug', async (req, res) => {
    try {
      const guestCarts = await Cart.find({}).select('sessionId items createdAt updatedAt');
      const userCarts = await User.find({
        'cart.items.0': {
          $exists: true
        }
      }).select('email cart.items cart.updatedAt');
      res.json({
        success: true,
        data: {
          guestCarts: guestCarts.map(cart => ({
            sessionId: cart.sessionId,
            itemCount: cart.items.length,
            items: cart.items,
            createdAt: cart.createdAt,
            updatedAt: cart.updatedAt
          })),
          userCarts: userCarts.map(user => ({
            email: user.email,
            itemCount: user.cart?.items?.length || 0,
            items: user.cart?.items || [],
            updatedAt: user.cart?.updatedAt
          })),
          currentSession: {
            guestSessionId: req.headers['x-guest-session-id'],
            serverSessionId: req.sessionID
          }
        }
      });
    } catch (error) {
      res.error(500, ErrorCodes.INTERNAL_ERROR, error.message);
    }
  });
}
module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsIlByb2R1Y3QiLCJVc2VyIiwiQ2FydCIsImF1dGhlbnRpY2F0ZVRva2VuIiwidmFsaWRhdGVDU1JGVG9rZW4iLCJnZXRDdXJyZW5jeUZvckxvY2FsZSIsImZvcm1hdFByaWNlIiwiRXJyb3JDb2RlcyIsImdldFVzZXJDdXJyZW5jeSIsInJlcSIsInF1ZXJ5IiwiY3VycmVuY3kiLCJoZWFkZXJzIiwibG9jYWxlIiwiZW5oYW5jZVByb2R1Y3RXaXRoQ3VycmVuY3kiLCJwcm9kdWN0IiwicHJvZHVjdE9iaiIsInRvUHVibGljSlNPTiIsInByaWNlSW5DdXJyZW5jeSIsInByaWNlcyIsInByaWNlIiwiZGlzcGxheVByaWNlIiwiZGlzcGxheUN1cnJlbmN5IiwiZ2V0T3JDcmVhdGVDYXJ0IiwidXNlciIsImZpbmRCeUlkIiwiX2lkIiwiY2FydCIsIml0ZW1zIiwidXBkYXRlZEF0IiwiRGF0ZSIsInNhdmUiLCJ0eXBlIiwic2Vzc2lvbklkIiwic3RhcnRzV2l0aCIsIm5vdyIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0ciIsImNvbnNvbGUiLCJsb2ciLCJleGlzdGluZ0NhcnRzIiwiZmluZCIsImxlbmd0aCIsIndhcm4iLCJzb3J0ZWRDYXJ0cyIsInNvcnQiLCJhIiwiYiIsImNhcnRzVG9EZWxldGUiLCJzbGljZSIsImNhcnRUb0RlbGV0ZSIsImRlbGV0ZU9uZSIsImZpbmRPbmVBbmRVcGRhdGUiLCIkc2V0T25JbnNlcnQiLCIkc2V0IiwibGFzdEFjY2Vzc2VkIiwibmV3IiwidXBzZXJ0IiwiZXJyb3IiLCJtZXNzYWdlIiwiZmluZE9uZSIsImdldCIsInJlcyIsImNhcnREYXRhIiwicG9wdWxhdGVkQ2FydCIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJpdGVtIiwic2VsZWN0IiwiaXNBY3RpdmUiLCJ1c2VyQ3VycmVuY3kiLCJxdWFudGl0eSIsInN1YnRvdGFsIiwidmFsaWRDYXJ0SXRlbXMiLCJmaWx0ZXIiLCJpdGVtQ291bnQiLCJyZWR1Y2UiLCJ0b3RhbCIsImpzb24iLCJzdWNjZXNzIiwiZGF0YSIsInJvdW5kIiwiaXNFbXB0eSIsIkNBUlRfRkVUQ0hfRVJST1IiLCJwb3N0IiwicHJvZHVjdElkIiwiYm9keSIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsInNlc3Npb25JRCIsImd1ZXN0U2Vzc2lvbklkIiwiY3NyZlRva2VuIiwiTUlTU0lOR19QUk9EVUNUX0lEIiwiTnVtYmVyIiwiaXNJbnRlZ2VyIiwiSU5WQUxJRF9RVUFOVElUWSIsIk1BWF9TQUZFX0lOVEVHRVIiLCJtYXRjaCIsIklOVkFMSURfUFJPRFVDVF9JRCIsIlBST0RVQ1RfTk9UX0ZPVU5EIiwiZXhpc3RpbmdJdGVtSW5kZXgiLCJmaW5kSW5kZXgiLCJjdXJyZW50UXVhbnRpdHkiLCJuZXdRdWFudGl0eSIsIk1BWF9RVUFOVElUWV9FWENFRURFRCIsImFkZGVkQXQiLCJwdXNoIiwidXBkYXRlZENhcnREYXRhIiwicHJvZCIsInRoZW4iLCJzdGFjayIsIkNBUlRfQUREX0VSUk9SIiwiZGV0YWlscyIsInVuZGVmaW5lZCIsInB1dCIsIml0ZW1JbmRleCIsInNwbGljZSIsIklURU1fTk9UX0ZPVU5EIiwidXBkYXRlZEl0ZW1zIiwidXBkYXRlZENhcnQiLCJmaW5kQnlJZEFuZFVwZGF0ZSIsImNhcnRJdGVtcyIsIndhc1JlbW92ZWQiLCJjYXJ0SXRlbUNvdW50IiwiQ0FSVF9VUERBVEVfRVJST1IiLCJkZWxldGUiLCJDQVJUX1JFTU9WRV9FUlJPUiIsImRlbGV0ZVJlc3VsdCIsImRlbGV0ZU1hbnkiLCJkZWxldGVkQ291bnQiLCJuZXdDYXJ0IiwiQ0FSVF9DTEVBUl9FUlJPUiIsIkFVVEhFTlRJQ0FUSU9OX1JFUVVJUkVEIiwiZ3Vlc3RDYXJ0SXRlbXMiLCJ1c2VySWQiLCJndWVzdEl0ZW1Db3VudCIsIm1lcmdlZEl0ZW1zIiwiQXJyYXkiLCJpc0FycmF5IiwiZ3Vlc3RJdGVtIiwiZ3Vlc3RDYXJ0IiwibWVyZ2VSZXN1bHQiLCJjb25mbGljdHMiLCJkdXJhdGlvbiIsIm1lcmdlIiwiQ0FSVF9NRVJHRV9FUlJPUiIsIk5PVF9HVUVTVF9VU0VSIiwib2xkU2Vzc2lvbklkIiwibmV3U2Vzc2lvbklkIiwiUkVTRVRfU0VTU0lPTl9FUlJPUiIsImd1ZXN0Q2FydHMiLCJ1c2VyQ2FydHMiLCIkZXhpc3RzIiwiY3JlYXRlZEF0IiwiZW1haWwiLCJjdXJyZW50U2Vzc2lvbiIsInNlcnZlclNlc3Npb25JZCIsIklOVEVSTkFMX0VSUk9SIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImNhcnQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG5jb25zdCBQcm9kdWN0ID0gcmVxdWlyZSgnLi4vbW9kZWxzL1Byb2R1Y3QnKTtcbmNvbnN0IFVzZXIgPSByZXF1aXJlKCcuLi9tb2RlbHMvVXNlcicpO1xuY29uc3QgQ2FydCA9IHJlcXVpcmUoJy4uL21vZGVscy9DYXJ0Jyk7XG5jb25zdCB7IGF1dGhlbnRpY2F0ZVRva2VuIH0gPSByZXF1aXJlKCcuLi9taWRkbGV3YXJlL2F1dGgnKTtcbmNvbnN0IHsgdmFsaWRhdGVDU1JGVG9rZW4gfSA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmUvc2Vzc2lvbkNTUkYnKTtcbmNvbnN0IHsgZ2V0Q3VycmVuY3lGb3JMb2NhbGUsIGZvcm1hdFByaWNlIH0gPSByZXF1aXJlKCcuLi91dGlscy9jdXJyZW5jeScpO1xuY29uc3QgeyBFcnJvckNvZGVzIH0gPSByZXF1aXJlKCcuLi91dGlscy9lcnJvckhhbmRsZXInKTtcblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGdldCB1c2VyJ3MgY3VycmVuY3kgZnJvbSByZXF1ZXN0XG5mdW5jdGlvbiBnZXRVc2VyQ3VycmVuY3kocmVxKSB7XG4gIC8vIENoZWNrIGZvciBleHBsaWNpdCBjdXJyZW5jeSBpbiBxdWVyeSBvciBoZWFkZXJcbiAgaWYgKHJlcS5xdWVyeS5jdXJyZW5jeSkgcmV0dXJuIHJlcS5xdWVyeS5jdXJyZW5jeTtcbiAgaWYgKHJlcS5oZWFkZXJzWyd4LWN1cnJlbmN5J10pIHJldHVybiByZXEuaGVhZGVyc1sneC1jdXJyZW5jeSddO1xuICBcbiAgLy8gR2V0IGZyb20gbG9jYWxlIGhlYWRlciAoc2V0IGJ5IGZyb250ZW5kIGJhc2VkIG9uIGkxOG4pXG4gIGNvbnN0IGxvY2FsZSA9IHJlcS5oZWFkZXJzWyd4LWxvY2FsZSddIHx8ICdlbic7XG4gIHJldHVybiBnZXRDdXJyZW5jeUZvckxvY2FsZShsb2NhbGUpO1xufVxuXG4vLyBIZWxwZXIgdG8gZW5oYW5jZSBwcm9kdWN0IHdpdGggY3VycmVuY3kgaW5mb1xuZnVuY3Rpb24gZW5oYW5jZVByb2R1Y3RXaXRoQ3VycmVuY3kocHJvZHVjdCwgY3VycmVuY3ksIGxvY2FsZSA9ICdlbicpIHtcbiAgY29uc3QgcHJvZHVjdE9iaiA9IHByb2R1Y3QudG9QdWJsaWNKU09OKCk7XG4gIFxuICAvLyBHZXQgcHJpY2UgaW4gdXNlcidzIGN1cnJlbmN5XG4gIGNvbnN0IHByaWNlSW5DdXJyZW5jeSA9IHByb2R1Y3QucHJpY2VzICYmIHByb2R1Y3QucHJpY2VzW2N1cnJlbmN5XSBcbiAgICA/IHByb2R1Y3QucHJpY2VzW2N1cnJlbmN5XSBcbiAgICA6IHByb2R1Y3QucHJpY2U7IC8vIEZhbGxiYWNrIHRvIFVTRCBwcmljZVxuICAgIFxuICByZXR1cm4ge1xuICAgIC4uLnByb2R1Y3RPYmosXG4gICAgZGlzcGxheVByaWNlOiBmb3JtYXRQcmljZShwcmljZUluQ3VycmVuY3ksIGN1cnJlbmN5LCBsb2NhbGUpLFxuICAgIGRpc3BsYXlDdXJyZW5jeTogY3VycmVuY3ksXG4gICAgcHJpY2VJbkN1cnJlbmN5OiBwcmljZUluQ3VycmVuY3lcbiAgfTtcbn1cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGdldCBvciBjcmVhdGUgY2FydCAtIEZpeGVkIGNhcnQgcGVyc2lzdGVuY2UgYnVnXG5jb25zdCBnZXRPckNyZWF0ZUNhcnQgPSBhc3luYyAocmVxKSA9PiB7XG4gIGlmIChyZXEudXNlcikge1xuICAgIC8vIEZvciBhdXRoZW50aWNhdGVkIHVzZXJzLCB1c2UgdXNlcidzIGNhcnRcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZChyZXEudXNlci5faWQpO1xuICAgIGlmICghdXNlci5jYXJ0KSB7XG4gICAgICB1c2VyLmNhcnQgPSB7IGl0ZW1zOiBbXSwgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpIH07XG4gICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcbiAgICB9XG4gICAgcmV0dXJuIHsgdHlwZTogJ3VzZXInLCBjYXJ0OiB1c2VyLmNhcnQsIHVzZXIgfTtcbiAgfSBlbHNlIHtcbiAgICAvLyBGb3IgZ3Vlc3RzLCB1c2Ugc2Vzc2lvbi1iYXNlZCBjYXJ0IHdpdGggZGF0YWJhc2Ugc3RvcmFnZVxuICAgIC8vIEdldCBzZXNzaW9uIElEIGZyb20gaGVhZGVyIChmcm9udGVuZCBtYW5hZ2VkKSBvciBjcmVhdGUgbmV3IG9uZVxuICAgIGxldCBzZXNzaW9uSWQgPSByZXEuaGVhZGVyc1sneC1ndWVzdC1zZXNzaW9uLWlkJ107XG4gICAgXG4gICAgLy8gSWYgbm8gc2Vzc2lvbiBJRCBmcm9tIGZyb250ZW5kLCB0aGlzIGlzIGEgbmV3IHNlc3Npb25cbiAgICBpZiAoIXNlc3Npb25JZCB8fCAhc2Vzc2lvbklkLnN0YXJ0c1dpdGgoJ2d1ZXN0XycpKSB7XG4gICAgICBzZXNzaW9uSWQgPSBgZ3Vlc3RfJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gO1xuICAgICAgY29uc29sZS5sb2coJ0NyZWF0ZWQgbmV3IGd1ZXN0IHNlc3Npb246Jywgc2Vzc2lvbklkKTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ2xlYW4gdXAgYW55IGR1cGxpY2F0ZSBjYXJ0cyBmb3IgdGhpcyBzZXNzaW9uIEJFRk9SRSBjcmVhdGluZy9mZXRjaGluZ1xuICAgIGNvbnN0IGV4aXN0aW5nQ2FydHMgPSBhd2FpdCBDYXJ0LmZpbmQoeyBzZXNzaW9uSWQgfSk7XG4gICAgaWYgKGV4aXN0aW5nQ2FydHMubGVuZ3RoID4gMSkge1xuICAgICAgY29uc29sZS53YXJuKGBGb3VuZCAke2V4aXN0aW5nQ2FydHMubGVuZ3RofSBjYXJ0cyBmb3Igc2Vzc2lvbiAke3Nlc3Npb25JZH0sIGNsZWFuaW5nIHVwIGR1cGxpY2F0ZXNgKTtcbiAgICAgIC8vIEtlZXAgdGhlIG1vc3QgcmVjZW50bHkgdXBkYXRlZCBjYXJ0IGFuZCBkZWxldGUgdGhlIHJlc3RcbiAgICAgIGNvbnN0IHNvcnRlZENhcnRzID0gZXhpc3RpbmdDYXJ0cy5zb3J0KChhLCBiKSA9PiBuZXcgRGF0ZShiLnVwZGF0ZWRBdCkgLSBuZXcgRGF0ZShhLnVwZGF0ZWRBdCkpO1xuICAgICAgY29uc3QgY2FydHNUb0RlbGV0ZSA9IHNvcnRlZENhcnRzLnNsaWNlKDEpO1xuICAgICAgZm9yIChjb25zdCBjYXJ0VG9EZWxldGUgb2YgY2FydHNUb0RlbGV0ZSkge1xuICAgICAgICBhd2FpdCBDYXJ0LmRlbGV0ZU9uZSh7IF9pZDogY2FydFRvRGVsZXRlLl9pZCB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gR2V0IG9yIGNyZWF0ZSB0aGUgY2FydCAtIHVzZSBmaW5kT25lQW5kVXBkYXRlIGZvciBhdG9taWMgb3BlcmF0aW9uIHdpdGggZmFsbGJhY2tcbiAgICBsZXQgY2FydDtcbiAgICB0cnkge1xuICAgICAgY2FydCA9IGF3YWl0IENhcnQuZmluZE9uZUFuZFVwZGF0ZShcbiAgICAgICAgeyBzZXNzaW9uSWQgfSxcbiAgICAgICAgeyBcbiAgICAgICAgICAkc2V0T25JbnNlcnQ6IHsgc2Vzc2lvbklkLCBpdGVtczogW10gfSxcbiAgICAgICAgICAkc2V0OiB7IGxhc3RBY2Nlc3NlZDogbmV3IERhdGUoKSB9XG4gICAgICAgIH0sXG4gICAgICAgIHsgXG4gICAgICAgICAgbmV3OiB0cnVlLCBcbiAgICAgICAgICB1cHNlcnQ6IHRydWVcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdmaW5kT25lQW5kVXBkYXRlIGZhaWxlZCwgdXNpbmcgZmFsbGJhY2s6JywgZXJyb3IubWVzc2FnZSk7XG4gICAgICBjYXJ0ID0gbnVsbDtcbiAgICB9XG4gICAgXG4gICAgaWYgKCFjYXJ0KSB7XG4gICAgICAvLyBGYWxsYmFjazogdHJ5IHRvIGZpbmQgZXhpc3RpbmcgY2FydCBvciBjcmVhdGUgbmV3IG9uZVxuICAgICAgY2FydCA9IGF3YWl0IENhcnQuZmluZE9uZSh7IHNlc3Npb25JZCB9KTtcbiAgICAgIGlmICghY2FydCkge1xuICAgICAgICBjYXJ0ID0gbmV3IENhcnQoeyBzZXNzaW9uSWQsIGl0ZW1zOiBbXSB9KTtcbiAgICAgICAgYXdhaXQgY2FydC5zYXZlKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdDcmVhdGVkIG5ldyBndWVzdCBjYXJ0IGZvciBzZXNzaW9uIChmYWxsYmFjayk6Jywgc2Vzc2lvbklkKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHsgdHlwZTogJ2d1ZXN0JywgY2FydCwgc2Vzc2lvbklkIH07XG4gIH1cbn07XG5cbi8vIEdldCBjYXJ0IGNvbnRlbnRzIHdpdGggcGVyZm9ybWFuY2Ugb3B0aW1pemF0aW9uXG5yb3V0ZXIuZ2V0KCcvJywgYXV0aGVudGljYXRlVG9rZW4sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIC8vIEdldCBjYXJ0IGRhdGEgZGlyZWN0bHlcbiAgICBjb25zdCBjYXJ0RGF0YSA9IGF3YWl0IGdldE9yQ3JlYXRlQ2FydChyZXEpO1xuICAgIFxuICAgIGNvbnN0IHsgdHlwZSwgY2FydCwgdXNlciB9ID0gY2FydERhdGE7XG4gICAgXG4gICAgLy8gUG9wdWxhdGUgcHJvZHVjdCBkZXRhaWxzIGZvciBjYXJ0IGl0ZW1zXG4gICAgY29uc3QgcG9wdWxhdGVkQ2FydCA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgY2FydC5pdGVtcy5tYXAoYXN5bmMgKGl0ZW0pID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBwcm9kdWN0ID0gYXdhaXQgUHJvZHVjdC5maW5kQnlJZChpdGVtLnByb2R1Y3QpLnNlbGVjdCgnLXdob2xlc2FsZXInKTtcbiAgICAgICAgICBpZiAoIXByb2R1Y3QgfHwgIXByb2R1Y3QuaXNBY3RpdmUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsOyAvLyBGaWx0ZXIgb3V0IGluYWN0aXZlIHByb2R1Y3RzXG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIGNvbnN0IHVzZXJDdXJyZW5jeSA9IGdldFVzZXJDdXJyZW5jeShyZXEpO1xuICAgICAgICAgIGNvbnN0IGxvY2FsZSA9IHJlcS5oZWFkZXJzWyd4LWxvY2FsZSddIHx8ICdlbic7XG4gICAgICAgICAgXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIF9pZDogaXRlbS5wcm9kdWN0LFxuICAgICAgICAgICAgcHJvZHVjdDogZW5oYW5jZVByb2R1Y3RXaXRoQ3VycmVuY3kocHJvZHVjdCwgdXNlckN1cnJlbmN5LCBsb2NhbGUpLFxuICAgICAgICAgICAgcXVhbnRpdHk6IGl0ZW0ucXVhbnRpdHksXG4gICAgICAgICAgICBwcmljZTogaXRlbS5wcmljZSxcbiAgICAgICAgICAgIHN1YnRvdGFsOiBpdGVtLnByaWNlICogaXRlbS5xdWFudGl0eVxuICAgICAgICAgIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcG9wdWxhdGluZyBjYXJ0IGl0ZW06JywgZXJyb3IpO1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICk7XG5cbiAgICAvLyBGaWx0ZXIgb3V0IG51bGwgaXRlbXMgKGluYWN0aXZlIHByb2R1Y3RzKVxuICAgIGNvbnN0IHZhbGlkQ2FydEl0ZW1zID0gcG9wdWxhdGVkQ2FydC5maWx0ZXIoaXRlbSA9PiBpdGVtICE9PSBudWxsKTtcbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgdG90YWxzXG4gICAgY29uc3QgaXRlbUNvdW50ID0gdmFsaWRDYXJ0SXRlbXMucmVkdWNlKCh0b3RhbCwgaXRlbSkgPT4gdG90YWwgKyBpdGVtLnF1YW50aXR5LCAwKTtcbiAgICBjb25zdCBzdWJ0b3RhbCA9IHZhbGlkQ2FydEl0ZW1zLnJlZHVjZSgodG90YWwsIGl0ZW0pID0+IHRvdGFsICsgaXRlbS5zdWJ0b3RhbCwgMCk7XG4gICAgXG4gICAgcmVzLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgY2FydDoge1xuICAgICAgICAgIGl0ZW1zOiB2YWxpZENhcnRJdGVtcyxcbiAgICAgICAgICBpdGVtQ291bnQsXG4gICAgICAgICAgc3VidG90YWw6IE1hdGgucm91bmQoc3VidG90YWwgKiAxMDApIC8gMTAwLFxuICAgICAgICAgIHRvdGFsOiBNYXRoLnJvdW5kKHN1YnRvdGFsICogMTAwKSAvIDEwMCxcbiAgICAgICAgICBpc0VtcHR5OiB2YWxpZENhcnRJdGVtcy5sZW5ndGggPT09IDBcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2FydDonLCBlcnJvcik7XG4gICAgcmVzLmVycm9yKDUwMCwgRXJyb3JDb2Rlcy5DQVJUX0ZFVENIX0VSUk9SLCAnRmFpbGVkIHRvIGZldGNoIGNhcnQnKTtcbiAgfVxufSk7XG5cbi8vIEFkZCBpdGVtIHRvIGNhcnQgd2l0aCBvcHRpbWlzdGljIHVwZGF0ZXNcbnJvdXRlci5wb3N0KCcvYWRkJywgYXV0aGVudGljYXRlVG9rZW4sIHZhbGlkYXRlQ1NSRlRva2VuLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IHByb2R1Y3RJZCwgcXVhbnRpdHkgPSAxIH0gPSByZXEuYm9keTtcbiAgICBcbiAgICAvLyBEZWJ1ZyBsb2dnaW5nIGZvciBEb2NrZXIgZW52aXJvbm1lbnRcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdBZGQgdG8gY2FydCByZXF1ZXN0OicsIHtcbiAgICAgICAgcHJvZHVjdElkLFxuICAgICAgICBxdWFudGl0eSxcbiAgICAgICAgdXNlcjogcmVxLnVzZXIgPyAnYXV0aGVudGljYXRlZCcgOiAnZ3Vlc3QnLFxuICAgICAgICBzZXNzaW9uSWQ6IHJlcS5zZXNzaW9uSUQsXG4gICAgICAgIGd1ZXN0U2Vzc2lvbklkOiByZXEuaGVhZGVyc1sneC1ndWVzdC1zZXNzaW9uLWlkJ10sXG4gICAgICAgIGNzcmZUb2tlbjogcmVxLmhlYWRlcnNbJ3gtY3NyZi10b2tlbiddID8gJ3ByZXNlbnQnIDogJ21pc3NpbmcnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0aW9uXG4gICAgaWYgKCFwcm9kdWN0SWQpIHtcbiAgICAgIHJldHVybiByZXMuZXJyb3IoNDAwLCBFcnJvckNvZGVzLk1JU1NJTkdfUFJPRFVDVF9JRCwgJ1Byb2R1Y3QgSUQgaXMgcmVxdWlyZWQnKTtcbiAgICB9XG5cbiAgICAvLyBFbmhhbmNlZCBxdWFudGl0eSB2YWxpZGF0aW9uIHRvIHByZXZlbnQgaW50ZWdlciBvdmVyZmxvdyBhbmQgb3RoZXIgZWRnZSBjYXNlc1xuICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihxdWFudGl0eSkgfHwgcXVhbnRpdHkgPCAxIHx8IHF1YW50aXR5ID4gOTkpIHtcbiAgICAgIHJldHVybiByZXMuZXJyb3IoNDAwLCBFcnJvckNvZGVzLklOVkFMSURfUVVBTlRJVFksICdRdWFudGl0eSBtdXN0IGJlIGJldHdlZW4gMSBhbmQgOTknKTtcbiAgICB9XG5cbiAgICAvLyBBZGRpdGlvbmFsIHNhZmV0eSBjaGVjayBmb3IgcG90ZW50aWFsIGludGVnZXIgb3ZlcmZsb3dcbiAgICBpZiAocXVhbnRpdHkgPiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUikge1xuICAgICAgcmV0dXJuIHJlcy5lcnJvcig0MDAsIEVycm9yQ29kZXMuSU5WQUxJRF9RVUFOVElUWSwgJ1F1YW50aXR5IHZhbHVlIGlzIHRvbyBsYXJnZScpO1xuICAgIH1cblxuICAgICAgICAvLyBWYWxpZGF0ZSBwcm9kdWN0IElEIGZvcm1hdFxuICAgIGlmICghcHJvZHVjdElkLm1hdGNoKC9eWzAtOWEtZkEtRl17MjR9JC8pKSB7XG4gICAgICByZXR1cm4gcmVzLmVycm9yKDQwMCwgRXJyb3JDb2Rlcy5JTlZBTElEX1BST0RVQ1RfSUQsICdJbnZhbGlkIHByb2R1Y3QgSUQgZm9ybWF0Jyk7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgcHJvZHVjdCBleGlzdHMgYW5kIGlzIGFjdGl2ZVxuICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0LmZpbmRCeUlkKHByb2R1Y3RJZCk7XG4gICAgaWYgKCFwcm9kdWN0KSB7XG4gICAgICByZXR1cm4gcmVzLmVycm9yKDQwNCwgRXJyb3JDb2Rlcy5QUk9EVUNUX05PVF9GT1VORCwgJ1Byb2R1Y3Qgbm90IGZvdW5kJyk7XG4gICAgfVxuICAgIFxuICAgIGlmICghcHJvZHVjdC5pc0FjdGl2ZSkge1xuICAgICAgcmV0dXJuIHJlcy5lcnJvcig0MDQsIEVycm9yQ29kZXMuUFJPRFVDVF9OT1RfRk9VTkQsICdQcm9kdWN0IG5vdCBmb3VuZCBvciBpbmFjdGl2ZScpO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBleGlzdGluZyBpdGVtIGFuZCB2YWxpZGF0ZSBtYXhpbXVtIHF1YW50aXR5XG4gICAgY29uc3QgeyB0eXBlLCBjYXJ0LCB1c2VyIH0gPSBhd2FpdCBnZXRPckNyZWF0ZUNhcnQocmVxKTtcbiAgICBcbiAgICBpZiAodHlwZSA9PT0gJ3VzZXInKSB7XG4gICAgICBjb25zdCBleGlzdGluZ0l0ZW1JbmRleCA9IHVzZXIuY2FydC5pdGVtcy5maW5kSW5kZXgoaXRlbSA9PiBcbiAgICAgICAgaXRlbS5wcm9kdWN0LnRvU3RyaW5nKCkgPT09IHByb2R1Y3RJZC50b1N0cmluZygpXG4gICAgICApO1xuICAgICAgXG4gICAgICBpZiAoZXhpc3RpbmdJdGVtSW5kZXggPj0gMCkge1xuICAgICAgICBjb25zdCBjdXJyZW50UXVhbnRpdHkgPSB1c2VyLmNhcnQuaXRlbXNbZXhpc3RpbmdJdGVtSW5kZXhdLnF1YW50aXR5O1xuICAgICAgICBjb25zdCBuZXdRdWFudGl0eSA9IGN1cnJlbnRRdWFudGl0eSArIHF1YW50aXR5O1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgZm9yIGludGVnZXIgb3ZlcmZsb3cgYW5kIG1heGltdW0gcXVhbnRpdHlcbiAgICAgICAgaWYgKG5ld1F1YW50aXR5ID4gOTkgfHwgbmV3UXVhbnRpdHkgPCBjdXJyZW50UXVhbnRpdHkpIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmVycm9yKDQwMCwgRXJyb3JDb2Rlcy5NQVhfUVVBTlRJVFlfRVhDRUVERUQsICdDYW5ub3QgZXhjZWVkIG1heGltdW0gcXVhbnRpdHkgb2YgOTknKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBleGlzdGluZ0l0ZW1JbmRleCA9IGNhcnQuaXRlbXMuZmluZEluZGV4KGl0ZW0gPT4gXG4gICAgICAgIGl0ZW0ucHJvZHVjdC50b1N0cmluZygpID09PSBwcm9kdWN0SWQudG9TdHJpbmcoKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgaWYgKGV4aXN0aW5nSXRlbUluZGV4ID49IDApIHtcbiAgICAgICAgY29uc3QgY3VycmVudFF1YW50aXR5ID0gY2FydC5pdGVtc1tleGlzdGluZ0l0ZW1JbmRleF0ucXVhbnRpdHk7XG4gICAgICAgIGNvbnN0IG5ld1F1YW50aXR5ID0gY3VycmVudFF1YW50aXR5ICsgcXVhbnRpdHk7XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBmb3IgaW50ZWdlciBvdmVyZmxvdyBhbmQgbWF4aW11bSBxdWFudGl0eVxuICAgICAgICBpZiAobmV3UXVhbnRpdHkgPiA5OSB8fCBuZXdRdWFudGl0eSA8IGN1cnJlbnRRdWFudGl0eSkge1xuICAgICAgICAgIHJldHVybiByZXMuZXJyb3IoNDAwLCBFcnJvckNvZGVzLk1BWF9RVUFOVElUWV9FWENFRURFRCwgJ0Nhbm5vdCBleGNlZWQgbWF4aW11bSBxdWFudGl0eSBvZiA5OScpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQWRkIGl0ZW0gdG8gY2FydCBkaXJlY3RseVxuICAgIGNvbnN0IGNhcnREYXRhID0gYXdhaXQgZ2V0T3JDcmVhdGVDYXJ0KHJlcSk7XG4gICAgXG4gICAgaWYgKGNhcnREYXRhLnR5cGUgPT09ICd1c2VyJykge1xuICAgICAgLy8gQWRkIHRvIHVzZXIncyBjYXJ0XG4gICAgICBjb25zdCBleGlzdGluZ0l0ZW1JbmRleCA9IGNhcnREYXRhLnVzZXIuY2FydC5pdGVtcy5maW5kSW5kZXgoaXRlbSA9PiBcbiAgICAgICAgaXRlbS5wcm9kdWN0LnRvU3RyaW5nKCkgPT09IHByb2R1Y3RJZC50b1N0cmluZygpXG4gICAgICApO1xuXG4gICAgICBpZiAoZXhpc3RpbmdJdGVtSW5kZXggPj0gMCkge1xuICAgICAgICBjYXJ0RGF0YS51c2VyLmNhcnQuaXRlbXNbZXhpc3RpbmdJdGVtSW5kZXhdLnF1YW50aXR5ICs9IHF1YW50aXR5O1xuICAgICAgICBjYXJ0RGF0YS51c2VyLmNhcnQuaXRlbXNbZXhpc3RpbmdJdGVtSW5kZXhdLmFkZGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2FydERhdGEudXNlci5jYXJ0Lml0ZW1zLnB1c2goe1xuICAgICAgICAgIHByb2R1Y3Q6IHByb2R1Y3RJZCxcbiAgICAgICAgICBxdWFudGl0eSxcbiAgICAgICAgICBwcmljZTogcHJvZHVjdC5wcmljZSxcbiAgICAgICAgICBhZGRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjYXJ0RGF0YS51c2VyLmNhcnQudXBkYXRlZEF0ID0gbmV3IERhdGUoKTtcbiAgICAgIGF3YWl0IGNhcnREYXRhLnVzZXIuc2F2ZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBBZGQgdG8gZ3Vlc3QgY2FydFxuICAgICAgY29uc3QgZXhpc3RpbmdJdGVtSW5kZXggPSBjYXJ0RGF0YS5jYXJ0Lml0ZW1zLmZpbmRJbmRleChpdGVtID0+IFxuICAgICAgICBpdGVtLnByb2R1Y3QudG9TdHJpbmcoKSA9PT0gcHJvZHVjdElkLnRvU3RyaW5nKClcbiAgICAgICk7XG5cbiAgICAgIGlmIChleGlzdGluZ0l0ZW1JbmRleCA+PSAwKSB7XG4gICAgICAgIGNhcnREYXRhLmNhcnQuaXRlbXNbZXhpc3RpbmdJdGVtSW5kZXhdLnF1YW50aXR5ICs9IHF1YW50aXR5O1xuICAgICAgICBjYXJ0RGF0YS5jYXJ0Lml0ZW1zW2V4aXN0aW5nSXRlbUluZGV4XS5hZGRlZEF0ID0gbmV3IERhdGUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNhcnREYXRhLmNhcnQuaXRlbXMucHVzaCh7XG4gICAgICAgICAgcHJvZHVjdDogcHJvZHVjdElkLFxuICAgICAgICAgIHF1YW50aXR5LFxuICAgICAgICAgIHByaWNlOiBwcm9kdWN0LnByaWNlLFxuICAgICAgICAgIGFkZGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBhd2FpdCBjYXJ0RGF0YS5jYXJ0LnNhdmUoKTtcbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gdXBkYXRlZCBjYXJ0XG4gICAgY29uc3QgdXBkYXRlZENhcnREYXRhID0gYXdhaXQgZ2V0T3JDcmVhdGVDYXJ0KHJlcSk7XG4gICAgXG4gICAgY29uc3QgcG9wdWxhdGVkQ2FydCA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgdXBkYXRlZENhcnREYXRhLmNhcnQuaXRlbXMubWFwKGFzeW5jIChpdGVtKSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2QgPSBhd2FpdCBQcm9kdWN0LmZpbmRCeUlkKGl0ZW0ucHJvZHVjdCkuc2VsZWN0KCctd2hvbGVzYWxlcicpO1xuICAgICAgICBpZiAoIXByb2QpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDsgLy8gRmlsdGVyIG91dCBtaXNzaW5nIHByb2R1Y3RzXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdXNlckN1cnJlbmN5ID0gZ2V0VXNlckN1cnJlbmN5KHJlcSk7XG4gICAgICAgIGNvbnN0IGxvY2FsZSA9IHJlcS5oZWFkZXJzWyd4LWxvY2FsZSddIHx8ICdlbic7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIF9pZDogaXRlbS5wcm9kdWN0LFxuICAgICAgICAgIHByb2R1Y3Q6IGVuaGFuY2VQcm9kdWN0V2l0aEN1cnJlbmN5KHByb2QsIHVzZXJDdXJyZW5jeSwgbG9jYWxlKSxcbiAgICAgICAgICBxdWFudGl0eTogaXRlbS5xdWFudGl0eSxcbiAgICAgICAgICBwcmljZTogaXRlbS5wcmljZSxcbiAgICAgICAgICBzdWJ0b3RhbDogaXRlbS5wcmljZSAqIGl0ZW0ucXVhbnRpdHlcbiAgICAgICAgfTtcbiAgICAgIH0pXG4gICAgKS50aGVuKGl0ZW1zID0+IGl0ZW1zLmZpbHRlcihpdGVtID0+IGl0ZW0gIT09IG51bGwpKTtcblxuICAgIGNvbnN0IGl0ZW1Db3VudCA9IHBvcHVsYXRlZENhcnQucmVkdWNlKCh0b3RhbCwgaXRlbSkgPT4gdG90YWwgKyBpdGVtLnF1YW50aXR5LCAwKTtcbiAgICBjb25zdCBzdWJ0b3RhbCA9IHBvcHVsYXRlZENhcnQucmVkdWNlKCh0b3RhbCwgaXRlbSkgPT4gdG90YWwgKyBpdGVtLnN1YnRvdGFsLCAwKTtcblxuICAgIHJlcy5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiAnSXRlbSBhZGRlZCB0byBjYXJ0JyxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgY2FydDoge1xuICAgICAgICAgIGl0ZW1zOiBwb3B1bGF0ZWRDYXJ0LFxuICAgICAgICAgIGl0ZW1Db3VudCxcbiAgICAgICAgICBzdWJ0b3RhbDogTWF0aC5yb3VuZChzdWJ0b3RhbCAqIDEwMCkgLyAxMDAsXG4gICAgICAgICAgdG90YWw6IE1hdGgucm91bmQoc3VidG90YWwgKiAxMDApIC8gMTAwXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFkZGluZyB0byBjYXJ0OicsIGVycm9yKTtcbiAgICBjb25zb2xlLmVycm9yKCdGdWxsIHN0YWNrOicsIGVycm9yLnN0YWNrKTtcbiAgICByZXMuZXJyb3IoNTAwLCBFcnJvckNvZGVzLkNBUlRfQUREX0VSUk9SLCAnRmFpbGVkIHRvIGFkZCBpdGVtIHRvIGNhcnQnLCB7XG4gICAgICBkZXRhaWxzOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyA/IGVycm9yLm1lc3NhZ2UgOiB1bmRlZmluZWQsXG4gICAgICBzdGFjazogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBlcnJvci5zdGFjayA6IHVuZGVmaW5lZFxuICAgIH0pO1xuICB9XG59KTtcblxuLy8gVXBkYXRlIGNhcnQgaXRlbSBxdWFudGl0eVxucm91dGVyLnB1dCgnL3VwZGF0ZScsIGF1dGhlbnRpY2F0ZVRva2VuLCB2YWxpZGF0ZUNTUkZUb2tlbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBwcm9kdWN0SWQsIHF1YW50aXR5IH0gPSByZXEuYm9keTtcblxuICAgIC8vIFZhbGlkYXRpb25cbiAgICBpZiAoIXByb2R1Y3RJZCkge1xuICAgICAgcmV0dXJuIHJlcy5lcnJvcig0MDAsIEVycm9yQ29kZXMuTUlTU0lOR19QUk9EVUNUX0lELCAnUHJvZHVjdCBJRCBpcyByZXF1aXJlZCcpO1xuICAgIH1cblxuICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihxdWFudGl0eSkgfHwgcXVhbnRpdHkgPCAwIHx8IHF1YW50aXR5ID4gOTkpIHtcbiAgICAgIHJldHVybiByZXMuZXJyb3IoNDAwLCBFcnJvckNvZGVzLklOVkFMSURfUVVBTlRJVFksICdRdWFudGl0eSBtdXN0IGJlIGJldHdlZW4gMCBhbmQgOTknKTtcbiAgICB9XG5cbiAgICBjb25zdCB7IHR5cGUsIGNhcnQsIHVzZXIgfSA9IGF3YWl0IGdldE9yQ3JlYXRlQ2FydChyZXEpO1xuXG4gICAgaWYgKHR5cGUgPT09ICd1c2VyJykge1xuICAgICAgLy8gVXBkYXRlIHVzZXIncyBjYXJ0XG4gICAgICBjb25zdCBpdGVtSW5kZXggPSB1c2VyLmNhcnQuaXRlbXMuZmluZEluZGV4KGl0ZW0gPT4gXG4gICAgICAgIGl0ZW0ucHJvZHVjdC50b1N0cmluZygpID09PSBwcm9kdWN0SWQudG9TdHJpbmcoKVxuICAgICAgKTtcblxuICAgICAgaWYgKGl0ZW1JbmRleCA+PSAwKSB7XG4gICAgICAgIGlmIChxdWFudGl0eSA9PT0gMCkge1xuICAgICAgICAgIHVzZXIuY2FydC5pdGVtcy5zcGxpY2UoaXRlbUluZGV4LCAxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB1c2VyLmNhcnQuaXRlbXNbaXRlbUluZGV4XS5xdWFudGl0eSA9IHF1YW50aXR5O1xuICAgICAgICAgIHVzZXIuY2FydC5pdGVtc1tpdGVtSW5kZXhdLmFkZGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHVzZXIuY2FydC51cGRhdGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiByZXMuZXJyb3IoNDA0LCBFcnJvckNvZGVzLklURU1fTk9UX0ZPVU5ELCAnSXRlbSBub3QgZm91bmQgaW4gY2FydCcpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBVcGRhdGUgZ3Vlc3QgY2FydFxuICAgICAgY29uc3QgaXRlbUluZGV4ID0gY2FydC5pdGVtcy5maW5kSW5kZXgoaXRlbSA9PiBcbiAgICAgICAgaXRlbS5wcm9kdWN0LnRvU3RyaW5nKCkgPT09IHByb2R1Y3RJZC50b1N0cmluZygpXG4gICAgICApO1xuICAgICAgXG4gICAgICBpZiAoaXRlbUluZGV4ID49IDApIHtcbiAgICAgICAgLy8gQWx3YXlzIHVzZSBkaXJlY3QgZGF0YWJhc2UgdXBkYXRlIGZvciBjb25zaXN0ZW5jeVxuICAgICAgICBsZXQgdXBkYXRlZEl0ZW1zID0gWy4uLmNhcnQuaXRlbXNdO1xuICAgICAgICBcbiAgICAgICAgaWYgKHF1YW50aXR5ID09PSAwKSB7XG4gICAgICAgICAgdXBkYXRlZEl0ZW1zLnNwbGljZShpdGVtSW5kZXgsIDEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHVwZGF0ZWRJdGVtc1tpdGVtSW5kZXhdID0ge1xuICAgICAgICAgICAgLi4udXBkYXRlZEl0ZW1zW2l0ZW1JbmRleF0sXG4gICAgICAgICAgICBxdWFudGl0eSxcbiAgICAgICAgICAgIGFkZGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBVc2UgYXRvbWljIHVwZGF0ZSB0byBwcmV2ZW50IHJhY2UgY29uZGl0aW9uc1xuICAgICAgICBjb25zdCB1cGRhdGVkQ2FydCA9IGF3YWl0IENhcnQuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICAgICAgY2FydC5faWQsXG4gICAgICAgICAgeyBcbiAgICAgICAgICAgIGl0ZW1zOiB1cGRhdGVkSXRlbXMsIFxuICAgICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpIFxuICAgICAgICAgIH0sXG4gICAgICAgICAgeyBuZXc6IHRydWUgfVxuICAgICAgICApO1xuICAgICAgICBjYXJ0Lml0ZW1zID0gdXBkYXRlZENhcnQuaXRlbXM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gcmVzLmVycm9yKDQwNCwgRXJyb3JDb2Rlcy5JVEVNX05PVF9GT1VORCwgJ0l0ZW0gbm90IGZvdW5kIGluIGNhcnQnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gdXBkYXRlZCBjYXJ0IC0gdXNlIHRoZSBhbHJlYWR5IG1vZGlmaWVkIGRhdGEgaW5zdGVhZCBvZiByZWZldGNoaW5nXG4gICAgY29uc3QgY2FydEl0ZW1zID0gdHlwZSA9PT0gJ3VzZXInID8gdXNlci5jYXJ0Lml0ZW1zIDogY2FydC5pdGVtcztcbiAgICBjb25zdCBwb3B1bGF0ZWRDYXJ0ID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICBjYXJ0SXRlbXMubWFwKGFzeW5jIChpdGVtKSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0LmZpbmRCeUlkKGl0ZW0ucHJvZHVjdCkuc2VsZWN0KCctd2hvbGVzYWxlcicpO1xuICAgICAgICBpZiAoIXByb2R1Y3QgfHwgIXByb2R1Y3QuaXNBY3RpdmUpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBfaWQ6IGl0ZW0ucHJvZHVjdCxcbiAgICAgICAgICBwcm9kdWN0OiBwcm9kdWN0LnRvUHVibGljSlNPTigpLFxuICAgICAgICAgIHF1YW50aXR5OiBpdGVtLnF1YW50aXR5LFxuICAgICAgICAgIHByaWNlOiBpdGVtLnByaWNlLFxuICAgICAgICAgIHN1YnRvdGFsOiBpdGVtLnByaWNlICogaXRlbS5xdWFudGl0eVxuICAgICAgICB9O1xuICAgICAgfSlcbiAgICApO1xuXG4gICAgY29uc3QgdmFsaWRDYXJ0SXRlbXMgPSBwb3B1bGF0ZWRDYXJ0LmZpbHRlcihpdGVtID0+IGl0ZW0gIT09IG51bGwpO1xuICAgIGNvbnN0IGl0ZW1Db3VudCA9IHZhbGlkQ2FydEl0ZW1zLnJlZHVjZSgodG90YWwsIGl0ZW0pID0+IHRvdGFsICsgaXRlbS5xdWFudGl0eSwgMCk7XG4gICAgY29uc3Qgc3VidG90YWwgPSB2YWxpZENhcnRJdGVtcy5yZWR1Y2UoKHRvdGFsLCBpdGVtKSA9PiB0b3RhbCArIGl0ZW0uc3VidG90YWwsIDApO1xuXG4gICAgLy8gQ2hlY2sgaWYgaXRlbSB3YXMgcmVtb3ZlZCAocXVhbnRpdHkgd2FzIDApXG4gICAgY29uc3Qgd2FzUmVtb3ZlZCA9IHF1YW50aXR5ID09PSAwO1xuICAgIFxuICAgIHJlcy5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiB3YXNSZW1vdmVkID8gJ0l0ZW0gcmVtb3ZlZCBmcm9tIGNhcnQnIDogJ0NhcnQgdXBkYXRlZCcsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIGNhcnQ6IHtcbiAgICAgICAgICBpdGVtczogdmFsaWRDYXJ0SXRlbXMsXG4gICAgICAgICAgaXRlbUNvdW50LFxuICAgICAgICAgIHN1YnRvdGFsOiBNYXRoLnJvdW5kKHN1YnRvdGFsICogMTAwKSAvIDEwMCxcbiAgICAgICAgICB0b3RhbDogTWF0aC5yb3VuZChzdWJ0b3RhbCAqIDEwMCkgLyAxMDBcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGNhcnRJdGVtQ291bnQ6IGl0ZW1Db3VudFxuICAgIH0pO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FydDonLCBlcnJvcik7XG4gICAgcmVzLmVycm9yKDUwMCwgRXJyb3JDb2Rlcy5DQVJUX1VQREFURV9FUlJPUiwgJ0ZhaWxlZCB0byB1cGRhdGUgY2FydCcpO1xuICB9XG59KTtcblxuLy8gUmVtb3ZlIGl0ZW0gZnJvbSBjYXJ0XG5yb3V0ZXIuZGVsZXRlKCcvcmVtb3ZlJywgYXV0aGVudGljYXRlVG9rZW4sIHZhbGlkYXRlQ1NSRlRva2VuLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IHByb2R1Y3RJZCB9ID0gcmVxLmJvZHk7XG5cbiAgICBpZiAoIXByb2R1Y3RJZCkge1xuICAgICAgcmV0dXJuIHJlcy5lcnJvcig0MDAsIEVycm9yQ29kZXMuTUlTU0lOR19QUk9EVUNUX0lELCAnUHJvZHVjdCBJRCBpcyByZXF1aXJlZCcpO1xuICAgIH1cblxuICAgIGNvbnN0IHsgdHlwZSwgY2FydCwgdXNlciB9ID0gYXdhaXQgZ2V0T3JDcmVhdGVDYXJ0KHJlcSk7XG5cbiAgICBpZiAodHlwZSA9PT0gJ3VzZXInKSB7XG4gICAgICAvLyBSZW1vdmUgZnJvbSB1c2VyJ3MgY2FydFxuICAgICAgY29uc3QgaXRlbUluZGV4ID0gdXNlci5jYXJ0Lml0ZW1zLmZpbmRJbmRleChpdGVtID0+IFxuICAgICAgICBpdGVtLnByb2R1Y3QudG9TdHJpbmcoKSA9PT0gcHJvZHVjdElkLnRvU3RyaW5nKClcbiAgICAgICk7XG5cbiAgICAgIGlmIChpdGVtSW5kZXggPj0gMCkge1xuICAgICAgICB1c2VyLmNhcnQuaXRlbXMuc3BsaWNlKGl0ZW1JbmRleCwgMSk7XG4gICAgICAgIHVzZXIuY2FydC51cGRhdGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiByZXMuZXJyb3IoNDA0LCBFcnJvckNvZGVzLklURU1fTk9UX0ZPVU5ELCAnSXRlbSBub3QgZm91bmQgaW4gY2FydCcpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBSZW1vdmUgZnJvbSBndWVzdCBjYXJ0XG4gICAgICBjb25zdCBpdGVtSW5kZXggPSBjYXJ0Lml0ZW1zLmZpbmRJbmRleChpdGVtID0+IFxuICAgICAgICBpdGVtLnByb2R1Y3QudG9TdHJpbmcoKSA9PT0gcHJvZHVjdElkLnRvU3RyaW5nKClcbiAgICAgICk7XG4gICAgICBcbiAgICAgIGlmIChpdGVtSW5kZXggPj0gMCkge1xuICAgICAgICAvLyBBbHdheXMgdXNlIGRpcmVjdCBkYXRhYmFzZSB1cGRhdGUgZm9yIGNvbnNpc3RlbmN5XG4gICAgICAgIGxldCB1cGRhdGVkSXRlbXMgPSBbLi4uY2FydC5pdGVtc107XG4gICAgICAgIHVwZGF0ZWRJdGVtcy5zcGxpY2UoaXRlbUluZGV4LCAxKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFVzZSBhdG9taWMgdXBkYXRlIHRvIHByZXZlbnQgcmFjZSBjb25kaXRpb25zXG4gICAgICAgIGNvbnN0IHVwZGF0ZWRDYXJ0ID0gYXdhaXQgQ2FydC5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgICAgICBjYXJ0Ll9pZCxcbiAgICAgICAgICB7IFxuICAgICAgICAgICAgaXRlbXM6IHVwZGF0ZWRJdGVtcywgXG4gICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkgXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7IG5ldzogdHJ1ZSB9XG4gICAgICAgICk7XG4gICAgICAgIGNhcnQuaXRlbXMgPSB1cGRhdGVkQ2FydC5pdGVtcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiByZXMuZXJyb3IoNDA0LCBFcnJvckNvZGVzLklURU1fTk9UX0ZPVU5ELCAnSXRlbSBub3QgZm91bmQgaW4gY2FydCcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFJldHVybiB1cGRhdGVkIGNhcnQgLSB1c2UgdGhlIGFscmVhZHkgbW9kaWZpZWQgZGF0YSBpbnN0ZWFkIG9mIHJlZmV0Y2hpbmdcbiAgICBjb25zdCBjYXJ0SXRlbXMgPSB0eXBlID09PSAndXNlcicgPyB1c2VyLmNhcnQuaXRlbXMgOiBjYXJ0Lml0ZW1zO1xuICAgIGNvbnN0IHBvcHVsYXRlZENhcnQgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgIGNhcnRJdGVtcy5tYXAoYXN5bmMgKGl0ZW0pID0+IHtcbiAgICAgICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IFByb2R1Y3QuZmluZEJ5SWQoaXRlbS5wcm9kdWN0KS5zZWxlY3QoJy13aG9sZXNhbGVyJyk7XG4gICAgICAgIGlmICghcHJvZHVjdCB8fCAhcHJvZHVjdC5pc0FjdGl2ZSkgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIF9pZDogaXRlbS5wcm9kdWN0LFxuICAgICAgICAgIHByb2R1Y3Q6IHByb2R1Y3QudG9QdWJsaWNKU09OKCksXG4gICAgICAgICAgcXVhbnRpdHk6IGl0ZW0ucXVhbnRpdHksXG4gICAgICAgICAgcHJpY2U6IGl0ZW0ucHJpY2UsXG4gICAgICAgICAgc3VidG90YWw6IGl0ZW0ucHJpY2UgKiBpdGVtLnF1YW50aXR5XG4gICAgICAgIH07XG4gICAgICB9KVxuICAgICk7XG5cbiAgICBjb25zdCB2YWxpZENhcnRJdGVtcyA9IHBvcHVsYXRlZENhcnQuZmlsdGVyKGl0ZW0gPT4gaXRlbSAhPT0gbnVsbCk7XG4gICAgY29uc3QgaXRlbUNvdW50ID0gdmFsaWRDYXJ0SXRlbXMucmVkdWNlKCh0b3RhbCwgaXRlbSkgPT4gdG90YWwgKyBpdGVtLnF1YW50aXR5LCAwKTtcbiAgICBjb25zdCBzdWJ0b3RhbCA9IHZhbGlkQ2FydEl0ZW1zLnJlZHVjZSgodG90YWwsIGl0ZW0pID0+IHRvdGFsICsgaXRlbS5zdWJ0b3RhbCwgMCk7XG5cbiAgICByZXMuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbWVzc2FnZTogJ0l0ZW0gcmVtb3ZlZCBmcm9tIGNhcnQnLFxuICAgICAgZGF0YToge1xuICAgICAgICBjYXJ0OiB7XG4gICAgICAgICAgaXRlbXM6IHZhbGlkQ2FydEl0ZW1zLFxuICAgICAgICAgIGl0ZW1Db3VudCxcbiAgICAgICAgICBzdWJ0b3RhbDogTWF0aC5yb3VuZChzdWJ0b3RhbCAqIDEwMCkgLyAxMDAsXG4gICAgICAgICAgdG90YWw6IE1hdGgucm91bmQoc3VidG90YWwgKiAxMDApIC8gMTAwXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBjYXJ0SXRlbUNvdW50OiBpdGVtQ291bnRcbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlbW92aW5nIGZyb20gY2FydDonLCBlcnJvcik7XG4gICAgcmVzLmVycm9yKDUwMCwgRXJyb3JDb2Rlcy5DQVJUX1JFTU9WRV9FUlJPUiwgJ0ZhaWxlZCB0byByZW1vdmUgaXRlbSBmcm9tIGNhcnQnKTtcbiAgfVxufSk7XG5cbi8vIENsZWFyIGNhcnRcbnJvdXRlci5kZWxldGUoJy9jbGVhcicsIGF1dGhlbnRpY2F0ZVRva2VuLCB2YWxpZGF0ZUNTUkZUb2tlbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyB0eXBlLCBjYXJ0LCB1c2VyIH0gPSBhd2FpdCBnZXRPckNyZWF0ZUNhcnQocmVxKTtcblxuICAgIGlmICh0eXBlID09PSAndXNlcicpIHtcbiAgICAgIC8vIENsZWFyIHVzZXIncyBjYXJ0XG4gICAgICB1c2VyLmNhcnQuaXRlbXMgPSBbXTtcbiAgICAgIHVzZXIuY2FydC51cGRhdGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgYXdhaXQgdXNlci5zYXZlKCk7XG4gICAgICBjb25zb2xlLmxvZygnQ2xlYXJlZCB1c2VyIGNhcnQgZm9yIHVzZXI6JywgdXNlci5faWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBDbGVhciBndWVzdCBjYXJ0IC0gdXNlIGF0b21pYyB1cGRhdGUgaW5zdGVhZCBvZiBkZWxldGUvcmVjcmVhdGVcbiAgICAgIGNvbnNvbGUubG9nKCdDbGVhcmluZyBndWVzdCBjYXJ0IGZvciBzZXNzaW9uOicsIGNhcnQuc2Vzc2lvbklkKTtcbiAgICAgIFxuICAgICAgLy8gRmlyc3QsIGRlbGV0ZSBBTEwgY2FydHMgd2l0aCB0aGlzIHNlc3Npb24gSUQgdG8gaGFuZGxlIGR1cGxpY2F0ZXNcbiAgICAgIGNvbnN0IGRlbGV0ZVJlc3VsdCA9IGF3YWl0IENhcnQuZGVsZXRlTWFueSh7IHNlc3Npb25JZDogY2FydC5zZXNzaW9uSWQgfSk7XG4gICAgICBjb25zb2xlLmxvZyhgRGVsZXRlZCAke2RlbGV0ZVJlc3VsdD8uZGVsZXRlZENvdW50IHx8IDB9IGNhcnQocykgZm9yIHNlc3Npb24gJHtjYXJ0LnNlc3Npb25JZH1gKTtcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIGEgc2luZ2xlIGZyZXNoIGNhcnRcbiAgICAgIGNvbnN0IG5ld0NhcnQgPSBuZXcgQ2FydCh7IHNlc3Npb25JZDogY2FydC5zZXNzaW9uSWQsIGl0ZW1zOiBbXSB9KTtcbiAgICAgIGF3YWl0IG5ld0NhcnQuc2F2ZSgpO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnQ3JlYXRlZCBmcmVzaCBndWVzdCBjYXJ0IGZvciBzZXNzaW9uOicsIGNhcnQuc2Vzc2lvbklkKTtcbiAgICB9XG5cbiAgICByZXMuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbWVzc2FnZTogJ0NhcnQgY2xlYXJlZCcsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIGNhcnQ6IHtcbiAgICAgICAgICBpdGVtczogW10sXG4gICAgICAgICAgaXRlbUNvdW50OiAwLFxuICAgICAgICAgIHN1YnRvdGFsOiAwLFxuICAgICAgICAgIHRvdGFsOiAwLFxuICAgICAgICAgIGlzRW1wdHk6IHRydWVcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGNhcnRJdGVtQ291bnQ6IDBcbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNsZWFyaW5nIGNhcnQ6JywgZXJyb3IpO1xuICAgIHJlcy5lcnJvcig1MDAsIEVycm9yQ29kZXMuQ0FSVF9DTEVBUl9FUlJPUiwgJ0ZhaWxlZCB0byBjbGVhciBjYXJ0Jyk7XG4gIH1cbn0pO1xuXG4vLyBNZXJnZSBndWVzdCBjYXJ0IHdpdGggdXNlciBjYXJ0IHdpdGggY29uZmxpY3QgcmVzb2x1dGlvblxucm91dGVyLnBvc3QoJy9tZXJnZScsIGF1dGhlbnRpY2F0ZVRva2VuLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBpZiAoIXJlcS51c2VyKSB7XG4gICAgICByZXR1cm4gcmVzLmVycm9yKDQwMSwgRXJyb3JDb2Rlcy5BVVRIRU5USUNBVElPTl9SRVFVSVJFRCwgJ1VzZXIgbXVzdCBiZSBhdXRoZW50aWNhdGVkIHRvIG1lcmdlIGNhcnQnKTtcbiAgICB9XG5cbiAgICBjb25zdCB7IGd1ZXN0Q2FydEl0ZW1zLCBzZXNzaW9uSWQgfSA9IHJlcS5ib2R5O1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdDYXJ0IG1lcmdlIHJlcXVlc3Q6JywgeyBcbiAgICAgIHVzZXJJZDogcmVxLnVzZXIuX2lkLCBcbiAgICAgIHNlc3Npb25JZCwgXG4gICAgICBndWVzdEl0ZW1Db3VudDogZ3Vlc3RDYXJ0SXRlbXM/Lmxlbmd0aCB8fCAwIFxuICAgIH0pO1xuICAgIFxuICAgIC8vIE1lcmdlIGNhcnQgbG9naWMgZGlyZWN0bHlcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZChyZXEudXNlci5faWQpO1xuICAgIGlmICghdXNlci5jYXJ0KSB7XG4gICAgICB1c2VyLmNhcnQgPSB7IGl0ZW1zOiBbXSwgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpIH07XG4gICAgfVxuXG4gICAgbGV0IG1lcmdlZEl0ZW1zID0gMDtcblxuICAgIC8vIFByb2Nlc3MgZ3Vlc3QgY2FydCBpdGVtcyAtIHVzZSBlaXRoZXIgZ3Vlc3RDYXJ0SXRlbXMgT1Igc2Vzc2lvbi1iYXNlZCBjYXJ0LCBub3QgYm90aFxuICAgIGlmIChndWVzdENhcnRJdGVtcyAmJiBBcnJheS5pc0FycmF5KGd1ZXN0Q2FydEl0ZW1zKSAmJiBndWVzdENhcnRJdGVtcy5sZW5ndGggPiAwKSB7XG4gICAgICAvLyBGcm9udGVuZCBzZW50IGNhcnQgaXRlbXMgZGlyZWN0bHksIHVzZSB0aG9zZVxuICAgICAgZm9yIChjb25zdCBndWVzdEl0ZW0gb2YgZ3Vlc3RDYXJ0SXRlbXMpIHtcbiAgICAgICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IFByb2R1Y3QuZmluZEJ5SWQoZ3Vlc3RJdGVtLnByb2R1Y3RJZCB8fCBndWVzdEl0ZW0ucHJvZHVjdCk7XG4gICAgICAgIGlmICghcHJvZHVjdCB8fCAhcHJvZHVjdC5pc0FjdGl2ZSkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcHJvZHVjdElkID0gZ3Vlc3RJdGVtLnByb2R1Y3RJZCB8fCBndWVzdEl0ZW0ucHJvZHVjdDtcbiAgICAgICAgY29uc3QgcXVhbnRpdHkgPSBndWVzdEl0ZW0ucXVhbnRpdHkgfHwgMTtcblxuICAgICAgICBjb25zdCBleGlzdGluZ0l0ZW1JbmRleCA9IHVzZXIuY2FydC5pdGVtcy5maW5kSW5kZXgoaXRlbSA9PiBcbiAgICAgICAgICBpdGVtLnByb2R1Y3QudG9TdHJpbmcoKSA9PT0gcHJvZHVjdElkLnRvU3RyaW5nKClcbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoZXhpc3RpbmdJdGVtSW5kZXggPj0gMCkge1xuICAgICAgICAgIC8vIEFkZCBndWVzdCBxdWFudGl0eSB0byBleGlzdGluZyB1c2VyIGNhcnQgcXVhbnRpdHlcbiAgICAgICAgICB1c2VyLmNhcnQuaXRlbXNbZXhpc3RpbmdJdGVtSW5kZXhdLnF1YW50aXR5ICs9IHF1YW50aXR5O1xuICAgICAgICAgIHVzZXIuY2FydC5pdGVtc1tleGlzdGluZ0l0ZW1JbmRleF0uYWRkZWRBdCA9IG5ldyBEYXRlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdXNlci5jYXJ0Lml0ZW1zLnB1c2goe1xuICAgICAgICAgICAgcHJvZHVjdDogcHJvZHVjdElkLFxuICAgICAgICAgICAgcXVhbnRpdHksXG4gICAgICAgICAgICBwcmljZTogcHJvZHVjdC5wcmljZSxcbiAgICAgICAgICAgIGFkZGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBtZXJnZWRJdGVtcysrO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBDbGVhbiB1cCB0aGUgZ3Vlc3QgY2FydCBmcm9tIGRhdGFiYXNlIGlmIHNlc3Npb25JZCBwcm92aWRlZFxuICAgICAgaWYgKHNlc3Npb25JZCkge1xuICAgICAgICBhd2FpdCBDYXJ0LmRlbGV0ZU9uZSh7IHNlc3Npb25JZCB9KTtcbiAgICAgICAgY29uc29sZS5sb2coJ0RlbGV0ZWQgZ3Vlc3QgY2FydCBmb3Igc2Vzc2lvbjonLCBzZXNzaW9uSWQpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoc2Vzc2lvbklkKSB7XG4gICAgICAvLyBObyBpdGVtcyBzZW50IGZyb20gZnJvbnRlbmQsIHRyeSB0byBsb2FkIGZyb20gZGF0YWJhc2VcbiAgICAgIGNvbnN0IGd1ZXN0Q2FydCA9IGF3YWl0IENhcnQuZmluZE9uZSh7IHNlc3Npb25JZCB9KTtcbiAgICAgIGlmIChndWVzdENhcnQgJiYgZ3Vlc3RDYXJ0Lml0ZW1zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0ZvdW5kIGd1ZXN0IGNhcnQgd2l0aCcsIGd1ZXN0Q2FydC5pdGVtcy5sZW5ndGgsICdpdGVtcyBmb3Igc2Vzc2lvbjonLCBzZXNzaW9uSWQpO1xuICAgICAgICBcbiAgICAgICAgZm9yIChjb25zdCBndWVzdEl0ZW0gb2YgZ3Vlc3RDYXJ0Lml0ZW1zKSB7XG4gICAgICAgICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IFByb2R1Y3QuZmluZEJ5SWQoZ3Vlc3RJdGVtLnByb2R1Y3QpO1xuICAgICAgICAgIGlmICghcHJvZHVjdCB8fCAhcHJvZHVjdC5pc0FjdGl2ZSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgZXhpc3RpbmdJdGVtSW5kZXggPSB1c2VyLmNhcnQuaXRlbXMuZmluZEluZGV4KGl0ZW0gPT4gXG4gICAgICAgICAgICBpdGVtLnByb2R1Y3QudG9TdHJpbmcoKSA9PT0gZ3Vlc3RJdGVtLnByb2R1Y3QudG9TdHJpbmcoKVxuICAgICAgICAgICk7XG5cbiAgICAgICAgICBpZiAoZXhpc3RpbmdJdGVtSW5kZXggPj0gMCkge1xuICAgICAgICAgICAgLy8gQWRkIGd1ZXN0IHF1YW50aXR5IHRvIGV4aXN0aW5nIHVzZXIgY2FydCBxdWFudGl0eVxuICAgICAgICAgICAgdXNlci5jYXJ0Lml0ZW1zW2V4aXN0aW5nSXRlbUluZGV4XS5xdWFudGl0eSArPSBndWVzdEl0ZW0ucXVhbnRpdHk7XG4gICAgICAgICAgICB1c2VyLmNhcnQuaXRlbXNbZXhpc3RpbmdJdGVtSW5kZXhdLmFkZGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB1c2VyLmNhcnQuaXRlbXMucHVzaCh7XG4gICAgICAgICAgICAgIHByb2R1Y3Q6IGd1ZXN0SXRlbS5wcm9kdWN0LFxuICAgICAgICAgICAgICBxdWFudGl0eTogZ3Vlc3RJdGVtLnF1YW50aXR5LFxuICAgICAgICAgICAgICBwcmljZTogZ3Vlc3RJdGVtLnByaWNlLFxuICAgICAgICAgICAgICBhZGRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVyZ2VkSXRlbXMrKztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ2xlYW4gdXAgdGhlIGd1ZXN0IGNhcnQgYWZ0ZXIgbWVyZ2VcbiAgICAgICAgYXdhaXQgQ2FydC5kZWxldGVPbmUoeyBzZXNzaW9uSWQgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdEZWxldGVkIGd1ZXN0IGNhcnQgZm9yIHNlc3Npb246Jywgc2Vzc2lvbklkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdObyBndWVzdCBjYXJ0IGZvdW5kIGZvciBzZXNzaW9uOicsIHNlc3Npb25JZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdXNlci5jYXJ0LnVwZGF0ZWRBdCA9IG5ldyBEYXRlKCk7XG4gICAgYXdhaXQgdXNlci5zYXZlKCk7XG4gICAgXG4gICAgY29uc3QgbWVyZ2VSZXN1bHQgPSB7XG4gICAgICBtZXJnZWRJdGVtcyxcbiAgICAgIGNvbmZsaWN0czogW10sXG4gICAgICBkdXJhdGlvbjogMFxuICAgIH07XG5cbiAgICAvLyBHZXQgdXBkYXRlZCBjYXJ0IGRhdGFcbiAgICBjb25zdCB1cGRhdGVkQ2FydERhdGEgPSBhd2FpdCBnZXRPckNyZWF0ZUNhcnQocmVxKTtcbiAgICBcbiAgICAvLyBSZXR1cm4gdXBkYXRlZCB1c2VyIGNhcnRcbiAgICBjb25zdCBwb3B1bGF0ZWRDYXJ0ID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICB1cGRhdGVkQ2FydERhdGEuY2FydC5pdGVtcy5tYXAoYXN5bmMgKGl0ZW0pID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBwcm9kdWN0ID0gYXdhaXQgUHJvZHVjdC5maW5kQnlJZChpdGVtLnByb2R1Y3QpLnNlbGVjdCgnLXdob2xlc2FsZXInKTtcbiAgICAgICAgICBpZiAoIXByb2R1Y3QgfHwgIXByb2R1Y3QuaXNBY3RpdmUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsOyAvLyBGaWx0ZXIgb3V0IGluYWN0aXZlIHByb2R1Y3RzXG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIGNvbnN0IHVzZXJDdXJyZW5jeSA9IGdldFVzZXJDdXJyZW5jeShyZXEpO1xuICAgICAgICAgIGNvbnN0IGxvY2FsZSA9IHJlcS5oZWFkZXJzWyd4LWxvY2FsZSddIHx8ICdlbic7XG4gICAgICAgICAgXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIF9pZDogaXRlbS5wcm9kdWN0LFxuICAgICAgICAgICAgcHJvZHVjdDogZW5oYW5jZVByb2R1Y3RXaXRoQ3VycmVuY3kocHJvZHVjdCwgdXNlckN1cnJlbmN5LCBsb2NhbGUpLFxuICAgICAgICAgICAgcXVhbnRpdHk6IGl0ZW0ucXVhbnRpdHksXG4gICAgICAgICAgICBwcmljZTogaXRlbS5wcmljZSxcbiAgICAgICAgICAgIHN1YnRvdGFsOiBpdGVtLnByaWNlICogaXRlbS5xdWFudGl0eVxuICAgICAgICAgIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcG9wdWxhdGluZyBjYXJ0IGl0ZW06JywgZXJyb3IpO1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICk7XG5cbiAgICAvLyBGaWx0ZXIgb3V0IG51bGwgaXRlbXMgKGluYWN0aXZlIHByb2R1Y3RzKVxuICAgIGNvbnN0IHZhbGlkQ2FydEl0ZW1zID0gcG9wdWxhdGVkQ2FydC5maWx0ZXIoaXRlbSA9PiBpdGVtICE9PSBudWxsKTtcbiAgICBjb25zdCBpdGVtQ291bnQgPSB2YWxpZENhcnRJdGVtcy5yZWR1Y2UoKHRvdGFsLCBpdGVtKSA9PiB0b3RhbCArIGl0ZW0ucXVhbnRpdHksIDApO1xuICAgIGNvbnN0IHN1YnRvdGFsID0gdmFsaWRDYXJ0SXRlbXMucmVkdWNlKCh0b3RhbCwgaXRlbSkgPT4gdG90YWwgKyBpdGVtLnN1YnRvdGFsLCAwKTtcblxuICAgIHJlcy5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiBgU3VjY2Vzc2Z1bGx5IG1lcmdlZCAke21lcmdlUmVzdWx0Lm1lcmdlZEl0ZW1zfSBpdGVtcyBpbnRvIHlvdXIgY2FydGAsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIGNhcnQ6IHtcbiAgICAgICAgICBpdGVtczogdmFsaWRDYXJ0SXRlbXMsXG4gICAgICAgICAgaXRlbUNvdW50LFxuICAgICAgICAgIHN1YnRvdGFsOiBNYXRoLnJvdW5kKHN1YnRvdGFsICogMTAwKSAvIDEwMCxcbiAgICAgICAgICB0b3RhbDogTWF0aC5yb3VuZChzdWJ0b3RhbCAqIDEwMCkgLyAxMDAsXG4gICAgICAgICAgaXNFbXB0eTogdmFsaWRDYXJ0SXRlbXMubGVuZ3RoID09PSAwXG4gICAgICAgIH0sXG4gICAgICAgIG1lcmdlOiB7XG4gICAgICAgICAgbWVyZ2VkSXRlbXM6IG1lcmdlUmVzdWx0Lm1lcmdlZEl0ZW1zLFxuICAgICAgICAgIGNvbmZsaWN0czogbWVyZ2VSZXN1bHQuY29uZmxpY3RzLFxuICAgICAgICAgIGR1cmF0aW9uOiBtZXJnZVJlc3VsdC5kdXJhdGlvblxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtZXJnaW5nIGd1ZXN0IGNhcnQ6JywgZXJyb3IpO1xuICAgIHJlcy5lcnJvcig1MDAsIEVycm9yQ29kZXMuQ0FSVF9NRVJHRV9FUlJPUiwgJ0ZhaWxlZCB0byBtZXJnZSBndWVzdCBjYXJ0Jywge1xuICAgICAgZGV0YWlsczogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBlcnJvci5tZXNzYWdlIDogdW5kZWZpbmVkXG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vLyBSZXNldCBndWVzdCBjYXJ0IHNlc3Npb24gLSBoZWxwcyBmaXggY2FydCBwZXJzaXN0ZW5jZSBpc3N1ZXNcbnJvdXRlci5wb3N0KCcvcmVzZXQtZ3Vlc3Qtc2Vzc2lvbicsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIC8vIE9ubHkgYWxsb3cgdGhpcyBmb3Igbm9uLWF1dGhlbnRpY2F0ZWQgdXNlcnMgKGd1ZXN0cylcbiAgICBpZiAocmVxLnVzZXIpIHtcbiAgICAgIHJldHVybiByZXMuZXJyb3IoNDAwLCBFcnJvckNvZGVzLk5PVF9HVUVTVF9VU0VSLCAnVGhpcyBlbmRwb2ludCBpcyBvbmx5IGZvciBndWVzdCB1c2VycycpO1xuICAgIH1cblxuICAgIC8vIEdldCB0aGUgb2xkIHNlc3Npb24gSUQgZnJvbSBoZWFkZXJcbiAgICBjb25zdCBvbGRTZXNzaW9uSWQgPSByZXEuaGVhZGVyc1sneC1ndWVzdC1zZXNzaW9uLWlkJ107XG4gICAgXG4gICAgLy8gRGVsZXRlIG9sZCBndWVzdCBjYXJ0IGlmIGl0IGV4aXN0c1xuICAgIGlmIChvbGRTZXNzaW9uSWQgJiYgb2xkU2Vzc2lvbklkLnN0YXJ0c1dpdGgoJ2d1ZXN0XycpKSB7XG4gICAgICBjb25zdCBkZWxldGVSZXN1bHQgPSBhd2FpdCBDYXJ0LmRlbGV0ZU1hbnkoeyBzZXNzaW9uSWQ6IG9sZFNlc3Npb25JZCB9KTtcbiAgICAgIGNvbnNvbGUubG9nKGBEZWxldGVkICR7ZGVsZXRlUmVzdWx0Py5kZWxldGVkQ291bnQgfHwgMH0gZ3Vlc3QgY2FydChzKSBmb3Igb2xkIHNlc3Npb24gJHtvbGRTZXNzaW9uSWR9YCk7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGEgZnJlc2ggZ3Vlc3Qgc2Vzc2lvbiBJRFxuICAgIGNvbnN0IG5ld1Nlc3Npb25JZCA9IGBndWVzdF8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG5cbiAgICAvLyBDcmVhdGUgYSBmcmVzaCBlbXB0eSBjYXJ0XG4gICAgY29uc3QgbmV3Q2FydCA9IG5ldyBDYXJ0KHsgc2Vzc2lvbklkOiBuZXdTZXNzaW9uSWQsIGl0ZW1zOiBbXSB9KTtcbiAgICBhd2FpdCBuZXdDYXJ0LnNhdmUoKTtcblxuICAgIHJlcy5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiAnR3Vlc3QgY2FydCBzZXNzaW9uIHJlc2V0IHN1Y2Nlc3NmdWxseScsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHNlc3Npb25JZDogbmV3U2Vzc2lvbklkLFxuICAgICAgICBjYXJ0OiB7XG4gICAgICAgICAgaXRlbXM6IFtdLFxuICAgICAgICAgIGl0ZW1Db3VudDogMCxcbiAgICAgICAgICBzdWJ0b3RhbDogMCxcbiAgICAgICAgICB0b3RhbDogMCxcbiAgICAgICAgICBpc0VtcHR5OiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlc2V0dGluZyBndWVzdCBjYXJ0IHNlc3Npb246JywgZXJyb3IpO1xuICAgIHJlcy5lcnJvcig1MDAsIEVycm9yQ29kZXMuUkVTRVRfU0VTU0lPTl9FUlJPUiwgJ0ZhaWxlZCB0byByZXNldCBndWVzdCBjYXJ0IHNlc3Npb24nKTtcbiAgfVxufSk7XG5cbi8vIERlYnVnIGVuZHBvaW50IHRvIHNlZSBhbGwgZ3Vlc3QgY2FydHMgKGRldmVsb3BtZW50IG9ubHkpXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgcm91dGVyLmdldCgnL2RlYnVnJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGd1ZXN0Q2FydHMgPSBhd2FpdCBDYXJ0LmZpbmQoe30pLnNlbGVjdCgnc2Vzc2lvbklkIGl0ZW1zIGNyZWF0ZWRBdCB1cGRhdGVkQXQnKTtcbiAgICAgIGNvbnN0IHVzZXJDYXJ0cyA9IGF3YWl0IFVzZXIuZmluZCh7ICdjYXJ0Lml0ZW1zLjAnOiB7ICRleGlzdHM6IHRydWUgfSB9KVxuICAgICAgICAuc2VsZWN0KCdlbWFpbCBjYXJ0Lml0ZW1zIGNhcnQudXBkYXRlZEF0Jyk7XG4gICAgICBcbiAgICAgIHJlcy5qc29uKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGd1ZXN0Q2FydHM6IGd1ZXN0Q2FydHMubWFwKGNhcnQgPT4gKHtcbiAgICAgICAgICAgIHNlc3Npb25JZDogY2FydC5zZXNzaW9uSWQsXG4gICAgICAgICAgICBpdGVtQ291bnQ6IGNhcnQuaXRlbXMubGVuZ3RoLFxuICAgICAgICAgICAgaXRlbXM6IGNhcnQuaXRlbXMsXG4gICAgICAgICAgICBjcmVhdGVkQXQ6IGNhcnQuY3JlYXRlZEF0LFxuICAgICAgICAgICAgdXBkYXRlZEF0OiBjYXJ0LnVwZGF0ZWRBdFxuICAgICAgICAgIH0pKSxcbiAgICAgICAgICB1c2VyQ2FydHM6IHVzZXJDYXJ0cy5tYXAodXNlciA9PiAoe1xuICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgICBpdGVtQ291bnQ6IHVzZXIuY2FydD8uaXRlbXM/Lmxlbmd0aCB8fCAwLFxuICAgICAgICAgICAgaXRlbXM6IHVzZXIuY2FydD8uaXRlbXMgfHwgW10sXG4gICAgICAgICAgICB1cGRhdGVkQXQ6IHVzZXIuY2FydD8udXBkYXRlZEF0XG4gICAgICAgICAgfSkpLFxuICAgICAgICAgIGN1cnJlbnRTZXNzaW9uOiB7XG4gICAgICAgICAgICBndWVzdFNlc3Npb25JZDogcmVxLmhlYWRlcnNbJ3gtZ3Vlc3Qtc2Vzc2lvbi1pZCddLFxuICAgICAgICAgICAgc2VydmVyU2Vzc2lvbklkOiByZXEuc2Vzc2lvbklEXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmVzLmVycm9yKDUwMCwgRXJyb3JDb2Rlcy5JTlRFUk5BTF9FUlJPUiwgZXJyb3IubWVzc2FnZSk7XG4gICAgfVxuICB9KTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTUMsTUFBTSxHQUFHRixPQUFPLENBQUNHLE1BQU0sQ0FBQyxDQUFDO0FBQy9CLE1BQU1DLE9BQU8sR0FBR0gsT0FBTyxDQUFDLG1CQUFtQixDQUFDO0FBQzVDLE1BQU1JLElBQUksR0FBR0osT0FBTyxDQUFDLGdCQUFnQixDQUFDO0FBQ3RDLE1BQU1LLElBQUksR0FBR0wsT0FBTyxDQUFDLGdCQUFnQixDQUFDO0FBQ3RDLE1BQU07RUFBRU07QUFBa0IsQ0FBQyxHQUFHTixPQUFPLENBQUMsb0JBQW9CLENBQUM7QUFDM0QsTUFBTTtFQUFFTztBQUFrQixDQUFDLEdBQUdQLE9BQU8sQ0FBQywyQkFBMkIsQ0FBQztBQUNsRSxNQUFNO0VBQUVRLG9CQUFvQjtFQUFFQztBQUFZLENBQUMsR0FBR1QsT0FBTyxDQUFDLG1CQUFtQixDQUFDO0FBQzFFLE1BQU07RUFBRVU7QUFBVyxDQUFDLEdBQUdWLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQzs7QUFFdkQ7QUFDQSxTQUFTVyxlQUFlQSxDQUFDQyxHQUFHLEVBQUU7RUFDNUI7RUFDQSxJQUFJQSxHQUFHLENBQUNDLEtBQUssQ0FBQ0MsUUFBUSxFQUFFLE9BQU9GLEdBQUcs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