3c20865d048aad89070ad3570b5d588c
// Clear the global mock for emailService to test the actual implementation

// Mock nodemailer for this test
_getJestObj().unmock('../../utils/emailService');
_getJestObj().mock('nodemailer');
function _getJestObj() {
  const {
    jest
  } = require("@jest/globals");
  _getJestObj = () => jest;
  return jest;
}
const nodemailer = require('nodemailer');
const {
  sendOrderConfirmation,
  sendWelcomeEmail,
  sendPaymentReceipt,
  emailTemplates
} = require('../../utils/emailService');
describe('Email Service Unit Tests', () => {
  // Mock environment variables
  const originalEnv = process.env;
  beforeEach(() => {
    jest.resetModules();
    process.env = {
      ...originalEnv
    };
  });
  afterAll(() => {
    process.env = originalEnv;
  });
  describe('Email Service Configuration', () => {
    test('should skip emails when not configured', async () => {
      // Remove email configuration
      delete process.env.EMAIL_HOST;
      delete process.env.EMAIL_USER;
      const result = await sendOrderConfirmation('test@example.com', {
        orderNumber: 'TEST-123',
        customerName: 'Test User',
        items: [],
        total: 100,
        shippingAddress: {
          firstName: 'Test',
          lastName: 'User',
          street: '123 Test St',
          city: 'Test City',
          state: 'TS',
          zipCode: '12345',
          country: 'US'
        }
      });
      expect(result.success).toBe(true);
      expect(result.message).toBe('Email skipped - not configured');
    });
    test('should handle email sending errors gracefully', async () => {
      // Set up email config
      process.env.EMAIL_HOST = 'smtp.test.com';
      process.env.EMAIL_USER = 'test@test.com';
      process.env.EMAIL_PASS = 'testpass';

      // Mock nodemailer to simulate SMTP failure
      const mockTransporter = {
        sendMail: jest.fn().mockRejectedValue(new Error('SMTP connection failed'))
      };
      nodemailer.createTransport = jest.fn().mockReturnValue(mockTransporter);

      // Email will fail because the SMTP server doesn't exist
      const result = await sendWelcomeEmail('test@example.com', {
        firstName: 'Test',
        email: 'test@example.com'
      });
      expect(result.success).toBe(false);
      expect(result.error).toBeDefined();
    });
  });
  describe('Email Templates', () => {
    test('should generate order confirmation template', () => {
      const orderData = {
        orderNumber: 'ORD-12345',
        customerName: 'John Doe',
        items: [{
          productName: 'Crystal',
          quantity: 2,
          price: 29.99
        }, {
          productName: 'Essential Oil',
          quantity: 1,
          price: 19.99
        }],
        total: 79.97,
        shippingAddress: {
          firstName: 'John',
          lastName: 'Doe',
          street: '123 Main St',
          city: 'Paris',
          state: 'IDF',
          zipCode: '75001',
          country: 'FR'
        }
      };
      const template = emailTemplates.orderConfirmation(orderData);
      expect(template.subject).toBe('Order Confirmation - ORD-12345');
      expect(template.text).toContain('John Doe');
      expect(template.text).toContain('Crystal (Qty: 2) - $29.99');
      expect(template.text).toContain('Essential Oil (Qty: 1) - $19.99');
      expect(template.text).toContain('$79.97');
      expect(template.html).toContain('<h2');
      expect(template.html).toContain('Order Confirmation');
    });
    test('should generate payment receipt template', () => {
      const paymentData = {
        orderNumber: 'ORD-12345',
        customerName: 'Jane Smith',
        total: 99.99,
        paymentMethod: 'Credit Card',
        transactionId: 'TXN-98765',
        paidAt: new Date('2024-01-15')
      };
      const template = emailTemplates.paymentReceipt(paymentData);
      expect(template.subject).toBe('Payment Receipt - ORD-12345');
      expect(template.text).toContain('Jane Smith');
      expect(template.text).toContain('$99.99');
      expect(template.text).toContain('TXN-98765');
      expect(template.html).toContain('Payment Receipt');
    });
    test('should generate welcome email template', () => {
      const userData = {
        firstName: 'Alice',
        email: 'alice@example.com'
      };
      const template = emailTemplates.welcomeEmail(userData);
      expect(template.subject).toBe('Welcome to Our Holistic Store!');
      expect(template.text).toContain('Dear Alice');
      expect(template.text).toContain('holistic wellness community');
      expect(template.html).toContain('Welcome to Our Holistic Store!');
    });
    test('should generate order status update template', () => {
      const statusData = {
        orderNumber: 'ORD-12345',
        customerName: 'Bob Johnson',
        status: 'shipped',
        trackingNumber: 'TRACK-123456'
      };
      const template = emailTemplates.orderStatusUpdate(statusData);
      expect(template.subject).toBe('Order Update - ORD-12345');
      expect(template.text).toContain('Bob Johnson');
      expect(template.text).toContain('Status: Shipped');
      expect(template.text).toContain('Your order has been shipped');
      expect(template.text).toContain('TRACK-123456');
    });
    test('should generate password reset template', () => {
      const resetData = {
        firstName: 'Charlie',
        resetToken: 'reset-token-123',
        resetUrl: 'https://example.com/reset?token=reset-token-123'
      };
      const template = emailTemplates.passwordReset(resetData);
      expect(template.subject).toBe('Password Reset Request');
      expect(template.text).toContain('Dear Charlie');
      expect(template.text).toContain(resetData.resetUrl);
      expect(template.text).toContain('expire in 1 hour');
      expect(template.html).toContain('Reset Password');
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsInVubW9jayIsIm1vY2siLCJqZXN0IiwicmVxdWlyZSIsIm5vZGVtYWlsZXIiLCJzZW5kT3JkZXJDb25maXJtYXRpb24iLCJzZW5kV2VsY29tZUVtYWlsIiwic2VuZFBheW1lbnRSZWNlaXB0IiwiZW1haWxUZW1wbGF0ZXMiLCJkZXNjcmliZSIsIm9yaWdpbmFsRW52IiwicHJvY2VzcyIsImVudiIsImJlZm9yZUVhY2giLCJyZXNldE1vZHVsZXMiLCJhZnRlckFsbCIsInRlc3QiLCJFTUFJTF9IT1NUIiwiRU1BSUxfVVNFUiIsInJlc3VsdCIsIm9yZGVyTnVtYmVyIiwiY3VzdG9tZXJOYW1lIiwiaXRlbXMiLCJ0b3RhbCIsInNoaXBwaW5nQWRkcmVzcyIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwic3RyZWV0IiwiY2l0eSIsInN0YXRlIiwiemlwQ29kZSIsImNvdW50cnkiLCJleHBlY3QiLCJzdWNjZXNzIiwidG9CZSIsIm1lc3NhZ2UiLCJFTUFJTF9QQVNTIiwibW9ja1RyYW5zcG9ydGVyIiwic2VuZE1haWwiLCJmbiIsIm1vY2tSZWplY3RlZFZhbHVlIiwiRXJyb3IiLCJjcmVhdGVUcmFuc3BvcnQiLCJtb2NrUmV0dXJuVmFsdWUiLCJlbWFpbCIsImVycm9yIiwidG9CZURlZmluZWQiLCJvcmRlckRhdGEiLCJwcm9kdWN0TmFtZSIsInF1YW50aXR5IiwicHJpY2UiLCJ0ZW1wbGF0ZSIsIm9yZGVyQ29uZmlybWF0aW9uIiwic3ViamVjdCIsInRleHQiLCJ0b0NvbnRhaW4iLCJodG1sIiwicGF5bWVudERhdGEiLCJwYXltZW50TWV0aG9kIiwidHJhbnNhY3Rpb25JZCIsInBhaWRBdCIsIkRhdGUiLCJwYXltZW50UmVjZWlwdCIsInVzZXJEYXRhIiwid2VsY29tZUVtYWlsIiwic3RhdHVzRGF0YSIsInN0YXR1cyIsInRyYWNraW5nTnVtYmVyIiwib3JkZXJTdGF0dXNVcGRhdGUiLCJyZXNldERhdGEiLCJyZXNldFRva2VuIiwicmVzZXRVcmwiLCJwYXNzd29yZFJlc2V0Il0sInNvdXJjZXMiOlsiZW1haWxTZXJ2aWNlLnRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ2xlYXIgdGhlIGdsb2JhbCBtb2NrIGZvciBlbWFpbFNlcnZpY2UgdG8gdGVzdCB0aGUgYWN0dWFsIGltcGxlbWVudGF0aW9uXG5qZXN0LnVubW9jaygnLi4vLi4vdXRpbHMvZW1haWxTZXJ2aWNlJyk7XG5cbi8vIE1vY2sgbm9kZW1haWxlciBmb3IgdGhpcyB0ZXN0XG5qZXN0Lm1vY2soJ25vZGVtYWlsZXInKTtcbmNvbnN0IG5vZGVtYWlsZXIgPSByZXF1aXJlKCdub2RlbWFpbGVyJyk7XG5cbmNvbnN0IHtcbiAgc2VuZE9yZGVyQ29uZmlybWF0aW9uLFxuICBzZW5kV2VsY29tZUVtYWlsLFxuICBzZW5kUGF5bWVudFJlY2VpcHQsXG4gIGVtYWlsVGVtcGxhdGVzXG59ID0gcmVxdWlyZSgnLi4vLi4vdXRpbHMvZW1haWxTZXJ2aWNlJyk7XG5cbmRlc2NyaWJlKCdFbWFpbCBTZXJ2aWNlIFVuaXQgVGVzdHMnLCAoKSA9PiB7XG4gIC8vIE1vY2sgZW52aXJvbm1lbnQgdmFyaWFibGVzXG4gIGNvbnN0IG9yaWdpbmFsRW52ID0gcHJvY2Vzcy5lbnY7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5yZXNldE1vZHVsZXMoKTtcbiAgICBwcm9jZXNzLmVudiA9IHsgLi4ub3JpZ2luYWxFbnYgfTtcbiAgfSk7XG5cbiAgYWZ0ZXJBbGwoKCkgPT4ge1xuICAgIHByb2Nlc3MuZW52ID0gb3JpZ2luYWxFbnY7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFbWFpbCBTZXJ2aWNlIENvbmZpZ3VyYXRpb24nLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIHNraXAgZW1haWxzIHdoZW4gbm90IGNvbmZpZ3VyZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBSZW1vdmUgZW1haWwgY29uZmlndXJhdGlvblxuICAgICAgZGVsZXRlIHByb2Nlc3MuZW52LkVNQUlMX0hPU1Q7XG4gICAgICBkZWxldGUgcHJvY2Vzcy5lbnYuRU1BSUxfVVNFUjtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VuZE9yZGVyQ29uZmlybWF0aW9uKCd0ZXN0QGV4YW1wbGUuY29tJywge1xuICAgICAgICBvcmRlck51bWJlcjogJ1RFU1QtMTIzJyxcbiAgICAgICAgY3VzdG9tZXJOYW1lOiAnVGVzdCBVc2VyJyxcbiAgICAgICAgaXRlbXM6IFtdLFxuICAgICAgICB0b3RhbDogMTAwLFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBmaXJzdE5hbWU6ICdUZXN0JyxcbiAgICAgICAgICBsYXN0TmFtZTogJ1VzZXInLFxuICAgICAgICAgIHN0cmVldDogJzEyMyBUZXN0IFN0JyxcbiAgICAgICAgICBjaXR5OiAnVGVzdCBDaXR5JyxcbiAgICAgICAgICBzdGF0ZTogJ1RTJyxcbiAgICAgICAgICB6aXBDb2RlOiAnMTIzNDUnLFxuICAgICAgICAgIGNvdW50cnk6ICdVUydcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQubWVzc2FnZSkudG9CZSgnRW1haWwgc2tpcHBlZCAtIG5vdCBjb25maWd1cmVkJyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGVtYWlsIHNlbmRpbmcgZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBTZXQgdXAgZW1haWwgY29uZmlnXG4gICAgICBwcm9jZXNzLmVudi5FTUFJTF9IT1NUID0gJ3NtdHAudGVzdC5jb20nO1xuICAgICAgcHJvY2Vzcy5lbnYuRU1BSUxfVVNFUiA9ICd0ZXN0QHRlc3QuY29tJztcbiAgICAgIHByb2Nlc3MuZW52LkVNQUlMX1BBU1MgPSAndGVzdHBhc3MnO1xuXG4gICAgICAvLyBNb2NrIG5vZGVtYWlsZXIgdG8gc2ltdWxhdGUgU01UUCBmYWlsdXJlXG4gICAgICBjb25zdCBtb2NrVHJhbnNwb3J0ZXIgPSB7XG4gICAgICAgIHNlbmRNYWlsOiBqZXN0LmZuKCkubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdTTVRQIGNvbm5lY3Rpb24gZmFpbGVkJykpXG4gICAgICB9O1xuICAgICAgbm9kZW1haWxlci5jcmVhdGVUcmFuc3BvcnQgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKG1vY2tUcmFuc3BvcnRlcik7XG5cbiAgICAgIC8vIEVtYWlsIHdpbGwgZmFpbCBiZWNhdXNlIHRoZSBTTVRQIHNlcnZlciBkb2Vzbid0IGV4aXN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZW5kV2VsY29tZUVtYWlsKCd0ZXN0QGV4YW1wbGUuY29tJywge1xuICAgICAgICBmaXJzdE5hbWU6ICdUZXN0JyxcbiAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJ1xuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRW1haWwgVGVtcGxhdGVzJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBnZW5lcmF0ZSBvcmRlciBjb25maXJtYXRpb24gdGVtcGxhdGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBvcmRlckRhdGEgPSB7XG4gICAgICAgIG9yZGVyTnVtYmVyOiAnT1JELTEyMzQ1JyxcbiAgICAgICAgY3VzdG9tZXJOYW1lOiAnSm9obiBEb2UnLFxuICAgICAgICBpdGVtczogW1xuICAgICAgICAgIHsgcHJvZHVjdE5hbWU6ICdDcnlzdGFsJywgcXVhbnRpdHk6IDIsIHByaWNlOiAyOS45OSB9LFxuICAgICAgICAgIHsgcHJvZHVjdE5hbWU6ICdFc3NlbnRpYWwgT2lsJywgcXVhbnRpdHk6IDEsIHByaWNlOiAxOS45OSB9XG4gICAgICAgIF0sXG4gICAgICAgIHRvdGFsOiA3OS45NyxcbiAgICAgICAgc2hpcHBpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgICAgbGFzdE5hbWU6ICdEb2UnLFxuICAgICAgICAgIHN0cmVldDogJzEyMyBNYWluIFN0JyxcbiAgICAgICAgICBjaXR5OiAnUGFyaXMnLFxuICAgICAgICAgIHN0YXRlOiAnSURGJyxcbiAgICAgICAgICB6aXBDb2RlOiAnNzUwMDEnLFxuICAgICAgICAgIGNvdW50cnk6ICdGUidcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgY29uc3QgdGVtcGxhdGUgPSBlbWFpbFRlbXBsYXRlcy5vcmRlckNvbmZpcm1hdGlvbihvcmRlckRhdGEpO1xuICAgICAgXG4gICAgICBleHBlY3QodGVtcGxhdGUuc3ViamVjdCkudG9CZSgnT3JkZXIgQ29uZmlybWF0aW9uIC0gT1JELTEyMzQ1Jyk7XG4gICAgICBleHBlY3QodGVtcGxhdGUudGV4dCkudG9Db250YWluKCdKb2huIERvZScpO1xuICAgICAgZXhwZWN0KHRlbXBsYXRlLnRleHQpLnRvQ29udGFpbignQ3J5c3RhbCAoUXR5OiAyKSAtICQyOS45OScpO1xuICAgICAgZXhwZWN0KHRlbXBsYXRlLnRleHQpLnRvQ29udGFpbignRXNzZW50aWFsIE9pbCAoUXR5OiAxKSAtICQxOS45OScpO1xuICAgICAgZXhwZWN0KHRlbXBsYXRlLnRleHQpLnRvQ29udGFpbignJDc5Ljk3Jyk7XG4gICAgICBleHBlY3QodGVtcGxhdGUuaHRtbCkudG9Db250YWluKCc8aDInKTtcbiAgICAgIGV4cGVjdCh0ZW1wbGF0ZS5odG1sKS50b0NvbnRhaW4oJ09yZGVyIENvbmZpcm1hdGlvbicpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGdlbmVyYXRlIHBheW1lbnQgcmVjZWlwdCB0ZW1wbGF0ZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHBheW1lbnREYXRhID0ge1xuICAgICAgICBvcmRlck51bWJlcjogJ09SRC0xMjM0NScsXG4gICAgICAgIGN1c3RvbWVyTmFtZTogJ0phbmUgU21pdGgnLFxuICAgICAgICB0b3RhbDogOTkuOTksXG4gICAgICAgIHBheW1lbnRNZXRob2Q6ICdDcmVkaXQgQ2FyZCcsXG4gICAgICAgIHRyYW5zYWN0aW9uSWQ6ICdUWE4tOTg3NjUnLFxuICAgICAgICBwYWlkQXQ6IG5ldyBEYXRlKCcyMDI0LTAxLTE1JylcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHRlbXBsYXRlID0gZW1haWxUZW1wbGF0ZXMucGF5bWVudFJlY2VpcHQocGF5bWVudERhdGEpO1xuICAgICAgXG4gICAgICBleHBlY3QodGVtcGxhdGUuc3ViamVjdCkudG9CZSgnUGF5bWVudCBSZWNlaXB0IC0gT1JELTEyMzQ1Jyk7XG4gICAgICBleHBlY3QodGVtcGxhdGUudGV4dCkudG9Db250YWluKCdKYW5lIFNtaXRoJyk7XG4gICAgICBleHBlY3QodGVtcGxhdGUudGV4dCkudG9Db250YWluKCckOTkuOTknKTtcbiAgICAgIGV4cGVjdCh0ZW1wbGF0ZS50ZXh0KS50b0NvbnRhaW4oJ1RYTi05ODc2NScpO1xuICAgICAgZXhwZWN0KHRlbXBsYXRlLmh0bWwpLnRvQ29udGFpbignUGF5bWVudCBSZWNlaXB0Jyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgZ2VuZXJhdGUgd2VsY29tZSBlbWFpbCB0ZW1wbGF0ZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHVzZXJEYXRhID0ge1xuICAgICAgICBmaXJzdE5hbWU6ICdBbGljZScsXG4gICAgICAgIGVtYWlsOiAnYWxpY2VAZXhhbXBsZS5jb20nXG4gICAgICB9O1xuXG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9IGVtYWlsVGVtcGxhdGVzLndlbGNvbWVFbWFpbCh1c2VyRGF0YSk7XG4gICAgICBcbiAgICAgIGV4cGVjdCh0ZW1wbGF0ZS5zdWJqZWN0KS50b0JlKCdXZWxjb21lIHRvIE91ciBIb2xpc3RpYyBTdG9yZSEnKTtcbiAgICAgIGV4cGVjdCh0ZW1wbGF0ZS50ZXh0KS50b0NvbnRhaW4oJ0RlYXIgQWxpY2UnKTtcbiAgICAgIGV4cGVjdCh0ZW1wbGF0ZS50ZXh0KS50b0NvbnRhaW4oJ2hvbGlzdGljIHdlbGxuZXNzIGNvbW11bml0eScpO1xuICAgICAgZXhwZWN0KHRlbXBsYXRlLmh0bWwpLnRvQ29udGFpbignV2VsY29tZSB0byBPdXIgSG9saXN0aWMgU3RvcmUhJyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgZ2VuZXJhdGUgb3JkZXIgc3RhdHVzIHVwZGF0ZSB0ZW1wbGF0ZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXR1c0RhdGEgPSB7XG4gICAgICAgIG9yZGVyTnVtYmVyOiAnT1JELTEyMzQ1JyxcbiAgICAgICAgY3VzdG9tZXJOYW1lOiAnQm9iIEpvaG5zb24nLFxuICAgICAgICBzdGF0dXM6ICdzaGlwcGVkJyxcbiAgICAgICAgdHJhY2tpbmdOdW1iZXI6ICdUUkFDSy0xMjM0NTYnXG4gICAgICB9O1xuXG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9IGVtYWlsVGVtcGxhdGVzLm9yZGVyU3RhdHVzVXBkYXRlKHN0YXR1c0RhdGEpO1xuICAgICAgXG4gICAgICBleHBlY3QodGVtcGxhdGUuc3ViamVjdCkudG9CZSgnT3JkZXIgVXBkYXRlIC0gT1JELTEyMzQ1Jyk7XG4gICAgICBleHBlY3QodGVtcGxhdGUudGV4dCkudG9Db250YWluKCdCb2IgSm9obnNvbicpO1xuICAgICAgZXhwZWN0KHRlbXBsYXRlLnRleHQpLnRvQ29udGFpbignU3RhdHVzOiBTaGlwcGVkJyk7XG4gICAgICBleHBlY3QodGVtcGxhdGUudGV4dCkudG9Db250YWluKCdZb3VyIG9yZGVyIGhhcyBiZWVuIHNoaXBwZWQnKTtcbiAgICAgIGV4cGVjdCh0ZW1wbGF0ZS50ZXh0KS50b0NvbnRhaW4oJ1RSQUNLLTEyMzQ1NicpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGdlbmVyYXRlIHBhc3N3b3JkIHJlc2V0IHRlbXBsYXRlJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzZXREYXRhID0ge1xuICAgICAgICBmaXJzdE5hbWU6ICdDaGFybGllJyxcbiAgICAgICAgcmVzZXRUb2tlbjogJ3Jlc2V0LXRva2VuLTEyMycsXG4gICAgICAgIHJlc2V0VXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9yZXNldD90b2tlbj1yZXNldC10b2tlbi0xMjMnXG4gICAgICB9O1xuXG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9IGVtYWlsVGVtcGxhdGVzLnBhc3N3b3JkUmVzZXQocmVzZXREYXRhKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHRlbXBsYXRlLnN1YmplY3QpLnRvQmUoJ1Bhc3N3b3JkIFJlc2V0IFJlcXVlc3QnKTtcbiAgICAgIGV4cGVjdCh0ZW1wbGF0ZS50ZXh0KS50b0NvbnRhaW4oJ0RlYXIgQ2hhcmxpZScpO1xuICAgICAgZXhwZWN0KHRlbXBsYXRlLnRleHQpLnRvQ29udGFpbihyZXNldERhdGEucmVzZXRVcmwpO1xuICAgICAgZXhwZWN0KHRlbXBsYXRlLnRleHQpLnRvQ29udGFpbignZXhwaXJlIGluIDEgaG91cicpO1xuICAgICAgZXhwZWN0KHRlbXBsYXRlLmh0bWwpLnRvQ29udGFpbignUmVzZXQgUGFzc3dvcmQnKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUdBO0FBRkFBLFdBQUEsR0FBS0MsTUFBTSxDQUFDLDBCQUEwQixDQUFDO0FBR3ZDRCxXQUFBLEdBQUtFLElBQUksQ0FBQyxZQUFZLENBQUM7QUFBQyxTQUFBRixZQUFBO0VBQUE7SUFBQUc7RUFBQSxJQUFBQyxPQUFBO0VBQUFKLFdBQUEsR0FBQUEsQ0FBQSxLQUFBRyxJQUFBO0VBQUEsT0FBQUEsSUFBQTtBQUFBO0FBQ3hCLE1BQU1FLFVBQVUsR0FBR0QsT0FBTyxDQUFDLFlBQVksQ0FBQztBQUV4QyxNQUFNO0VBQ0pFLHFCQUFxQjtFQUNyQkMsZ0JBQWdCO0VBQ2hCQyxrQkFBa0I7RUFDbEJDO0FBQ0YsQ0FBQyxHQUFHTCxPQUFPLENBQUMsMEJBQTBCLENBQUM7QUFFdkNNLFFBQVEsQ0FBQywwQkFBMEIsRUFBRSxNQUFNO0VBQ3pDO0VBQ0EsTUFBTUMsV0FBVyxHQUFHQyxPQUFPLENBQUNDLEdBQUc7RUFFL0JDLFVBQVUsQ0FBQyxNQUFNO0lBQ2ZYLElBQUksQ0FBQ1ksWUFBWSxDQUFDLENBQUM7SUFDbkJILE9BQU8sQ0FBQ0MsR0FBRyxHQUFHO01BQUUsR0FBR0Y7SUFBWSxDQUFDO0VBQ2xDLENBQUMsQ0FBQztFQUVGSyxRQUFRLENBQUMsTUFBTTtJQUNiSixPQUFPLENBQUNDLEdBQUcsR0FBR0YsV0FBVztFQUMzQixDQUFDLENBQUM7RUFFRkQsUUFBUSxDQUFDLDZCQUE2QixFQUFFLE1BQU07SUFDNUNPLElBQUksQ0FBQyx3Q0FBd0MsRUFBRSxZQUFZO01BQ3pEO01BQ0EsT0FBT0wsT0FBTyxDQUFDQyxHQUFHLENBQUNLLFVBQVU7TUFDN0IsT0FBT04sT0FBTyxDQUFDQyxHQUFHLENBQUNNLFVBQVU7TUFFN0IsTUFBTUMsTUFBTSxHQUFHLE1BQU1kLHFCQUFxQixDQUFDLGtCQUFrQixFQUFFO1FBQzdEZSxXQUFXLEVBQUUsVUFBVTtRQUN2QkMsWUFBWSxFQUFFLFdBQVc7UUFDekJDLEtBQUssRUFBRSxFQUFFO1FBQ1RDLEtBQUssRUFBRSxHQUFHO1FBQ1ZDLGVBQWUsRUFBRTtVQUNmQyxTQUFTLEVBQUUsTUFBTTtVQUNqQkMsUUFBUSxFQUFFLE1BQU07VUFDaEJDLE1BQU0sRUFBRSxhQUFhO1VBQ3JCQyxJQUFJLEVBQUUsV0FBVztVQUNqQkMsS0FBSyxFQUFFLElBQUk7VUFDWEMsT0FBTyxFQUFFLE9BQU87VUFDaEJDLE9BQU8sRUFBRTtRQUNYO01BQ0YsQ0FBQyxDQUFDO01BRUZDLE1BQU0sQ0FBQ2IsTUFBTSxDQUFDYyxPQUFPLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLElBQUksQ0FBQztNQUNqQ0YsTUFBTSxDQUFDYixNQUFNLENBQUNnQixPQUFPLENBQUMsQ0FBQ0QsSUFBSSxDQUFDLGdDQUFnQyxDQUFDO0lBQy9ELENBQUMsQ0FBQztJQUVGbEIsSUFBSSxDQUFDLCtDQUErQyxFQUFFLFlBQVk7TUFDaEU7TUFDQUwsT0FBTyxDQUFDQyxHQUFHLENBQUNLLFVBQVUsR0FBRyxlQUFlO01BQ3hDTixPQUFPLENBQUNDLEdBQUcsQ0FBQ00sVUFBVSxHQUFHLGVBQWU7TUFDeENQLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDd0IsVUFBVSxHQUFHLFVBQVU7O01BRW5DO01BQ0EsTUFBTUMsZUFBZSxHQUFHO1FBQ3RCQyxRQUFRLEVBQUVwQyxJQUFJLENBQUNxQyxFQUFFLENBQUMsQ0FBQyxDQUFDQyxpQkFBaUIsQ0FBQyxJQUFJQyxLQUFLLENBQUMsd0JBQXdCLENBQUM7TUFDM0UsQ0FBQztNQUNEckMsVUFBVSxDQUFDc0MsZUFBZSxHQUFHeEMsSUFBSSxDQUFDcUMsRUFBRSxDQUFDLENBQUMsQ0FBQ0ksZUFBZSxDQUFDTixlQUFlLENBQUM7O01BRXZFO01BQ0EsTUFBTWxCLE1BQU0sR0FBRyxNQUFNYixnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRTtRQUN4RG1CLFNBQVMsRUFBRSxNQUFNO1FBQ2pCbUIsS0FBSyxFQUFFO01BQ1QsQ0FBQyxDQUFDO01BRUZaLE1BQU0sQ0FBQ2IsTUFBTSxDQUFDYyxPQUFPLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLEtBQUssQ0FBQztNQUNsQ0YsTUFBTSxDQUFDYixNQUFNLENBQUMwQixLQUFLLENBQUMsQ0FBQ0MsV0FBVyxDQUFDLENBQUM7SUFDcEMsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0VBRUZyQyxRQUFRLENBQUMsaUJBQWlCLEVBQUUsTUFBTTtJQUNoQ08sSUFBSSxDQUFDLDZDQUE2QyxFQUFFLE1BQU07TUFDeEQsTUFBTStCLFNBQVMsR0FBRztRQUNoQjNCLFdBQVcsRUFBRSxXQUFXO1FBQ3hCQyxZQUFZLEVBQUUsVUFBVTtRQUN4QkMsS0FBSyxFQUFFLENBQ0w7VUFBRTBCLFdBQVcsRUFBRSxTQUFTO1VBQUVDLFFBQVEsRUFBRSxDQUFDO1VBQUVDLEtBQUssRUFBRTtRQUFNLENBQUMsRUFDckQ7VUFBRUYsV0FBVyxFQUFFLGVBQWU7VUFBRUMsUUFBUSxFQUFFLENBQUM7VUFBRUMsS0FBSyxFQUFFO1FBQU0sQ0FBQyxDQUM1RDtRQUNEM0IsS0FBSyxFQUFFLEtBQUs7UUFDWkMsZUFBZSxFQUFFO1VBQ2ZDLFNBQVMsRUFBRSxNQUFNO1VBQ2pCQyxRQUFRLEVBQUUsS0FBSztVQUNmQyxNQUFNLEVBQUUsYUFBYTtVQUNyQkMsSUFBSSxFQUFFLE9BQU87VUFDYkMsS0FBSyxFQUFFLEtBQUs7VUFDWkMsT0FBTyxFQUFFLE9BQU87VUFDaEJDLE9BQU8sRUFBRTtRQUNYO01BQ0YsQ0FBQztNQUVELE1BQU1vQixRQUFRLEdBQUczQyxjQUFjLENBQUM0QyxpQkFBaUIsQ0FBQ0wsU0FBUyxDQUFDO01BRTVEZixNQUFNLENBQUNtQixRQUFRLENBQUNFLE9BQU8sQ0FBQyxDQUFDbkIsSUFBSSxDQUFDLGdDQUFnQyxDQUFDO01BQy9ERixNQUFNLENBQUNtQixRQUFRLENBQUNHLElBQUksQ0FBQyxDQUFDQyxTQUFTLENBQUMsVUFBVSxDQUFDO01BQzNDdkIsTUFBTSxDQUFDbUIsUUFBUSxDQUFDRyxJQUFJLENBQUMsQ0FBQ0MsU0FBUyxDQUFDLDJCQUEyQixDQUFDO01BQzVEdkIsTUFBTSxDQUFDbUIsUUFBUSxDQUFDRyxJQUFJLENBQUMsQ0FBQ0MsU0FBUyxDQUFDLGlDQUFpQyxDQUFDO01BQ2xFdkIsTUFBTSxDQUFDbUIsUUFBUSxDQUFDRyxJQUFJLENBQUMsQ0FBQ0MsU0FBUyxDQUFDLFFBQVEsQ0FBQztNQUN6Q3ZCLE1BQU0sQ0FBQ21CLFFBQVEsQ0FBQ0ssSUFBSSxDQUFDLENBQUNELFNBQVMsQ0FBQyxLQUFLLENBQUM7TUFDdEN2QixNQUFNLENBQUNtQixRQUFRLENBQUNLLElBQUksQ0FBQyxDQUFDRCxTQUFTLENBQUMsb0JBQW9CLENBQUM7SUFDdkQsQ0FBQyxDQUFDO0lBRUZ2QyxJQUFJLENBQUMsMENBQTBDLEVBQUUsTUFBTTtNQUNyRCxNQUFNeUMsV0FBVyxHQUFHO1FBQ2xCckMsV0FBVyxFQUFFLFdBQVc7UUFDeEJDLFlBQVksRUFBRSxZQUFZO1FBQzFCRSxLQUFLLEVBQUUsS0FBSztRQUNabUMsYUFBYSxFQUFFLGFBQWE7UUFDNUJDLGFBQWEsRUFBRSxXQUFXO1FBQzFCQyxNQUFNLEVBQUUsSUFBSUMsSUFBSSxDQUFDLFlBQVk7TUFDL0IsQ0FBQztNQUVELE1BQU1WLFFBQVEsR0FBRzNDLGNBQWMsQ0FBQ3NELGNBQWMsQ0FBQ0wsV0FBVyxDQUFDO01BRTNEekIsTUFBTSxDQUFDbUIsUUFBUSxDQUFDRSxPQUFPLENBQUMsQ0FBQ25CLElBQUksQ0FBQyw2QkFBNkIsQ0FBQztNQUM1REYsTUFBTSxDQUFDbUIsUUFBUSxDQUFDRyxJQUFJLENBQUMsQ0FBQ0MsU0FBUyxDQUFDLFlBQVksQ0FBQztNQUM3Q3ZCLE1BQU0sQ0FBQ21CLFFBQVEsQ0FBQ0csSUFBSSxDQUFDLENBQUNDLFNBQVMsQ0FBQyxRQUFRLENBQUM7TUFDekN2QixNQUFNLENBQUNtQixRQUFRLENBQUNHLElBQUksQ0FBQyxDQUFDQyxTQUFTLENBQUMsV0FBVyxDQUFDO01BQzVDdkIsTUFBTSxDQUFDbUIsUUFBUSxDQUFDSyxJQUFJLENBQUMsQ0FBQ0QsU0FBUyxDQUFDLGlCQUFpQixDQUFDO0lBQ3BELENBQUMsQ0FBQztJQUVGdkMsSUFBSSxDQUFDLHdDQUF3QyxFQUFFLE1BQU07TUFDbkQsTUFBTStDLFFBQVEsR0FBRztRQUNmdEMsU0FBUyxFQUFFLE9BQU87UUFDbEJtQixLQUFLLEVBQUU7TUFDVCxDQUFDO01BRUQsTUFBTU8sUUFBUSxHQUFHM0MsY0FBYyxDQUFDd0QsWUFBWSxDQUFDRCxRQUFRLENBQUM7TUFFdEQvQixNQUFNLENBQUNtQixRQUFRLENBQUNFLE9BQU8sQ0FBQyxDQUFDbkIsSUFBSSxDQUFDLGdDQUFnQyxDQUFDO01BQy9ERixNQUFNLENBQUNtQixRQUFRLENBQUNHLElBQUksQ0FBQyxDQUFDQyxTQUFTLENBQUMsWUFBWSxDQUFDO01BQzdDdkIsTUFBTSxDQUFDbUIsUUFBUSxDQUFDRyxJQUFJLENBQUMsQ0FBQ0MsU0FBUyxDQUFDLDZCQUE2QixDQUFDO01BQzlEdkIsTUFBTSxDQUFDbUIsUUFBUSxDQUFDSyxJQUFJLENBQUMsQ0FBQ0QsU0FBUyxDQUFDLGdDQUFnQyxDQUFDO0lBQ25FLENBQUMsQ0FBQztJQUVGdkMsSUFBSSxDQUFDLDhDQUE4QyxFQUFFLE1BQU07TUFDekQsTUFBTWlELFVBQVUsR0FBRztRQUNqQjdDLFdBQVcsRUFBRSxXQUFXO1FBQ3hCQyxZQUFZLEVBQUUsYUFBYTtRQUMzQjZDLE1BQU0sRUFBRSxTQUFTO1FBQ2pCQyxjQUFjLEVBQUU7TUFDbEIsQ0FBQztNQUVELE1BQU1oQixRQUFRLEdBQUczQyxjQUFjLENBQUM0RCxpQkFBaUIsQ0FBQ0gsVUFBVSxDQUFDO01BRTdEakMsTUFBTSxDQUFDbUIsUUFBUSxDQUFDRSxPQUFPLENBQUMsQ0FBQ25CLElBQUksQ0FBQywwQkFBMEIsQ0FBQztNQUN6REYsTUFBTSxDQUFDbUIsUUFBUSxDQUFDRyxJQUFJLENBQUMsQ0FBQ0MsU0FBUyxDQUFDLGFBQWEsQ0FBQztNQUM5Q3ZCLE1BQU0sQ0FBQ21CLFFBQVEsQ0FBQ0csSUFBSSxDQUFDLENBQUNDLFNBQVMsQ0FBQyxpQkFBaUIsQ0FBQztNQUNsRHZCLE1BQU0sQ0FBQ21CLFFBQVEsQ0FBQ0csSUFBSSxDQUFDLENBQUNDLFNBQVMsQ0FBQyw2QkFBNkIsQ0FBQztNQUM5RHZCLE1BQU0sQ0FBQ21CLFFBQVEsQ0FBQ0csSUFBSSxDQUFDLENBQUNDLFNBQVMsQ0FBQyxjQUFjLENBQUM7SUFDakQsQ0FBQyxDQUFDO0lBRUZ2QyxJQUFJLENBQUMseUNBQXlDLEVBQUUsTUFBTTtNQUNwRCxNQUFNcUQsU0FBUyxHQUFHO1FBQ2hCNUMsU0FBUyxFQUFFLFNBQVM7UUFDcEI2QyxVQUFVLEVBQUUsaUJBQWlCO1FBQzdCQyxRQUFRLEVBQUU7TUFDWixDQUFDO01BRUQsTUFBTXBCLFFBQVEsR0FBRzNDLGNBQWMsQ0FBQ2dFLGFBQWEsQ0FBQ0gsU0FBUyxDQUFDO01BRXhEckMsTUFBTSxDQUFDbUIsUUFBUSxDQUFDRSxPQUFPLENBQUMsQ0FBQ25CLElBQUksQ0FBQyx3QkFBd0IsQ0FBQztNQUN2REYsTUFBTSxDQUFDbUIsUUFBUSxDQUFDRyxJQUFJLENBQUMsQ0FBQ0MsU0FBUyxDQUFDLGNBQWMsQ0FBQztNQUMvQ3ZCLE1BQU0sQ0FBQ21CLFFBQVEsQ0FBQ0csSUFBSSxDQUFDLENBQUNDLFNBQVMsQ0FBQ2MsU0FBUyxDQUFDRSxRQUFRLENBQUM7TUFDbkR2QyxNQUFNLENBQUNtQixRQUFRLENBQUNHLElBQUksQ0FBQyxDQUFDQyxTQUFTLENBQUMsa0JBQWtCLENBQUM7TUFDbkR2QixNQUFNLENBQUNtQixRQUFRLENBQUNLLElBQUksQ0FBQyxDQUFDRCxTQUFTLENBQUMsZ0JBQWdCLENBQUM7SUFDbkQsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119