25e80112952c84006f8bac9c138e7b6b
const express = require('express');
const router = express.Router();
const {
  body,
  param,
  query
} = require('express-validator');
const Product = require('../models/Product');
const Order = require('../models/Order');
const {
  apiKeyAuth,
  handleValidationErrors,
  rateLimits
} = require('../middleware/security');

// Apply integration-specific rate limiting
router.use(rateLimits.integration);

// Get product by reference key for cross-site linking
router.get('/products/link/:referenceKey', [param('referenceKey').isLength({
  min: 1,
  max: 100
}).matches(/^[a-zA-Z0-9-_]+$/).withMessage('Invalid reference key format'), query('source').optional().isLength({
  max: 100
}).withMessage('Source parameter too long'), handleValidationErrors], async (req, res) => {
  try {
    const {
      referenceKey
    } = req.params;
    const {
      source
    } = req.query; // Track referral source

    const product = await Product.findOne({
      $or: [{
        'crossSiteIntegration.referenceKey': referenceKey
      }, {
        slug: referenceKey
      }],
      isActive: true,
      'crossSiteIntegration.enabled': true
    });
    if (!product) {
      return res.status(404).json({
        success: false,
        error: {
          code: 'PRODUCT_NOT_FOUND',
          message: 'Product not found or not available for cross-site integration'
        }
      });
    }

    // Track referral if source is provided
    if (source) {
      // Log referral for analytics (you might want to store this in a separate collection)
      console.log(`Cross-site referral: ${source} -> ${product.slug}`);
    }

    // Return cross-site optimized product data
    const crossSiteData = product.getCrossSiteData();
    res.json({
      success: true,
      product: crossSiteData,
      meta: {
        referralSource: source,
        crossSiteEnabled: true,
        directUrl: `/products/${product.slug}`,
        embedUrl: `/api/integration/products/embed/${product.slug}`
      }
    });
  } catch (error) {
    console.error('Cross-site product link error:', error);
    res.status(500).json({
      success: false,
      error: {
        code: 'INTEGRATION_ERROR',
        message: 'Failed to fetch product for cross-site integration'
      }
    });
  }
});

// Get product by slug for cross-site integration
router.get('/products/:slug', [param('slug').isLength({
  min: 1,
  max: 100
}).matches(/^[a-zA-Z0-9-_]+$/).withMessage('Invalid slug format'), query('source').optional().isLength({
  max: 100
}).withMessage('Source parameter too long'), handleValidationErrors], async (req, res) => {
  try {
    const {
      slug
    } = req.params;
    const {
      source
    } = req.query;
    const product = await Product.findOne({
      slug: slug,
      isActive: true
    });
    if (!product) {
      return res.status(404).json({
        success: false,
        error: {
          code: 'PRODUCT_NOT_FOUND',
          message: 'Product not found'
        }
      });
    }

    // Track referral if source is provided
    if (source) {
      console.log(`Cross-site referral: ${source} -> ${product.slug}`);
    }
    res.json({
      success: true,
      data: {
        product: {
          _id: product._id,
          name: product.name,
          slug: product.slug,
          description: product.description,
          shortDescription: product.shortDescription,
          price: product.price,
          compareAtPrice: product.compareAtPrice,
          images: product.images,
          category: product.category,
          properties: product.properties,
          tags: product.tags
        }
      }
    });
  } catch (error) {
    console.error('Error fetching integration product:', error);
    res.status(500).json({
      success: false,
      error: {
        code: 'INTEGRATION_ERROR',
        message: 'Failed to fetch product'
      }
    });
  }
});

// Get embeddable product widget data
router.get('/products/embed/:slug', [param('slug').isLength({
  min: 1,
  max: 100
}).matches(/^[a-zA-Z0-9-_]+$/).withMessage('Invalid slug format'), query('format').optional().isIn(['json', 'html']).withMessage('Format must be json or html'), query('theme').optional().isIn(['light', 'dark']).withMessage('Theme must be light or dark'), handleValidationErrors], async (req, res) => {
  try {
    const {
      slug
    } = req.params;
    const {
      format = 'json',
      theme = 'light'
    } = req.query;
    const product = await Product.findOne({
      slug,
      isActive: true,
      'crossSiteIntegration.enabled': true
    });
    if (!product) {
      return res.status(404).json({
        success: false,
        error: {
          code: 'PRODUCT_NOT_FOUND',
          message: 'Product not found or not available for embedding'
        }
      });
    }
    const embedData = {
      id: product._id,
      name: product.name,
      slug: product.slug,
      shortDescription: product.shortDescription,
      price: product.price,
      compareAtPrice: product.compareAtPrice,
      primaryImage: product.images.find(img => img.isPrimary) || product.images[0],
      category: product.category,
      properties: {
        chakra: product.properties.chakra,
        element: product.properties.element,
        healing: product.properties.healing
      },
      seo: product.seo,
      urls: {
        product: `/products/${product.slug}`,
        addToCart: '/api/cart/add',
        buyNow: `/checkout?product=${product._id}`
      }
    };
    if (format === 'html') {
      // Return HTML widget
      const htmlWidget = generateProductWidget(embedData, theme);
      res.setHeader('Content-Type', 'text/html');
      res.send(htmlWidget);
    } else {
      // Return JSON data
      res.json({
        success: true,
        embed: embedData,
        meta: {
          format,
          theme,
          embedCode: `<iframe src="${req.protocol}://${req.get('host')}/api/integration/products/embed/${slug}?format=html&theme=${theme}" width="300" height="400" frameborder="0"></iframe>`
        }
      });
    }
  } catch (error) {
    console.error('Product embed error:', error);
    res.status(500).json({
      success: false,
      error: {
        code: 'EMBED_ERROR',
        message: 'Failed to generate product embed'
      }
    });
  }
});

// Get products related to content ID (for content-based recommendations)
router.get('/products/related/:contentId', [param('contentId').isLength({
  min: 1,
  max: 100
}).matches(/^[a-zA-Z0-9-_]+$/).withMessage('Invalid content ID format'), query('limit').optional().isInt({
  min: 1,
  max: 50
}).withMessage('Limit must be between 1 and 50'), query('category').optional().isLength({
  max: 50
}).withMessage('Category parameter too long'), handleValidationErrors], async (req, res) => {
  try {
    const {
      contentId
    } = req.params;
    const {
      limit = 6,
      category,
      properties
    } = req.query;

    // Build query based on content relationship
    const query = {
      isActive: true,
      'crossSiteIntegration.enabled': true
    };

    // Add content-specific filters
    if (contentId.includes('chakra')) {
      const chakraName = contentId.replace('chakra-', '');
      query['properties.chakra'] = {
        $in: [chakraName]
      };
    } else if (contentId.includes('element')) {
      const elementName = contentId.replace('element-', '');
      query['properties.element'] = {
        $in: [elementName]
      };
    } else if (contentId.includes('healing')) {
      const healingProperty = contentId.replace('healing-', '');
      query['properties.healing'] = {
        $in: [healingProperty]
      };
    }

    // Add additional filters
    if (category) {
      query.category = category;
    }
    if (properties) {
      try {
        const propertyFilters = JSON.parse(properties);
        Object.keys(propertyFilters).forEach(key => {
          if (propertyFilters[key]) {
            query[`properties.${key}`] = {
              $in: Array.isArray(propertyFilters[key]) ? propertyFilters[key] : [propertyFilters[key]]
            };
          }
        });
      } catch (e) {
        // Ignore invalid JSON in properties filter
      }
    }
    const products = await Product.find(query).limit(parseInt(limit)).sort({
      isFeatured: -1,
      createdAt: -1
    });
    const relatedProducts = products.map(product => product.getCrossSiteData());
    res.json({
      success: true,
      products: relatedProducts,
      meta: {
        contentId,
        count: relatedProducts.length,
        filters: {
          category,
          properties
        },
        totalAvailable: await Product.countDocuments(query)
      }
    });
  } catch (error) {
    console.error('Related products error:', error);
    res.status(500).json({
      success: false,
      error: {
        code: 'RELATED_PRODUCTS_ERROR',
        message: 'Failed to fetch related products'
      }
    });
  }
});

// Track referral analytics (requires API key)
router.post('/analytics/referral', [apiKeyAuth, body('source').isLength({
  min: 1,
  max: 100
}).withMessage('Source is required and must be less than 100 characters'), body('action').isIn(['view', 'click', 'add_to_cart', 'purchase']).withMessage('Action must be one of: view, click, add_to_cart, purchase'), body('productId').optional().isMongoId().withMessage('Invalid product ID format'), body('metadata').optional().isObject().withMessage('Metadata must be an object'), handleValidationErrors], async (req, res) => {
  try {
    const {
      source,
      productId,
      action,
      metadata
    } = req.body;
    if (!source || !action) {
      return res.status(400).json({
        success: false,
        error: {
          code: 'MISSING_REQUIRED_FIELDS',
          message: 'Source and action are required'
        }
      });
    }

    // Log referral analytics (in a real app, you'd store this in a dedicated analytics collection)
    const analyticsData = {
      timestamp: new Date(),
      source,
      productId,
      action,
      // 'view', 'click', 'add_to_cart', 'purchase'
      metadata,
      ip: req.ip,
      userAgent: req.get('User-Agent')
    };
    console.log('Cross-site analytics:', analyticsData);

    // TODO: Store in analytics collection
    // await Analytics.create(analyticsData);

    res.json({
      success: true,
      message: 'Referral tracked successfully'
    });
  } catch (error) {
    console.error('Analytics tracking error:', error);
    res.status(500).json({
      success: false,
      error: {
        code: 'ANALYTICS_ERROR',
        message: 'Failed to track referral'
      }
    });
  }
});

// Get referral analytics summary (requires API key)
router.get('/analytics/summary', [apiKeyAuth, query('startDate').optional().isISO8601().withMessage('Start date must be in ISO8601 format'), query('endDate').optional().isISO8601().withMessage('End date must be in ISO8601 format'), query('source').optional().isLength({
  max: 100
}).withMessage('Source parameter too long'), handleValidationErrors], async (req, res) => {
  try {
    const {
      startDate,
      endDate,
      source
    } = req.query;

    // Build date filter
    const dateFilter = {};
    if (startDate || endDate) {
      dateFilter.createdAt = {};
      if (startDate) {
        dateFilter.createdAt.$gte = new Date(startDate);
      }
      if (endDate) {
        dateFilter.createdAt.$lte = new Date(endDate);
      }
    }

    // Build source filter
    const sourceFilter = {};
    if (source) {
      sourceFilter.referralSource = source;
    }

    // Get order analytics with referral sources
    const orderAnalytics = await Order.aggregate([{
      $match: {
        ...dateFilter,
        ...sourceFilter,
        referralSource: {
          $exists: true,
          $ne: null
        }
      }
    }, {
      $group: {
        _id: '$referralSource',
        orderCount: {
          $sum: 1
        },
        totalRevenue: {
          $sum: '$total'
        },
        averageOrderValue: {
          $avg: '$total'
        }
      }
    }, {
      $sort: {
        orderCount: -1
      }
    }]);

    // Get top referred products
    const topProducts = await Order.aggregate([{
      $match: {
        ...dateFilter,
        referralSource: {
          $exists: true,
          $ne: null
        }
      }
    }, {
      $unwind: '$items'
    }, {
      $group: {
        _id: '$items.product',
        referralCount: {
          $sum: '$items.quantity'
        },
        revenue: {
          $sum: {
            $multiply: ['$items.price', '$items.quantity']
          }
        }
      }
    }, {
      $lookup: {
        from: 'products',
        localField: '_id',
        foreignField: '_id',
        as: 'product'
      }
    }, {
      $unwind: '$product'
    }, {
      $project: {
        productName: '$product.name',
        productSlug: '$product.slug',
        referralCount: 1,
        revenue: 1
      }
    }, {
      $sort: {
        referralCount: -1
      }
    }, {
      $limit: 10
    }]);
    res.json({
      success: true,
      analytics: {
        summary: {
          totalReferralOrders: orderAnalytics.reduce((sum, item) => sum + item.orderCount, 0),
          totalReferralRevenue: orderAnalytics.reduce((sum, item) => sum + item.totalRevenue, 0),
          averageReferralOrderValue: orderAnalytics.length > 0 ? orderAnalytics.reduce((sum, item) => sum + item.averageOrderValue, 0) / orderAnalytics.length : 0
        },
        bySource: orderAnalytics,
        topProducts
      },
      meta: {
        dateRange: {
          startDate,
          endDate
        },
        sourceFilter: source,
        generatedAt: new Date()
      }
    });
  } catch (error) {
    console.error('Analytics summary error:', error);
    res.status(500).json({
      success: false,
      error: {
        code: 'ANALYTICS_SUMMARY_ERROR',
        message: 'Failed to generate analytics summary'
      }
    });
  }
});

// HTML escape function to prevent XSS
function escapeHtml(text) {
  if (!text) {
    return '';
  }
  return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;').replace(/'/g, '&#39;');
}

// Generate HTML widget for product embedding
function generateProductWidget(product, theme = 'light') {
  const themeStyles = theme === 'dark' ? 'background: #2d3748; color: #e2e8f0; border: 1px solid #4a5568;' : 'background: #ffffff; color: #2d3748; border: 1px solid #e2e8f0;';
  return `
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>${escapeHtml(product.name)} - Holistic Store</title>
      <style>
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        .product-widget {
          ${themeStyles}
          border-radius: 8px;
          padding: 16px;
          max-width: 300px;
          box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .product-image {
          width: 100%;
          height: 200px;
          object-fit: cover;
          border-radius: 4px;
          margin-bottom: 12px;
        }
        .product-name {
          font-size: 18px;
          font-weight: 600;
          margin-bottom: 8px;
          line-height: 1.3;
        }
        .product-description {
          font-size: 14px;
          margin-bottom: 12px;
          opacity: 0.8;
          line-height: 1.4;
        }
        .product-price {
          font-size: 20px;
          font-weight: 700;
          margin-bottom: 16px;
        }
        .product-properties {
          font-size: 12px;
          margin-bottom: 16px;
          opacity: 0.7;
        }
        .product-button {
          background: #4299e1;
          color: white;
          border: none;
          padding: 12px 24px;
          border-radius: 4px;
          font-size: 14px;
          font-weight: 600;
          cursor: pointer;
          width: 100%;
          text-decoration: none;
          display: inline-block;
          text-align: center;
          transition: background 0.2s;
        }
        .product-button:hover {
          background: #3182ce;
        }
      </style>
    </head>
    <body>
      <div class="product-widget">
        ${product.primaryImage ? `<img src="${escapeHtml(product.primaryImage.url)}" alt="${escapeHtml(product.primaryImage.alt || product.name)}" class="product-image">` : ''}
        <div class="product-name">${escapeHtml(product.name)}</div>
        <div class="product-description">${escapeHtml(product.shortDescription || '')}</div>
        <div class="product-price">
          $${product.price.toFixed(2)}
          ${product.compareAtPrice ? `<span style="text-decoration: line-through; opacity: 0.6; font-size: 16px; margin-left: 8px;">$${product.compareAtPrice.toFixed(2)}</span>` : ''}
        </div>
        ${product.properties.chakra || product.properties.element ? `
          <div class="product-properties">
            ${product.properties.chakra ? `Chakra: ${escapeHtml(product.properties.chakra.join(', '))} ` : ''}
            ${product.properties.element ? `Element: ${escapeHtml(product.properties.element.join(', '))}` : ''}
          </div>
        ` : ''}
        <a href="${escapeHtml(product.urls.product)}" target="_parent" class="product-button">
          View Product
        </a>
      </div>
    </body>
    </html>
  `;
}
module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsImJvZHkiLCJwYXJhbSIsInF1ZXJ5IiwiUHJvZHVjdCIsIk9yZGVyIiwiYXBpS2V5QXV0aCIsImhhbmRsZVZhbGlkYXRpb25FcnJvcnMiLCJyYXRlTGltaXRzIiwidXNlIiwiaW50ZWdyYXRpb24iLCJnZXQiLCJpc0xlbmd0aCIsIm1pbiIsIm1heCIsIm1hdGNoZXMiLCJ3aXRoTWVzc2FnZSIsIm9wdGlvbmFsIiwicmVxIiwicmVzIiwicmVmZXJlbmNlS2V5IiwicGFyYW1zIiwic291cmNlIiwicHJvZHVjdCIsImZpbmRPbmUiLCIkb3IiLCJzbHVnIiwiaXNBY3RpdmUiLCJzdGF0dXMiLCJqc29uIiwic3VjY2VzcyIsImVycm9yIiwiY29kZSIsIm1lc3NhZ2UiLCJjb25zb2xlIiwibG9nIiwiY3Jvc3NTaXRlRGF0YSIsImdldENyb3NzU2l0ZURhdGEiLCJtZXRhIiwicmVmZXJyYWxTb3VyY2UiLCJjcm9zc1NpdGVFbmFibGVkIiwiZGlyZWN0VXJsIiwiZW1iZWRVcmwiLCJkYXRhIiwiX2lkIiwibmFtZSIsImRlc2NyaXB0aW9uIiwic2hvcnREZXNjcmlwdGlvbiIsInByaWNlIiwiY29tcGFyZUF0UHJpY2UiLCJpbWFnZXMiLCJjYXRlZ29yeSIsInByb3BlcnRpZXMiLCJ0YWdzIiwiaXNJbiIsImZvcm1hdCIsInRoZW1lIiwiZW1iZWREYXRhIiwiaWQiLCJwcmltYXJ5SW1hZ2UiLCJmaW5kIiwiaW1nIiwiaXNQcmltYXJ5IiwiY2hha3JhIiwiZWxlbWVudCIsImhlYWxpbmciLCJzZW8iLCJ1cmxzIiwiYWRkVG9DYXJ0IiwiYnV5Tm93IiwiaHRtbFdpZGdldCIsImdlbmVyYXRlUHJvZHVjdFdpZGdldCIsInNldEhlYWRlciIsInNlbmQiLCJlbWJlZCIsImVtYmVkQ29kZSIsInByb3RvY29sIiwiaXNJbnQiLCJjb250ZW50SWQiLCJsaW1pdCIsImluY2x1ZGVzIiwiY2hha3JhTmFtZSIsInJlcGxhY2UiLCIkaW4iLCJlbGVtZW50TmFtZSIsImhlYWxpbmdQcm9wZXJ0eSIsInByb3BlcnR5RmlsdGVycyIsIkpTT04iLCJwYXJzZSIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwia2V5IiwiQXJyYXkiLCJpc0FycmF5IiwiZSIsInByb2R1Y3RzIiwicGFyc2VJbnQiLCJzb3J0IiwiaXNGZWF0dXJlZCIsImNyZWF0ZWRBdCIsInJlbGF0ZWRQcm9kdWN0cyIsIm1hcCIsImNvdW50IiwibGVuZ3RoIiwiZmlsdGVycyIsInRvdGFsQXZhaWxhYmxlIiwiY291bnREb2N1bWVudHMiLCJwb3N0IiwiaXNNb25nb0lkIiwiaXNPYmplY3QiLCJwcm9kdWN0SWQiLCJhY3Rpb24iLCJtZXRhZGF0YSIsImFuYWx5dGljc0RhdGEiLCJ0aW1lc3RhbXAiLCJEYXRlIiwiaXAiLCJ1c2VyQWdlbnQiLCJpc0lTTzg2MDEiLCJzdGFydERhdGUiLCJlbmREYXRlIiwiZGF0ZUZpbHRlciIsIiRndGUiLCIkbHRlIiwic291cmNlRmlsdGVyIiwib3JkZXJBbmFseXRpY3MiLCJhZ2dyZWdhdGUiLCIkbWF0Y2giLCIkZXhpc3RzIiwiJG5lIiwiJGdyb3VwIiwib3JkZXJDb3VudCIsIiRzdW0iLCJ0b3RhbFJldmVudWUiLCJhdmVyYWdlT3JkZXJWYWx1ZSIsIiRhdmciLCIkc29ydCIsInRvcFByb2R1Y3RzIiwiJHVud2luZCIsInJlZmVycmFsQ291bnQiLCJyZXZlbnVlIiwiJG11bHRpcGx5IiwiJGxvb2t1cCIsImZyb20iLCJsb2NhbEZpZWxkIiwiZm9yZWlnbkZpZWxkIiwiYXMiLCIkcHJvamVjdCIsInByb2R1Y3ROYW1lIiwicHJvZHVjdFNsdWciLCIkbGltaXQiLCJhbmFseXRpY3MiLCJzdW1tYXJ5IiwidG90YWxSZWZlcnJhbE9yZGVycyIsInJlZHVjZSIsInN1bSIsIml0ZW0iLCJ0b3RhbFJlZmVycmFsUmV2ZW51ZSIsImF2ZXJhZ2VSZWZlcnJhbE9yZGVyVmFsdWUiLCJieVNvdXJjZSIsImRhdGVSYW5nZSIsImdlbmVyYXRlZEF0IiwiZXNjYXBlSHRtbCIsInRleHQiLCJ0aGVtZVN0eWxlcyIsInVybCIsImFsdCIsInRvRml4ZWQiLCJqb2luIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImludGVncmF0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuY29uc3QgeyBib2R5LCBwYXJhbSwgcXVlcnkgfSA9IHJlcXVpcmUoJ2V4cHJlc3MtdmFsaWRhdG9yJyk7XG5jb25zdCBQcm9kdWN0ID0gcmVxdWlyZSgnLi4vbW9kZWxzL1Byb2R1Y3QnKTtcbmNvbnN0IE9yZGVyID0gcmVxdWlyZSgnLi4vbW9kZWxzL09yZGVyJyk7XG5jb25zdCB7IGFwaUtleUF1dGgsIGhhbmRsZVZhbGlkYXRpb25FcnJvcnMsIHJhdGVMaW1pdHMgfSA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmUvc2VjdXJpdHknKTtcblxuLy8gQXBwbHkgaW50ZWdyYXRpb24tc3BlY2lmaWMgcmF0ZSBsaW1pdGluZ1xucm91dGVyLnVzZShyYXRlTGltaXRzLmludGVncmF0aW9uKTtcblxuLy8gR2V0IHByb2R1Y3QgYnkgcmVmZXJlbmNlIGtleSBmb3IgY3Jvc3Mtc2l0ZSBsaW5raW5nXG5yb3V0ZXIuZ2V0KCcvcHJvZHVjdHMvbGluay86cmVmZXJlbmNlS2V5JywgW1xuICBwYXJhbSgncmVmZXJlbmNlS2V5JykuaXNMZW5ndGgoeyBtaW46IDEsIG1heDogMTAwIH0pLm1hdGNoZXMoL15bYS16QS1aMC05LV9dKyQvKS53aXRoTWVzc2FnZSgnSW52YWxpZCByZWZlcmVuY2Uga2V5IGZvcm1hdCcpLFxuICBxdWVyeSgnc291cmNlJykub3B0aW9uYWwoKS5pc0xlbmd0aCh7IG1heDogMTAwIH0pLndpdGhNZXNzYWdlKCdTb3VyY2UgcGFyYW1ldGVyIHRvbyBsb25nJyksXG4gIGhhbmRsZVZhbGlkYXRpb25FcnJvcnNcbl0sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcmVmZXJlbmNlS2V5IH0gPSByZXEucGFyYW1zO1xuICAgIGNvbnN0IHsgc291cmNlIH0gPSByZXEucXVlcnk7IC8vIFRyYWNrIHJlZmVycmFsIHNvdXJjZVxuICAgIFxuICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0LmZpbmRPbmUoe1xuICAgICAgJG9yOiBbXG4gICAgICAgIHsgJ2Nyb3NzU2l0ZUludGVncmF0aW9uLnJlZmVyZW5jZUtleSc6IHJlZmVyZW5jZUtleSB9LFxuICAgICAgICB7IHNsdWc6IHJlZmVyZW5jZUtleSB9XG4gICAgICBdLFxuICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICAnY3Jvc3NTaXRlSW50ZWdyYXRpb24uZW5hYmxlZCc6IHRydWVcbiAgICB9KTtcbiAgICBcbiAgICBpZiAoIXByb2R1Y3QpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdQUk9EVUNUX05PVF9GT1VORCcsXG4gICAgICAgICAgbWVzc2FnZTogJ1Byb2R1Y3Qgbm90IGZvdW5kIG9yIG5vdCBhdmFpbGFibGUgZm9yIGNyb3NzLXNpdGUgaW50ZWdyYXRpb24nXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBUcmFjayByZWZlcnJhbCBpZiBzb3VyY2UgaXMgcHJvdmlkZWRcbiAgICBpZiAoc291cmNlKSB7XG4gICAgICAvLyBMb2cgcmVmZXJyYWwgZm9yIGFuYWx5dGljcyAoeW91IG1pZ2h0IHdhbnQgdG8gc3RvcmUgdGhpcyBpbiBhIHNlcGFyYXRlIGNvbGxlY3Rpb24pXG4gICAgICBjb25zb2xlLmxvZyhgQ3Jvc3Mtc2l0ZSByZWZlcnJhbDogJHtzb3VyY2V9IC0+ICR7cHJvZHVjdC5zbHVnfWApO1xuICAgIH1cbiAgICBcbiAgICAvLyBSZXR1cm4gY3Jvc3Mtc2l0ZSBvcHRpbWl6ZWQgcHJvZHVjdCBkYXRhXG4gICAgY29uc3QgY3Jvc3NTaXRlRGF0YSA9IHByb2R1Y3QuZ2V0Q3Jvc3NTaXRlRGF0YSgpO1xuICAgIFxuICAgIHJlcy5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBwcm9kdWN0OiBjcm9zc1NpdGVEYXRhLFxuICAgICAgbWV0YToge1xuICAgICAgICByZWZlcnJhbFNvdXJjZTogc291cmNlLFxuICAgICAgICBjcm9zc1NpdGVFbmFibGVkOiB0cnVlLFxuICAgICAgICBkaXJlY3RVcmw6IGAvcHJvZHVjdHMvJHtwcm9kdWN0LnNsdWd9YCxcbiAgICAgICAgZW1iZWRVcmw6IGAvYXBpL2ludGVncmF0aW9uL3Byb2R1Y3RzL2VtYmVkLyR7cHJvZHVjdC5zbHVnfWBcbiAgICAgIH1cbiAgICB9KTtcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdDcm9zcy1zaXRlIHByb2R1Y3QgbGluayBlcnJvcjonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnSU5URUdSQVRJT05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIGZldGNoIHByb2R1Y3QgZm9yIGNyb3NzLXNpdGUgaW50ZWdyYXRpb24nXG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vLyBHZXQgcHJvZHVjdCBieSBzbHVnIGZvciBjcm9zcy1zaXRlIGludGVncmF0aW9uXG5yb3V0ZXIuZ2V0KCcvcHJvZHVjdHMvOnNsdWcnLCBbXG4gIHBhcmFtKCdzbHVnJykuaXNMZW5ndGgoeyBtaW46IDEsIG1heDogMTAwIH0pLm1hdGNoZXMoL15bYS16QS1aMC05LV9dKyQvKS53aXRoTWVzc2FnZSgnSW52YWxpZCBzbHVnIGZvcm1hdCcpLFxuICBxdWVyeSgnc291cmNlJykub3B0aW9uYWwoKS5pc0xlbmd0aCh7IG1heDogMTAwIH0pLndpdGhNZXNzYWdlKCdTb3VyY2UgcGFyYW1ldGVyIHRvbyBsb25nJyksXG4gIGhhbmRsZVZhbGlkYXRpb25FcnJvcnNcbl0sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgc2x1ZyB9ID0gcmVxLnBhcmFtcztcbiAgICBjb25zdCB7IHNvdXJjZSB9ID0gcmVxLnF1ZXJ5O1xuICAgIFxuICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0LmZpbmRPbmUoe1xuICAgICAgc2x1Zzogc2x1ZyxcbiAgICAgIGlzQWN0aXZlOiB0cnVlXG4gICAgfSk7XG4gICAgXG4gICAgaWYgKCFwcm9kdWN0KSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnUFJPRFVDVF9OT1RfRk9VTkQnLFxuICAgICAgICAgIG1lc3NhZ2U6ICdQcm9kdWN0IG5vdCBmb3VuZCdcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIFRyYWNrIHJlZmVycmFsIGlmIHNvdXJjZSBpcyBwcm92aWRlZFxuICAgIGlmIChzb3VyY2UpIHtcbiAgICAgIGNvbnNvbGUubG9nKGBDcm9zcy1zaXRlIHJlZmVycmFsOiAke3NvdXJjZX0gLT4gJHtwcm9kdWN0LnNsdWd9YCk7XG4gICAgfVxuICAgIFxuICAgIHJlcy5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHByb2R1Y3Q6IHtcbiAgICAgICAgICBfaWQ6IHByb2R1Y3QuX2lkLFxuICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcbiAgICAgICAgICBzbHVnOiBwcm9kdWN0LnNsdWcsXG4gICAgICAgICAgZGVzY3JpcHRpb246IHByb2R1Y3QuZGVzY3JpcHRpb24sXG4gICAgICAgICAgc2hvcnREZXNjcmlwdGlvbjogcHJvZHVjdC5zaG9ydERlc2NyaXB0aW9uLFxuICAgICAgICAgIHByaWNlOiBwcm9kdWN0LnByaWNlLFxuICAgICAgICAgIGNvbXBhcmVBdFByaWNlOiBwcm9kdWN0LmNvbXBhcmVBdFByaWNlLFxuICAgICAgICAgIGltYWdlczogcHJvZHVjdC5pbWFnZXMsXG4gICAgICAgICAgY2F0ZWdvcnk6IHByb2R1Y3QuY2F0ZWdvcnksXG4gICAgICAgICAgcHJvcGVydGllczogcHJvZHVjdC5wcm9wZXJ0aWVzLFxuICAgICAgICAgIHRhZ3M6IHByb2R1Y3QudGFnc1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgaW50ZWdyYXRpb24gcHJvZHVjdDonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnSU5URUdSQVRJT05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIGZldGNoIHByb2R1Y3QnXG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vLyBHZXQgZW1iZWRkYWJsZSBwcm9kdWN0IHdpZGdldCBkYXRhXG5yb3V0ZXIuZ2V0KCcvcHJvZHVjdHMvZW1iZWQvOnNsdWcnLCBbXG4gIHBhcmFtKCdzbHVnJykuaXNMZW5ndGgoeyBtaW46IDEsIG1heDogMTAwIH0pLm1hdGNoZXMoL15bYS16QS1aMC05LV9dKyQvKS53aXRoTWVzc2FnZSgnSW52YWxpZCBzbHVnIGZvcm1hdCcpLFxuICBxdWVyeSgnZm9ybWF0Jykub3B0aW9uYWwoKS5pc0luKFsnanNvbicsICdodG1sJ10pLndpdGhNZXNzYWdlKCdGb3JtYXQgbXVzdCBiZSBqc29uIG9yIGh0bWwnKSxcbiAgcXVlcnkoJ3RoZW1lJykub3B0aW9uYWwoKS5pc0luKFsnbGlnaHQnLCAnZGFyayddKS53aXRoTWVzc2FnZSgnVGhlbWUgbXVzdCBiZSBsaWdodCBvciBkYXJrJyksXG4gIGhhbmRsZVZhbGlkYXRpb25FcnJvcnNcbl0sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgc2x1ZyB9ID0gcmVxLnBhcmFtcztcbiAgICBjb25zdCB7IGZvcm1hdCA9ICdqc29uJywgdGhlbWUgPSAnbGlnaHQnIH0gPSByZXEucXVlcnk7XG4gICAgXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IFByb2R1Y3QuZmluZE9uZSh7XG4gICAgICBzbHVnLFxuICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICAnY3Jvc3NTaXRlSW50ZWdyYXRpb24uZW5hYmxlZCc6IHRydWVcbiAgICB9KTtcbiAgICBcbiAgICBpZiAoIXByb2R1Y3QpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdQUk9EVUNUX05PVF9GT1VORCcsXG4gICAgICAgICAgbWVzc2FnZTogJ1Byb2R1Y3Qgbm90IGZvdW5kIG9yIG5vdCBhdmFpbGFibGUgZm9yIGVtYmVkZGluZydcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGVtYmVkRGF0YSA9IHtcbiAgICAgIGlkOiBwcm9kdWN0Ll9pZCxcbiAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcbiAgICAgIHNsdWc6IHByb2R1Y3Quc2x1ZyxcbiAgICAgIHNob3J0RGVzY3JpcHRpb246IHByb2R1Y3Quc2hvcnREZXNjcmlwdGlvbixcbiAgICAgIHByaWNlOiBwcm9kdWN0LnByaWNlLFxuICAgICAgY29tcGFyZUF0UHJpY2U6IHByb2R1Y3QuY29tcGFyZUF0UHJpY2UsXG4gICAgICBwcmltYXJ5SW1hZ2U6IHByb2R1Y3QuaW1hZ2VzLmZpbmQoaW1nID0+IGltZy5pc1ByaW1hcnkpIHx8IHByb2R1Y3QuaW1hZ2VzWzBdLFxuICAgICAgY2F0ZWdvcnk6IHByb2R1Y3QuY2F0ZWdvcnksXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGNoYWtyYTogcHJvZHVjdC5wcm9wZXJ0aWVzLmNoYWtyYSxcbiAgICAgICAgZWxlbWVudDogcHJvZHVjdC5wcm9wZXJ0aWVzLmVsZW1lbnQsXG4gICAgICAgIGhlYWxpbmc6IHByb2R1Y3QucHJvcGVydGllcy5oZWFsaW5nXG4gICAgICB9LFxuICAgICAgc2VvOiBwcm9kdWN0LnNlbyxcbiAgICAgIHVybHM6IHtcbiAgICAgICAgcHJvZHVjdDogYC9wcm9kdWN0cy8ke3Byb2R1Y3Quc2x1Z31gLFxuICAgICAgICBhZGRUb0NhcnQ6ICcvYXBpL2NhcnQvYWRkJyxcbiAgICAgICAgYnV5Tm93OiBgL2NoZWNrb3V0P3Byb2R1Y3Q9JHtwcm9kdWN0Ll9pZH1gXG4gICAgICB9XG4gICAgfTtcbiAgICBcbiAgICBpZiAoZm9ybWF0ID09PSAnaHRtbCcpIHtcbiAgICAgIC8vIFJldHVybiBIVE1MIHdpZGdldFxuICAgICAgY29uc3QgaHRtbFdpZGdldCA9IGdlbmVyYXRlUHJvZHVjdFdpZGdldChlbWJlZERhdGEsIHRoZW1lKTtcbiAgICAgIHJlcy5zZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScsICd0ZXh0L2h0bWwnKTtcbiAgICAgIHJlcy5zZW5kKGh0bWxXaWRnZXQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBSZXR1cm4gSlNPTiBkYXRhXG4gICAgICByZXMuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGVtYmVkOiBlbWJlZERhdGEsXG4gICAgICAgIG1ldGE6IHtcbiAgICAgICAgICBmb3JtYXQsXG4gICAgICAgICAgdGhlbWUsXG4gICAgICAgICAgZW1iZWRDb2RlOiBgPGlmcmFtZSBzcmM9XCIke3JlcS5wcm90b2NvbH06Ly8ke3JlcS5nZXQoJ2hvc3QnKX0vYXBpL2ludGVncmF0aW9uL3Byb2R1Y3RzL2VtYmVkLyR7c2x1Z30/Zm9ybWF0PWh0bWwmdGhlbWU9JHt0aGVtZX1cIiB3aWR0aD1cIjMwMFwiIGhlaWdodD1cIjQwMFwiIGZyYW1lYm9yZGVyPVwiMFwiPjwvaWZyYW1lPmBcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1Byb2R1Y3QgZW1iZWQgZXJyb3I6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ0VNQkVEX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogJ0ZhaWxlZCB0byBnZW5lcmF0ZSBwcm9kdWN0IGVtYmVkJ1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KTtcblxuLy8gR2V0IHByb2R1Y3RzIHJlbGF0ZWQgdG8gY29udGVudCBJRCAoZm9yIGNvbnRlbnQtYmFzZWQgcmVjb21tZW5kYXRpb25zKVxucm91dGVyLmdldCgnL3Byb2R1Y3RzL3JlbGF0ZWQvOmNvbnRlbnRJZCcsIFtcbiAgcGFyYW0oJ2NvbnRlbnRJZCcpLmlzTGVuZ3RoKHsgbWluOiAxLCBtYXg6IDEwMCB9KS5tYXRjaGVzKC9eW2EtekEtWjAtOS1fXSskLykud2l0aE1lc3NhZ2UoJ0ludmFsaWQgY29udGVudCBJRCBmb3JtYXQnKSxcbiAgcXVlcnkoJ2xpbWl0Jykub3B0aW9uYWwoKS5pc0ludCh7IG1pbjogMSwgbWF4OiA1MCB9KS53aXRoTWVzc2FnZSgnTGltaXQgbXVzdCBiZSBiZXR3ZWVuIDEgYW5kIDUwJyksXG4gIHF1ZXJ5KCdjYXRlZ29yeScpLm9wdGlvbmFsKCkuaXNMZW5ndGgoeyBtYXg6IDUwIH0pLndpdGhNZXNzYWdlKCdDYXRlZ29yeSBwYXJhbWV0ZXIgdG9vIGxvbmcnKSxcbiAgaGFuZGxlVmFsaWRhdGlvbkVycm9yc1xuXSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBjb250ZW50SWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgY29uc3QgeyBsaW1pdCA9IDYsIGNhdGVnb3J5LCBwcm9wZXJ0aWVzIH0gPSByZXEucXVlcnk7XG4gICAgXG4gICAgLy8gQnVpbGQgcXVlcnkgYmFzZWQgb24gY29udGVudCByZWxhdGlvbnNoaXBcbiAgICBjb25zdCBxdWVyeSA9IHtcbiAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgICAgJ2Nyb3NzU2l0ZUludGVncmF0aW9uLmVuYWJsZWQnOiB0cnVlXG4gICAgfTtcbiAgICBcbiAgICAvLyBBZGQgY29udGVudC1zcGVjaWZpYyBmaWx0ZXJzXG4gICAgaWYgKGNvbnRlbnRJZC5pbmNsdWRlcygnY2hha3JhJykpIHtcbiAgICAgIGNvbnN0IGNoYWtyYU5hbWUgPSBjb250ZW50SWQucmVwbGFjZSgnY2hha3JhLScsICcnKTtcbiAgICAgIHF1ZXJ5Wydwcm9wZXJ0aWVzLmNoYWtyYSddID0geyAkaW46IFtjaGFrcmFOYW1lXSB9O1xuICAgIH0gZWxzZSBpZiAoY29udGVudElkLmluY2x1ZGVzKCdlbGVtZW50JykpIHtcbiAgICAgIGNvbnN0IGVsZW1lbnROYW1lID0gY29udGVudElkLnJlcGxhY2UoJ2VsZW1lbnQtJywgJycpO1xuICAgICAgcXVlcnlbJ3Byb3BlcnRpZXMuZWxlbWVudCddID0geyAkaW46IFtlbGVtZW50TmFtZV0gfTtcbiAgICB9IGVsc2UgaWYgKGNvbnRlbnRJZC5pbmNsdWRlcygnaGVhbGluZycpKSB7XG4gICAgICBjb25zdCBoZWFsaW5nUHJvcGVydHkgPSBjb250ZW50SWQucmVwbGFjZSgnaGVhbGluZy0nLCAnJyk7XG4gICAgICBxdWVyeVsncHJvcGVydGllcy5oZWFsaW5nJ10gPSB7ICRpbjogW2hlYWxpbmdQcm9wZXJ0eV0gfTtcbiAgICB9XG4gICAgXG4gICAgLy8gQWRkIGFkZGl0aW9uYWwgZmlsdGVyc1xuICAgIGlmIChjYXRlZ29yeSkge1xuICAgICAgcXVlcnkuY2F0ZWdvcnkgPSBjYXRlZ29yeTtcbiAgICB9XG4gICAgXG4gICAgaWYgKHByb3BlcnRpZXMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHByb3BlcnR5RmlsdGVycyA9IEpTT04ucGFyc2UocHJvcGVydGllcyk7XG4gICAgICAgIE9iamVjdC5rZXlzKHByb3BlcnR5RmlsdGVycykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgIGlmIChwcm9wZXJ0eUZpbHRlcnNba2V5XSkge1xuICAgICAgICAgICAgcXVlcnlbYHByb3BlcnRpZXMuJHtrZXl9YF0gPSB7ICRpbjogQXJyYXkuaXNBcnJheShwcm9wZXJ0eUZpbHRlcnNba2V5XSkgPyBwcm9wZXJ0eUZpbHRlcnNba2V5XSA6IFtwcm9wZXJ0eUZpbHRlcnNba2V5XV0gfTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBJZ25vcmUgaW52YWxpZCBKU09OIGluIHByb3BlcnRpZXMgZmlsdGVyXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgUHJvZHVjdC5maW5kKHF1ZXJ5KVxuICAgICAgLmxpbWl0KHBhcnNlSW50KGxpbWl0KSlcbiAgICAgIC5zb3J0KHsgaXNGZWF0dXJlZDogLTEsIGNyZWF0ZWRBdDogLTEgfSk7XG4gICAgXG4gICAgY29uc3QgcmVsYXRlZFByb2R1Y3RzID0gcHJvZHVjdHMubWFwKHByb2R1Y3QgPT4gcHJvZHVjdC5nZXRDcm9zc1NpdGVEYXRhKCkpO1xuICAgIFxuICAgIHJlcy5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBwcm9kdWN0czogcmVsYXRlZFByb2R1Y3RzLFxuICAgICAgbWV0YToge1xuICAgICAgICBjb250ZW50SWQsXG4gICAgICAgIGNvdW50OiByZWxhdGVkUHJvZHVjdHMubGVuZ3RoLFxuICAgICAgICBmaWx0ZXJzOiB7IGNhdGVnb3J5LCBwcm9wZXJ0aWVzIH0sXG4gICAgICAgIHRvdGFsQXZhaWxhYmxlOiBhd2FpdCBQcm9kdWN0LmNvdW50RG9jdW1lbnRzKHF1ZXJ5KVxuICAgICAgfVxuICAgIH0pO1xuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1JlbGF0ZWQgcHJvZHVjdHMgZXJyb3I6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1JFTEFURURfUFJPRFVDVFNfRVJST1InLFxuICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIGZldGNoIHJlbGF0ZWQgcHJvZHVjdHMnXG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vLyBUcmFjayByZWZlcnJhbCBhbmFseXRpY3MgKHJlcXVpcmVzIEFQSSBrZXkpXG5yb3V0ZXIucG9zdCgnL2FuYWx5dGljcy9yZWZlcnJhbCcsIFtcbiAgYXBpS2V5QXV0aCxcbiAgYm9keSgnc291cmNlJykuaXNMZW5ndGgoeyBtaW46IDEsIG1heDogMTAwIH0pLndpdGhNZXNzYWdlKCdTb3VyY2UgaXMgcmVxdWlyZWQgYW5kIG11c3QgYmUgbGVzcyB0aGFuIDEwMCBjaGFyYWN0ZXJzJyksXG4gIGJvZHkoJ2FjdGlvbicpLmlzSW4oWyd2aWV3JywgJ2NsaWNrJywgJ2FkZF90b19jYXJ0JywgJ3B1cmNoYXNlJ10pLndpdGhNZXNzYWdlKCdBY3Rpb24gbXVzdCBiZSBvbmUgb2Y6IHZpZXcsIGNsaWNrLCBhZGRfdG9fY2FydCwgcHVyY2hhc2UnKSxcbiAgYm9keSgncHJvZHVjdElkJykub3B0aW9uYWwoKS5pc01vbmdvSWQoKS53aXRoTWVzc2FnZSgnSW52YWxpZCBwcm9kdWN0IElEIGZvcm1hdCcpLFxuICBib2R5KCdtZXRhZGF0YScpLm9wdGlvbmFsKCkuaXNPYmplY3QoKS53aXRoTWVzc2FnZSgnTWV0YWRhdGEgbXVzdCBiZSBhbiBvYmplY3QnKSxcbiAgaGFuZGxlVmFsaWRhdGlvbkVycm9yc1xuXSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBzb3VyY2UsIHByb2R1Y3RJZCwgYWN0aW9uLCBtZXRhZGF0YSB9ID0gcmVxLmJvZHk7XG4gICAgXG4gICAgaWYgKCFzb3VyY2UgfHwgIWFjdGlvbikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ01JU1NJTkdfUkVRVUlSRURfRklFTERTJyxcbiAgICAgICAgICBtZXNzYWdlOiAnU291cmNlIGFuZCBhY3Rpb24gYXJlIHJlcXVpcmVkJ1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLy8gTG9nIHJlZmVycmFsIGFuYWx5dGljcyAoaW4gYSByZWFsIGFwcCwgeW91J2Qgc3RvcmUgdGhpcyBpbiBhIGRlZGljYXRlZCBhbmFseXRpY3MgY29sbGVjdGlvbilcbiAgICBjb25zdCBhbmFseXRpY3NEYXRhID0ge1xuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgc291cmNlLFxuICAgICAgcHJvZHVjdElkLFxuICAgICAgYWN0aW9uLCAvLyAndmlldycsICdjbGljaycsICdhZGRfdG9fY2FydCcsICdwdXJjaGFzZSdcbiAgICAgIG1ldGFkYXRhLFxuICAgICAgaXA6IHJlcS5pcCxcbiAgICAgIHVzZXJBZ2VudDogcmVxLmdldCgnVXNlci1BZ2VudCcpXG4gICAgfTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygnQ3Jvc3Mtc2l0ZSBhbmFseXRpY3M6JywgYW5hbHl0aWNzRGF0YSk7XG4gICAgXG4gICAgLy8gVE9ETzogU3RvcmUgaW4gYW5hbHl0aWNzIGNvbGxlY3Rpb25cbiAgICAvLyBhd2FpdCBBbmFseXRpY3MuY3JlYXRlKGFuYWx5dGljc0RhdGEpO1xuICAgIFxuICAgIHJlcy5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiAnUmVmZXJyYWwgdHJhY2tlZCBzdWNjZXNzZnVsbHknXG4gICAgfSk7XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignQW5hbHl0aWNzIHRyYWNraW5nIGVycm9yOicsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdBTkFMWVRJQ1NfRVJST1InLFxuICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIHRyYWNrIHJlZmVycmFsJ1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KTtcblxuLy8gR2V0IHJlZmVycmFsIGFuYWx5dGljcyBzdW1tYXJ5IChyZXF1aXJlcyBBUEkga2V5KVxucm91dGVyLmdldCgnL2FuYWx5dGljcy9zdW1tYXJ5JywgW1xuICBhcGlLZXlBdXRoLFxuICBxdWVyeSgnc3RhcnREYXRlJykub3B0aW9uYWwoKS5pc0lTTzg2MDEoKS53aXRoTWVzc2FnZSgnU3RhcnQgZGF0ZSBtdXN0IGJlIGluIElTTzg2MDEgZm9ybWF0JyksXG4gIHF1ZXJ5KCdlbmREYXRlJykub3B0aW9uYWwoKS5pc0lTTzg2MDEoKS53aXRoTWVzc2FnZSgnRW5kIGRhdGUgbXVzdCBiZSBpbiBJU084NjAxIGZvcm1hdCcpLFxuICBxdWVyeSgnc291cmNlJykub3B0aW9uYWwoKS5pc0xlbmd0aCh7IG1heDogMTAwIH0pLndpdGhNZXNzYWdlKCdTb3VyY2UgcGFyYW1ldGVyIHRvbyBsb25nJyksXG4gIGhhbmRsZVZhbGlkYXRpb25FcnJvcnNcbl0sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgc3RhcnREYXRlLCBlbmREYXRlLCBzb3VyY2UgfSA9IHJlcS5xdWVyeTtcbiAgICBcbiAgICAvLyBCdWlsZCBkYXRlIGZpbHRlclxuICAgIGNvbnN0IGRhdGVGaWx0ZXIgPSB7fTtcbiAgICBpZiAoc3RhcnREYXRlIHx8IGVuZERhdGUpIHtcbiAgICAgIGRhdGVGaWx0ZXIuY3JlYXRlZEF0ID0ge307XG4gICAgICBpZiAoc3RhcnREYXRlKSB7ZGF0ZUZpbHRlci5jcmVhdGVkQXQuJGd0ZSA9IG5ldyBEYXRlKHN0YXJ0RGF0ZSk7fVxuICAgICAgaWYgKGVuZERhdGUpIHtkYXRlRmlsdGVyLmNyZWF0ZWRBdC4kbHRlID0gbmV3IERhdGUoZW5kRGF0ZSk7fVxuICAgIH1cbiAgICBcbiAgICAvLyBCdWlsZCBzb3VyY2UgZmlsdGVyXG4gICAgY29uc3Qgc291cmNlRmlsdGVyID0ge307XG4gICAgaWYgKHNvdXJjZSkge1xuICAgICAgc291cmNlRmlsdGVyLnJlZmVycmFsU291cmNlID0gc291cmNlO1xuICAgIH1cbiAgICBcbiAgICAvLyBHZXQgb3JkZXIgYW5hbHl0aWNzIHdpdGggcmVmZXJyYWwgc291cmNlc1xuICAgIGNvbnN0IG9yZGVyQW5hbHl0aWNzID0gYXdhaXQgT3JkZXIuYWdncmVnYXRlKFtcbiAgICAgIHtcbiAgICAgICAgJG1hdGNoOiB7XG4gICAgICAgICAgLi4uZGF0ZUZpbHRlcixcbiAgICAgICAgICAuLi5zb3VyY2VGaWx0ZXIsXG4gICAgICAgICAgcmVmZXJyYWxTb3VyY2U6IHsgJGV4aXN0czogdHJ1ZSwgJG5lOiBudWxsIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJGdyb3VwOiB7XG4gICAgICAgICAgX2lkOiAnJHJlZmVycmFsU291cmNlJyxcbiAgICAgICAgICBvcmRlckNvdW50OiB7ICRzdW06IDEgfSxcbiAgICAgICAgICB0b3RhbFJldmVudWU6IHsgJHN1bTogJyR0b3RhbCcgfSxcbiAgICAgICAgICBhdmVyYWdlT3JkZXJWYWx1ZTogeyAkYXZnOiAnJHRvdGFsJyB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICRzb3J0OiB7IG9yZGVyQ291bnQ6IC0xIH1cbiAgICAgIH1cbiAgICBdKTtcbiAgICBcbiAgICAvLyBHZXQgdG9wIHJlZmVycmVkIHByb2R1Y3RzXG4gICAgY29uc3QgdG9wUHJvZHVjdHMgPSBhd2FpdCBPcmRlci5hZ2dyZWdhdGUoW1xuICAgICAge1xuICAgICAgICAkbWF0Y2g6IHtcbiAgICAgICAgICAuLi5kYXRlRmlsdGVyLFxuICAgICAgICAgIHJlZmVycmFsU291cmNlOiB7ICRleGlzdHM6IHRydWUsICRuZTogbnVsbCB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB7ICR1bndpbmQ6ICckaXRlbXMnIH0sXG4gICAgICB7XG4gICAgICAgICRncm91cDoge1xuICAgICAgICAgIF9pZDogJyRpdGVtcy5wcm9kdWN0JyxcbiAgICAgICAgICByZWZlcnJhbENvdW50OiB7ICRzdW06ICckaXRlbXMucXVhbnRpdHknIH0sXG4gICAgICAgICAgcmV2ZW51ZTogeyAkc3VtOiB7ICRtdWx0aXBseTogWyckaXRlbXMucHJpY2UnLCAnJGl0ZW1zLnF1YW50aXR5J10gfSB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICRsb29rdXA6IHtcbiAgICAgICAgICBmcm9tOiAncHJvZHVjdHMnLFxuICAgICAgICAgIGxvY2FsRmllbGQ6ICdfaWQnLFxuICAgICAgICAgIGZvcmVpZ25GaWVsZDogJ19pZCcsXG4gICAgICAgICAgYXM6ICdwcm9kdWN0J1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgeyAkdW53aW5kOiAnJHByb2R1Y3QnIH0sXG4gICAgICB7XG4gICAgICAgICRwcm9qZWN0OiB7XG4gICAgICAgICAgcHJvZHVjdE5hbWU6ICckcHJvZHVjdC5uYW1lJyxcbiAgICAgICAgICBwcm9kdWN0U2x1ZzogJyRwcm9kdWN0LnNsdWcnLFxuICAgICAgICAgIHJlZmVycmFsQ291bnQ6IDEsXG4gICAgICAgICAgcmV2ZW51ZTogMVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgeyAkc29ydDogeyByZWZlcnJhbENvdW50OiAtMSB9IH0sXG4gICAgICB7ICRsaW1pdDogMTAgfVxuICAgIF0pO1xuICAgIFxuICAgIHJlcy5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBhbmFseXRpY3M6IHtcbiAgICAgICAgc3VtbWFyeToge1xuICAgICAgICAgIHRvdGFsUmVmZXJyYWxPcmRlcnM6IG9yZGVyQW5hbHl0aWNzLnJlZHVjZSgoc3VtLCBpdGVtKSA9PiBzdW0gKyBpdGVtLm9yZGVyQ291bnQsIDApLFxuICAgICAgICAgIHRvdGFsUmVmZXJyYWxSZXZlbnVlOiBvcmRlckFuYWx5dGljcy5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgaXRlbS50b3RhbFJldmVudWUsIDApLFxuICAgICAgICAgIGF2ZXJhZ2VSZWZlcnJhbE9yZGVyVmFsdWU6IG9yZGVyQW5hbHl0aWNzLmxlbmd0aCA+IDAgXG4gICAgICAgICAgICA/IG9yZGVyQW5hbHl0aWNzLnJlZHVjZSgoc3VtLCBpdGVtKSA9PiBzdW0gKyBpdGVtLmF2ZXJhZ2VPcmRlclZhbHVlLCAwKSAvIG9yZGVyQW5hbHl0aWNzLmxlbmd0aCBcbiAgICAgICAgICAgIDogMFxuICAgICAgICB9LFxuICAgICAgICBieVNvdXJjZTogb3JkZXJBbmFseXRpY3MsXG4gICAgICAgIHRvcFByb2R1Y3RzXG4gICAgICB9LFxuICAgICAgbWV0YToge1xuICAgICAgICBkYXRlUmFuZ2U6IHsgc3RhcnREYXRlLCBlbmREYXRlIH0sXG4gICAgICAgIHNvdXJjZUZpbHRlcjogc291cmNlLFxuICAgICAgICBnZW5lcmF0ZWRBdDogbmV3IERhdGUoKVxuICAgICAgfVxuICAgIH0pO1xuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0FuYWx5dGljcyBzdW1tYXJ5IGVycm9yOicsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdBTkFMWVRJQ1NfU1VNTUFSWV9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gZ2VuZXJhdGUgYW5hbHl0aWNzIHN1bW1hcnknXG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vLyBIVE1MIGVzY2FwZSBmdW5jdGlvbiB0byBwcmV2ZW50IFhTU1xuZnVuY3Rpb24gZXNjYXBlSHRtbCh0ZXh0KSB7XG4gIGlmICghdGV4dCkge3JldHVybiAnJzt9XG4gIHJldHVybiB0ZXh0XG4gICAgLnJlcGxhY2UoLyYvZywgJyZhbXA7JylcbiAgICAucmVwbGFjZSgvPC9nLCAnJmx0OycpXG4gICAgLnJlcGxhY2UoLz4vZywgJyZndDsnKVxuICAgIC5yZXBsYWNlKC9cIi9nLCAnJnF1b3Q7JylcbiAgICAucmVwbGFjZSgvJy9nLCAnJiMzOTsnKTtcbn1cblxuLy8gR2VuZXJhdGUgSFRNTCB3aWRnZXQgZm9yIHByb2R1Y3QgZW1iZWRkaW5nXG5mdW5jdGlvbiBnZW5lcmF0ZVByb2R1Y3RXaWRnZXQocHJvZHVjdCwgdGhlbWUgPSAnbGlnaHQnKSB7XG4gIGNvbnN0IHRoZW1lU3R5bGVzID0gdGhlbWUgPT09ICdkYXJrJyBcbiAgICA/ICdiYWNrZ3JvdW5kOiAjMmQzNzQ4OyBjb2xvcjogI2UyZThmMDsgYm9yZGVyOiAxcHggc29saWQgIzRhNTU2ODsnXG4gICAgOiAnYmFja2dyb3VuZDogI2ZmZmZmZjsgY29sb3I6ICMyZDM3NDg7IGJvcmRlcjogMXB4IHNvbGlkICNlMmU4ZjA7JztcbiAgICBcbiAgcmV0dXJuIGBcbiAgICA8IURPQ1RZUEUgaHRtbD5cbiAgICA8aHRtbD5cbiAgICA8aGVhZD5cbiAgICAgIDxtZXRhIGNoYXJzZXQ9XCJ1dGYtOFwiPlxuICAgICAgPG1ldGEgbmFtZT1cInZpZXdwb3J0XCIgY29udGVudD1cIndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xXCI+XG4gICAgICA8dGl0bGU+JHtlc2NhcGVIdG1sKHByb2R1Y3QubmFtZSl9IC0gSG9saXN0aWMgU3RvcmU8L3RpdGxlPlxuICAgICAgPHN0eWxlPlxuICAgICAgICBib2R5IHsgbWFyZ2luOiAwOyBwYWRkaW5nOiAwOyBmb250LWZhbWlseTogLWFwcGxlLXN5c3RlbSwgQmxpbmtNYWNTeXN0ZW1Gb250LCAnU2Vnb2UgVUknLCBSb2JvdG8sIHNhbnMtc2VyaWY7IH1cbiAgICAgICAgLnByb2R1Y3Qtd2lkZ2V0IHtcbiAgICAgICAgICAke3RoZW1lU3R5bGVzfVxuICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDtcbiAgICAgICAgICBwYWRkaW5nOiAxNnB4O1xuICAgICAgICAgIG1heC13aWR0aDogMzAwcHg7XG4gICAgICAgICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwwLDAsMC4xKTtcbiAgICAgICAgfVxuICAgICAgICAucHJvZHVjdC1pbWFnZSB7XG4gICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgaGVpZ2h0OiAyMDBweDtcbiAgICAgICAgICBvYmplY3QtZml0OiBjb3ZlcjtcbiAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTJweDtcbiAgICAgICAgfVxuICAgICAgICAucHJvZHVjdC1uYW1lIHtcbiAgICAgICAgICBmb250LXNpemU6IDE4cHg7XG4gICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDtcbiAgICAgICAgICBtYXJnaW4tYm90dG9tOiA4cHg7XG4gICAgICAgICAgbGluZS1oZWlnaHQ6IDEuMztcbiAgICAgICAgfVxuICAgICAgICAucHJvZHVjdC1kZXNjcmlwdGlvbiB7XG4gICAgICAgICAgZm9udC1zaXplOiAxNHB4O1xuICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEycHg7XG4gICAgICAgICAgb3BhY2l0eTogMC44O1xuICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjQ7XG4gICAgICAgIH1cbiAgICAgICAgLnByb2R1Y3QtcHJpY2Uge1xuICAgICAgICAgIGZvbnQtc2l6ZTogMjBweDtcbiAgICAgICAgICBmb250LXdlaWdodDogNzAwO1xuICAgICAgICAgIG1hcmdpbi1ib3R0b206IDE2cHg7XG4gICAgICAgIH1cbiAgICAgICAgLnByb2R1Y3QtcHJvcGVydGllcyB7XG4gICAgICAgICAgZm9udC1zaXplOiAxMnB4O1xuICAgICAgICAgIG1hcmdpbi1ib3R0b206IDE2cHg7XG4gICAgICAgICAgb3BhY2l0eTogMC43O1xuICAgICAgICB9XG4gICAgICAgIC5wcm9kdWN0LWJ1dHRvbiB7XG4gICAgICAgICAgYmFja2dyb3VuZDogIzQyOTllMTtcbiAgICAgICAgICBjb2xvcjogd2hpdGU7XG4gICAgICAgICAgYm9yZGVyOiBub25lO1xuICAgICAgICAgIHBhZGRpbmc6IDEycHggMjRweDtcbiAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgICAgZm9udC1zaXplOiAxNHB4O1xuICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7XG4gICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZTtcbiAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQgMC4ycztcbiAgICAgICAgfVxuICAgICAgICAucHJvZHVjdC1idXR0b246aG92ZXIge1xuICAgICAgICAgIGJhY2tncm91bmQ6ICMzMTgyY2U7XG4gICAgICAgIH1cbiAgICAgIDwvc3R5bGU+XG4gICAgPC9oZWFkPlxuICAgIDxib2R5PlxuICAgICAgPGRpdiBjbGFzcz1cInByb2R1Y3Qtd2lkZ2V0XCI+XG4gICAgICAgICR7cHJvZHVjdC5wcmltYXJ5SW1hZ2UgPyBgPGltZyBzcmM9XCIke2VzY2FwZUh0bWwocHJvZHVjdC5wcmltYXJ5SW1hZ2UudXJsKX1cIiBhbHQ9XCIke2VzY2FwZUh0bWwocHJvZHVjdC5wcmltYXJ5SW1hZ2UuYWx0IHx8IHByb2R1Y3QubmFtZSl9XCIgY2xhc3M9XCJwcm9kdWN0LWltYWdlXCI+YCA6ICcnfVxuICAgICAgICA8ZGl2IGNsYXNzPVwicHJvZHVjdC1uYW1lXCI+JHtlc2NhcGVIdG1sKHByb2R1Y3QubmFtZSl9PC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJwcm9kdWN0LWRlc2NyaXB0aW9uXCI+JHtlc2NhcGVIdG1sKHByb2R1Y3Quc2hvcnREZXNjcmlwdGlvbiB8fCAnJyl9PC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJwcm9kdWN0LXByaWNlXCI+XG4gICAgICAgICAgJCR7cHJvZHVjdC5wcmljZS50b0ZpeGVkKDIpfVxuICAgICAgICAgICR7cHJvZHVjdC5jb21wYXJlQXRQcmljZSA/IGA8c3BhbiBzdHlsZT1cInRleHQtZGVjb3JhdGlvbjogbGluZS10aHJvdWdoOyBvcGFjaXR5OiAwLjY7IGZvbnQtc2l6ZTogMTZweDsgbWFyZ2luLWxlZnQ6IDhweDtcIj4kJHtwcm9kdWN0LmNvbXBhcmVBdFByaWNlLnRvRml4ZWQoMil9PC9zcGFuPmAgOiAnJ31cbiAgICAgICAgPC9kaXY+XG4gICAgICAgICR7cHJvZHVjdC5wcm9wZXJ0aWVzLmNoYWtyYSB8fCBwcm9kdWN0LnByb3BlcnRpZXMuZWxlbWVudCA/IGBcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwicHJvZHVjdC1wcm9wZXJ0aWVzXCI+XG4gICAgICAgICAgICAke3Byb2R1Y3QucHJvcGVydGllcy5jaGFrcmEgPyBgQ2hha3JhOiAke2VzY2FwZUh0bWwocHJvZHVjdC5wcm9wZXJ0aWVzLmNoYWtyYS5qb2luKCcsICcpKX0gYCA6ICcnfVxuICAgICAgICAgICAgJHtwcm9kdWN0LnByb3BlcnRpZXMuZWxlbWVudCA/IGBFbGVtZW50OiAke2VzY2FwZUh0bWwocHJvZHVjdC5wcm9wZXJ0aWVzLmVsZW1lbnQuam9pbignLCAnKSl9YCA6ICcnfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICBgIDogJyd9XG4gICAgICAgIDxhIGhyZWY9XCIke2VzY2FwZUh0bWwocHJvZHVjdC51cmxzLnByb2R1Y3QpfVwiIHRhcmdldD1cIl9wYXJlbnRcIiBjbGFzcz1cInByb2R1Y3QtYnV0dG9uXCI+XG4gICAgICAgICAgVmlldyBQcm9kdWN0XG4gICAgICAgIDwvYT5cbiAgICAgIDwvZGl2PlxuICAgIDwvYm9keT5cbiAgICA8L2h0bWw+XG4gIGA7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gcm91dGVyOyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsU0FBUyxDQUFDO0FBQ2xDLE1BQU1DLE1BQU0sR0FBR0YsT0FBTyxDQUFDRyxNQUFNLENBQUMsQ0FBQztBQUMvQixNQUFNO0VBQUVDLElBQUk7RUFBRUMsS0FBSztFQUFFQztBQUFNLENBQUMsR0FBR0wsT0FBTyxDQUFDLG1CQUFtQixDQUFDO0FBQzNELE1BQU1NLE9BQU8sR0FBR04sT0FBTyxDQUFDLG1CQUFtQixDQUFDO0FBQzVDLE1BQU1PLEtBQUssR0FBR1AsT0FBTyxDQUFDLGlCQUFpQixDQUFDO0FBQ3hDLE1BQU07RUFBRVEsVUFBVTtFQUFFQyxzQkFBc0I7RUFBRUM7QUFBVyxDQUFDLEdBQUdWLE9BQU8sQ0FBQyx3QkFBd0IsQ0FBQzs7QUFFNUY7QUFDQUMsTUFBTSxDQUFDVSxHQUFHLENBQUNELFVBQVUsQ0FBQ0UsV0FBVyxDQUFDOztBQUVsQztBQUNBWCxNQUFNLENBQUNZLEdBQUcsQ0FBQyw4QkFBOEIsRUFBRSxDQUN6Q1QsS0FBSyxDQUFDLGNBQWMsQ0FBQyxDQUFDVSxRQUFRLENBQUM7RUFBRUMsR0FBRyxFQUFFLENBQUM7RUFBRUMsR0FBRyxFQUFFO0FBQUksQ0FBQyxDQUFDLENBQUNDLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDQyxXQUFXLENBQUMsOEJBQThCLENBQUMsRUFDNUhiLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQ2MsUUFBUSxDQUFDLENBQUMsQ0FBQ0wsUUFBUSxDQUFDO0VBQUVFLEdBQUcsRUFBRTtBQUFJLENBQUMsQ0FBQyxDQUFDRSxXQUFXLENBQUMsMkJBQTJCLENBQUMsRUFDMUZULHNCQUFzQixDQUN2QixFQUFFLE9BQU9XLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0VBQ3JCLElBQUk7SUFDRixN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