7c633fcef5e1eba5b166cdf5223070d9
const express = require('express');
const router = express.Router();
const {
  processPendingNotifications,
  processOrderNotifications
} = require('../utils/wholesalerNotificationService');
const Order = require('../models/Order');

// GET /api/wholesalers/test
// Test endpoint to verify the system is working
router.get('/test', (req, res) => {
  res.json({
    success: true,
    message: 'Wholesaler notification system is active',
    timestamp: new Date().toISOString(),
    endpoints: ['POST /api/wholesalers/process-notifications - Process all pending notifications', 'POST /api/wholesalers/notify/:orderId - Process notifications for specific order', 'GET /api/wholesalers/pending - Get orders with pending notifications', 'GET /api/wholesalers/status/:orderId - Get notification status for order']
  });
});

// POST /api/wholesalers/process-notifications
// Process all pending wholesaler notifications
router.post('/process-notifications', async (req, res) => {
  try {
    const result = await processPendingNotifications();
    if (result.success) {
      res.json({
        success: true,
        message: 'Notification processing completed',
        data: {
          processed: result.processed,
          successCount: result.successCount || 0,
          errorCount: result.errorCount || 0,
          results: result.results || []
        }
      });
    } else {
      res.status(500).json({
        success: false,
        error: result.error
      });
    }
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

// POST /api/wholesalers/notify/:orderId
// Process notifications for a specific order
router.post('/notify/:orderId', async (req, res) => {
  try {
    const {
      orderId
    } = req.params;
    const result = await processOrderNotifications(orderId);
    if (result.success) {
      res.json({
        success: true,
        message: result.message || 'Order notifications processed',
        data: {
          orderNumber: result.orderNumber,
          results: result.results || []
        }
      });
    } else {
      res.status(400).json({
        success: false,
        error: result.error
      });
    }
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

// GET /api/wholesalers/pending
// Get list of orders with pending wholesaler notifications
router.get('/pending', async (req, res) => {
  try {
    const pendingOrders = await Order.find({
      $or: [{
        'payment.status': 'paid'
      }, {
        status: 'processing'
      }],
      'items.wholesaler.notified': false
    }).select('orderNumber createdAt status payment.status items.wholesaler');
    const summary = pendingOrders.map(order => ({
      orderId: order._id,
      orderNumber: order.orderNumber,
      orderDate: order.createdAt,
      status: order.status,
      paymentStatus: order.payment.status,
      pendingWholesalers: order.items.filter(item => !item.wholesaler.notified && item.wholesaler.email).map(item => ({
        wholesalerName: item.wholesaler.name,
        wholesalerEmail: item.wholesaler.email,
        productCode: item.wholesaler.productCode
      }))
    }));
    res.json({
      success: true,
      data: {
        count: pendingOrders.length,
        orders: summary
      }
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

// GET /api/wholesalers/status/:orderId
// Get wholesaler notification status for a specific order
router.get('/status/:orderId', async (req, res) => {
  try {
    const {
      orderId
    } = req.params;
    const order = await Order.findById(orderId).select('orderNumber items.wholesaler');
    if (!order) {
      return res.status(404).json({
        success: false,
        error: 'Order not found'
      });
    }
    const wholesalerStatus = order.items.map(item => ({
      wholesalerName: item.wholesaler.name,
      wholesalerEmail: item.wholesaler.email,
      productCode: item.wholesaler.productCode,
      notified: item.wholesaler.notified,
      notifiedAt: item.wholesaler.notifiedAt
    }));
    res.json({
      success: true,
      data: {
        orderNumber: order.orderNumber,
        wholesalers: wholesalerStatus
      }
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});
module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsInByb2Nlc3NQZW5kaW5nTm90aWZpY2F0aW9ucyIsInByb2Nlc3NPcmRlck5vdGlmaWNhdGlvbnMiLCJPcmRlciIsImdldCIsInJlcSIsInJlcyIsImpzb24iLCJzdWNjZXNzIiwibWVzc2FnZSIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImVuZHBvaW50cyIsInBvc3QiLCJyZXN1bHQiLCJkYXRhIiwicHJvY2Vzc2VkIiwic3VjY2Vzc0NvdW50IiwiZXJyb3JDb3VudCIsInJlc3VsdHMiLCJzdGF0dXMiLCJlcnJvciIsIm9yZGVySWQiLCJwYXJhbXMiLCJvcmRlck51bWJlciIsInBlbmRpbmdPcmRlcnMiLCJmaW5kIiwiJG9yIiwic2VsZWN0Iiwic3VtbWFyeSIsIm1hcCIsIm9yZGVyIiwiX2lkIiwib3JkZXJEYXRlIiwiY3JlYXRlZEF0IiwicGF5bWVudFN0YXR1cyIsInBheW1lbnQiLCJwZW5kaW5nV2hvbGVzYWxlcnMiLCJpdGVtcyIsImZpbHRlciIsIml0ZW0iLCJ3aG9sZXNhbGVyIiwibm90aWZpZWQiLCJlbWFpbCIsIndob2xlc2FsZXJOYW1lIiwibmFtZSIsIndob2xlc2FsZXJFbWFpbCIsInByb2R1Y3RDb2RlIiwiY291bnQiLCJsZW5ndGgiLCJvcmRlcnMiLCJmaW5kQnlJZCIsIndob2xlc2FsZXJTdGF0dXMiLCJub3RpZmllZEF0Iiwid2hvbGVzYWxlcnMiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsid2hvbGVzYWxlcnMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG5jb25zdCB7IHByb2Nlc3NQZW5kaW5nTm90aWZpY2F0aW9ucywgcHJvY2Vzc09yZGVyTm90aWZpY2F0aW9ucyB9ID0gcmVxdWlyZSgnLi4vdXRpbHMvd2hvbGVzYWxlck5vdGlmaWNhdGlvblNlcnZpY2UnKTtcbmNvbnN0IE9yZGVyID0gcmVxdWlyZSgnLi4vbW9kZWxzL09yZGVyJyk7XG5cbi8vIEdFVCAvYXBpL3dob2xlc2FsZXJzL3Rlc3Rcbi8vIFRlc3QgZW5kcG9pbnQgdG8gdmVyaWZ5IHRoZSBzeXN0ZW0gaXMgd29ya2luZ1xucm91dGVyLmdldCgnL3Rlc3QnLCAocmVxLCByZXMpID0+IHtcbiAgcmVzLmpzb24oe1xuICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgbWVzc2FnZTogJ1dob2xlc2FsZXIgbm90aWZpY2F0aW9uIHN5c3RlbSBpcyBhY3RpdmUnLFxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgIGVuZHBvaW50czogW1xuICAgICAgJ1BPU1QgL2FwaS93aG9sZXNhbGVycy9wcm9jZXNzLW5vdGlmaWNhdGlvbnMgLSBQcm9jZXNzIGFsbCBwZW5kaW5nIG5vdGlmaWNhdGlvbnMnLFxuICAgICAgJ1BPU1QgL2FwaS93aG9sZXNhbGVycy9ub3RpZnkvOm9yZGVySWQgLSBQcm9jZXNzIG5vdGlmaWNhdGlvbnMgZm9yIHNwZWNpZmljIG9yZGVyJyxcbiAgICAgICdHRVQgL2FwaS93aG9sZXNhbGVycy9wZW5kaW5nIC0gR2V0IG9yZGVycyB3aXRoIHBlbmRpbmcgbm90aWZpY2F0aW9ucycsXG4gICAgICAnR0VUIC9hcGkvd2hvbGVzYWxlcnMvc3RhdHVzLzpvcmRlcklkIC0gR2V0IG5vdGlmaWNhdGlvbiBzdGF0dXMgZm9yIG9yZGVyJ1xuICAgIF1cbiAgfSk7XG59KTtcblxuLy8gUE9TVCAvYXBpL3dob2xlc2FsZXJzL3Byb2Nlc3Mtbm90aWZpY2F0aW9uc1xuLy8gUHJvY2VzcyBhbGwgcGVuZGluZyB3aG9sZXNhbGVyIG5vdGlmaWNhdGlvbnNcbnJvdXRlci5wb3N0KCcvcHJvY2Vzcy1ub3RpZmljYXRpb25zJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvY2Vzc1BlbmRpbmdOb3RpZmljYXRpb25zKCk7XG4gICAgXG4gICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICByZXMuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6ICdOb3RpZmljYXRpb24gcHJvY2Vzc2luZyBjb21wbGV0ZWQnLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgcHJvY2Vzc2VkOiByZXN1bHQucHJvY2Vzc2VkLFxuICAgICAgICAgIHN1Y2Nlc3NDb3VudDogcmVzdWx0LnN1Y2Nlc3NDb3VudCB8fCAwLFxuICAgICAgICAgIGVycm9yQ291bnQ6IHJlc3VsdC5lcnJvckNvdW50IHx8IDAsXG4gICAgICAgICAgcmVzdWx0czogcmVzdWx0LnJlc3VsdHMgfHwgW11cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiByZXN1bHQuZXJyb3JcbiAgICAgIH0pO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlXG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vLyBQT1NUIC9hcGkvd2hvbGVzYWxlcnMvbm90aWZ5LzpvcmRlcklkXG4vLyBQcm9jZXNzIG5vdGlmaWNhdGlvbnMgZm9yIGEgc3BlY2lmaWMgb3JkZXJcbnJvdXRlci5wb3N0KCcvbm90aWZ5LzpvcmRlcklkJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBvcmRlcklkIH0gPSByZXEucGFyYW1zO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHByb2Nlc3NPcmRlck5vdGlmaWNhdGlvbnMob3JkZXJJZCk7XG4gICAgXG4gICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICByZXMuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6IHJlc3VsdC5tZXNzYWdlIHx8ICdPcmRlciBub3RpZmljYXRpb25zIHByb2Nlc3NlZCcsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBvcmRlck51bWJlcjogcmVzdWx0Lm9yZGVyTnVtYmVyLFxuICAgICAgICAgIHJlc3VsdHM6IHJlc3VsdC5yZXN1bHRzIHx8IFtdXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXMuc3RhdHVzKDQwMCkuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogcmVzdWx0LmVycm9yXG4gICAgICB9KTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZVxuICAgIH0pO1xuICB9XG59KTtcblxuLy8gR0VUIC9hcGkvd2hvbGVzYWxlcnMvcGVuZGluZ1xuLy8gR2V0IGxpc3Qgb2Ygb3JkZXJzIHdpdGggcGVuZGluZyB3aG9sZXNhbGVyIG5vdGlmaWNhdGlvbnNcbnJvdXRlci5nZXQoJy9wZW5kaW5nJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGVuZGluZ09yZGVycyA9IGF3YWl0IE9yZGVyLmZpbmQoe1xuICAgICAgJG9yOiBbXG4gICAgICAgIHsgJ3BheW1lbnQuc3RhdHVzJzogJ3BhaWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiAncHJvY2Vzc2luZycgfVxuICAgICAgXSxcbiAgICAgICdpdGVtcy53aG9sZXNhbGVyLm5vdGlmaWVkJzogZmFsc2VcbiAgICB9KS5zZWxlY3QoJ29yZGVyTnVtYmVyIGNyZWF0ZWRBdCBzdGF0dXMgcGF5bWVudC5zdGF0dXMgaXRlbXMud2hvbGVzYWxlcicpO1xuICAgIFxuICAgIGNvbnN0IHN1bW1hcnkgPSBwZW5kaW5nT3JkZXJzLm1hcChvcmRlciA9PiAoe1xuICAgICAgb3JkZXJJZDogb3JkZXIuX2lkLFxuICAgICAgb3JkZXJOdW1iZXI6IG9yZGVyLm9yZGVyTnVtYmVyLFxuICAgICAgb3JkZXJEYXRlOiBvcmRlci5jcmVhdGVkQXQsXG4gICAgICBzdGF0dXM6IG9yZGVyLnN0YXR1cyxcbiAgICAgIHBheW1lbnRTdGF0dXM6IG9yZGVyLnBheW1lbnQuc3RhdHVzLFxuICAgICAgcGVuZGluZ1dob2xlc2FsZXJzOiBvcmRlci5pdGVtc1xuICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gIWl0ZW0ud2hvbGVzYWxlci5ub3RpZmllZCAmJiBpdGVtLndob2xlc2FsZXIuZW1haWwpXG4gICAgICAgIC5tYXAoaXRlbSA9PiAoe1xuICAgICAgICAgIHdob2xlc2FsZXJOYW1lOiBpdGVtLndob2xlc2FsZXIubmFtZSxcbiAgICAgICAgICB3aG9sZXNhbGVyRW1haWw6IGl0ZW0ud2hvbGVzYWxlci5lbWFpbCxcbiAgICAgICAgICBwcm9kdWN0Q29kZTogaXRlbS53aG9sZXNhbGVyLnByb2R1Y3RDb2RlXG4gICAgICAgIH0pKVxuICAgIH0pKTtcbiAgICBcbiAgICByZXMuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YToge1xuICAgICAgICBjb3VudDogcGVuZGluZ09yZGVycy5sZW5ndGgsXG4gICAgICAgIG9yZGVyczogc3VtbWFyeVxuICAgICAgfVxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2VcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8vIEdFVCAvYXBpL3dob2xlc2FsZXJzL3N0YXR1cy86b3JkZXJJZFxuLy8gR2V0IHdob2xlc2FsZXIgbm90aWZpY2F0aW9uIHN0YXR1cyBmb3IgYSBzcGVjaWZpYyBvcmRlclxucm91dGVyLmdldCgnL3N0YXR1cy86b3JkZXJJZCcsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgb3JkZXJJZCB9ID0gcmVxLnBhcmFtcztcbiAgICBjb25zdCBvcmRlciA9IGF3YWl0IE9yZGVyLmZpbmRCeUlkKG9yZGVySWQpLnNlbGVjdCgnb3JkZXJOdW1iZXIgaXRlbXMud2hvbGVzYWxlcicpO1xuICAgIFxuICAgIGlmICghb3JkZXIpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ09yZGVyIG5vdCBmb3VuZCdcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCB3aG9sZXNhbGVyU3RhdHVzID0gb3JkZXIuaXRlbXMubWFwKGl0ZW0gPT4gKHtcbiAgICAgIHdob2xlc2FsZXJOYW1lOiBpdGVtLndob2xlc2FsZXIubmFtZSxcbiAgICAgIHdob2xlc2FsZXJFbWFpbDogaXRlbS53aG9sZXNhbGVyLmVtYWlsLFxuICAgICAgcHJvZHVjdENvZGU6IGl0ZW0ud2hvbGVzYWxlci5wcm9kdWN0Q29kZSxcbiAgICAgIG5vdGlmaWVkOiBpdGVtLndob2xlc2FsZXIubm90aWZpZWQsXG4gICAgICBub3RpZmllZEF0OiBpdGVtLndob2xlc2FsZXIubm90aWZpZWRBdFxuICAgIH0pKTtcbiAgICBcbiAgICByZXMuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YToge1xuICAgICAgICBvcmRlck51bWJlcjogb3JkZXIub3JkZXJOdW1iZXIsXG4gICAgICAgIHdob2xlc2FsZXJzOiB3aG9sZXNhbGVyU3RhdHVzXG4gICAgICB9XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZVxuICAgIH0pO1xuICB9XG59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