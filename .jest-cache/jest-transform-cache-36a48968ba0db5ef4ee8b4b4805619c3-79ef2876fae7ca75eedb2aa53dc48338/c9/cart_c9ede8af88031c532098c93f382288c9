b7ad1f6e98dcbf141d2c64c11d8ec764
const express = require('express');
const router = express.Router();
const Product = require('../models/Product');
const User = require('../models/User');
const Cart = require('../models/Cart');
const {
  authenticateToken
} = require('../middleware/auth');
const {
  validateCSRFToken
} = require('../middleware/sessionCSRF');
const cartService = require('../services/cartService');

// Helper function to get or create cart - Fixed cart persistence bug
const getOrCreateCart = async req => {
  if (req.user) {
    // For authenticated users, use user's cart
    const user = await User.findById(req.user._id);
    if (!user.cart) {
      user.cart = {
        items: [],
        updatedAt: new Date()
      };
      await user.save();
    }
    return {
      type: 'user',
      cart: user.cart,
      user
    };
  } else {
    // For guests, use session-based cart with database storage
    // Create a consistent session ID strategy to prevent ghost carts
    let sessionId = req.headers['x-guest-session-id'] || req.session?.cartId;

    // If no valid session ID exists, create a new one
    if (!sessionId || !sessionId.startsWith('guest_')) {
      sessionId = `guest_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;

      // Ensure session exists before setting properties
      if (!req.session) {
        // This shouldn't happen with proper session middleware, but handle gracefully
        console.warn('No session found when creating cart session ID');
        req.session = {};
      }
      req.session.cartId = sessionId;
    }

    // Clean up any orphaned carts for this session first
    const existingCarts = await Cart.find({
      sessionId
    });
    if (existingCarts.length > 1) {
      console.warn(`Found ${existingCarts.length} carts for session ${sessionId}, cleaning up duplicates`);
      // Keep the most recently updated cart and delete the rest
      const sortedCarts = existingCarts.sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt));
      const cartsToDelete = sortedCarts.slice(1);
      for (const cartToDelete of cartsToDelete) {
        await Cart.deleteOne({
          _id: cartToDelete._id
        });
      }
    }
    let cart = await Cart.findOne({
      sessionId
    });
    if (!cart) {
      cart = new Cart({
        sessionId,
        items: []
      });
      await cart.save();
    }
    return {
      type: 'guest',
      cart,
      sessionId
    };
  }
};

// Get cart contents with performance optimization
router.get('/', authenticateToken, async (req, res) => {
  try {
    // Use fallback to original function if cart service fails
    let cartData;
    try {
      cartData = await cartService.getCartWithPerformanceOptimization(req);
    } catch (serviceError) {
      console.warn('Cart service failed, using fallback:', serviceError.message);
      cartData = await getOrCreateCart(req);
    }
    const {
      type,
      cart,
      user
    } = cartData;

    // Populate product details for cart items
    const populatedCart = await Promise.all(cart.items.map(async item => {
      try {
        const product = await Product.findById(item.product).select('-wholesaler');
        if (!product || !product.isActive) {
          return null; // Filter out inactive products
        }
        return {
          _id: item.product,
          product: product.toPublicJSON(),
          quantity: item.quantity,
          price: item.price,
          subtotal: item.price * item.quantity
        };
      } catch (error) {
        console.error('Error populating cart item:', error);
        return null;
      }
    }));

    // Filter out null items (inactive products)
    const validCartItems = populatedCart.filter(item => item !== null);

    // Calculate totals
    const itemCount = validCartItems.reduce((total, item) => total + item.quantity, 0);
    const subtotal = validCartItems.reduce((total, item) => total + item.subtotal, 0);
    res.json({
      success: true,
      data: {
        cart: {
          items: validCartItems,
          itemCount,
          subtotal: Math.round(subtotal * 100) / 100,
          total: Math.round(subtotal * 100) / 100,
          isEmpty: validCartItems.length === 0
        }
      }
    });
  } catch (error) {
    console.error('Error fetching cart:', error);
    res.status(500).json({
      success: false,
      error: {
        code: 'CART_FETCH_ERROR',
        message: 'Failed to fetch cart'
      }
    });
  }
});

// Add item to cart with optimistic updates
router.post('/add', authenticateToken, validateCSRFToken, async (req, res) => {
  try {
    const {
      productId,
      quantity = 1
    } = req.body;

    // Validation
    if (!productId) {
      return res.status(400).json({
        success: false,
        error: {
          code: 'MISSING_PRODUCT_ID',
          message: 'Product ID is required'
        }
      });
    }

    // Enhanced quantity validation to prevent integer overflow and other edge cases
    if (!Number.isInteger(quantity) || quantity < 1 || quantity > 99) {
      return res.status(400).json({
        success: false,
        error: {
          code: 'INVALID_QUANTITY',
          message: 'Quantity must be between 1 and 99'
        }
      });
    }

    // Additional safety check for potential integer overflow
    if (quantity > Number.MAX_SAFE_INTEGER) {
      return res.status(400).json({
        success: false,
        error: {
          code: 'INVALID_QUANTITY',
          message: 'Quantity value is too large'
        }
      });
    }

    // Validate product ID format
    if (!productId.match(/^[0-9a-fA-F]{24}$/)) {
      return res.status(400).json({
        success: false,
        error: {
          code: 'INVALID_PRODUCT_ID',
          message: 'Invalid product ID format'
        }
      });
    }

    // Check if product exists and is active
    const product = await Product.findById(productId);
    if (!product) {
      return res.status(404).json({
        success: false,
        error: {
          code: 'PRODUCT_NOT_FOUND',
          message: 'Product not found'
        }
      });
    }
    if (!product.isActive) {
      return res.status(404).json({
        success: false,
        error: {
          code: 'PRODUCT_NOT_FOUND',
          message: 'Product not found or inactive'
        }
      });
    }

    // Check for existing item and validate maximum quantity
    const {
      type,
      cart,
      user
    } = await getOrCreateCart(req);
    if (type === 'user') {
      const existingItemIndex = user.cart.items.findIndex(item => item.product.toString() === productId.toString());
      if (existingItemIndex >= 0) {
        const currentQuantity = user.cart.items[existingItemIndex].quantity;
        const newQuantity = currentQuantity + quantity;

        // Check for integer overflow and maximum quantity
        if (newQuantity > 99 || newQuantity < currentQuantity) {
          return res.status(400).json({
            success: false,
            error: {
              code: 'MAX_QUANTITY_EXCEEDED',
              message: 'Cannot exceed maximum quantity of 99'
            }
          });
        }
      }
    } else {
      const existingItemIndex = cart.items.findIndex(item => item.product.toString() === productId.toString());
      if (existingItemIndex >= 0) {
        const currentQuantity = cart.items[existingItemIndex].quantity;
        const newQuantity = currentQuantity + quantity;

        // Check for integer overflow and maximum quantity
        if (newQuantity > 99 || newQuantity < currentQuantity) {
          return res.status(400).json({
            success: false,
            error: {
              code: 'MAX_QUANTITY_EXCEEDED',
              message: 'Cannot exceed maximum quantity of 99'
            }
          });
        }
      }
    }

    // Use optimistic cart service with fallback
    let result;
    try {
      result = await cartService.updateCartOptimistically(req, 'add', {
        productId,
        quantity
      });
    } catch (serviceError) {
      console.warn('Cart service failed, using fallback:', serviceError.message);
      // Fallback to original logic - need to re-fetch cart since service failed
      const fallbackCart = await getOrCreateCart(req);
      if (fallbackCart.type === 'user') {
        // Add to user's cart
        const existingItemIndex = fallbackCart.user.cart.items.findIndex(item => item.product.toString() === productId.toString());
        if (existingItemIndex >= 0) {
          fallbackCart.user.cart.items[existingItemIndex].quantity += quantity;
          fallbackCart.user.cart.items[existingItemIndex].addedAt = new Date();
        } else {
          fallbackCart.user.cart.items.push({
            product: productId,
            quantity,
            price: product.price,
            addedAt: new Date()
          });
        }
        fallbackCart.user.cart.updatedAt = new Date();
        await fallbackCart.user.save();
      } else {
        // Add to guest cart - use the Cart model method
        if (fallbackCart.cart.addItem && typeof fallbackCart.cart.addItem === 'function') {
          fallbackCart.cart.addItem(productId, quantity, product.price);
        } else {
          // Fallback: manually add item
          const existingItemIndex = fallbackCart.cart.items.findIndex(item => item.product.toString() === productId.toString());
          if (existingItemIndex >= 0) {
            fallbackCart.cart.items[existingItemIndex].quantity += quantity;
            fallbackCart.cart.items[existingItemIndex].addedAt = new Date();
          } else {
            fallbackCart.cart.items.push({
              product: productId,
              quantity,
              price: product.price,
              addedAt: new Date()
            });
          }
        }
        await fallbackCart.cart.save();
      }
      result = {
        duration: 0,
        performance: 'fallback'
      };
    }

    // Return updated cart with performance metrics
    let updatedCartData;
    try {
      updatedCartData = await cartService.getCartWithPerformanceOptimization(req);
    } catch (serviceError) {
      console.warn('Cart service failed after add, using fallback:', serviceError.message);
      updatedCartData = await getOrCreateCart(req);
    }
    const populatedCart = await Promise.all(updatedCartData.cart.items.map(async item => {
      const prod = await Product.findById(item.product).select('-wholesaler');
      if (!prod) {
        return null; // Filter out missing products
      }
      return {
        _id: item.product,
        product: prod.toPublicJSON(),
        quantity: item.quantity,
        price: item.price,
        subtotal: item.price * item.quantity
      };
    })).then(items => items.filter(item => item !== null));
    const itemCount = populatedCart.reduce((total, item) => total + item.quantity, 0);
    const subtotal = populatedCart.reduce((total, item) => total + item.subtotal, 0);
    res.json({
      success: true,
      message: 'Item added to cart',
      data: {
        cart: {
          items: populatedCart,
          itemCount,
          subtotal: Math.round(subtotal * 100) / 100,
          total: Math.round(subtotal * 100) / 100
        },
        performance: {
          duration: result.duration,
          status: result.performance
        }
      }
    });
  } catch (error) {
    console.error('Error adding to cart:', error);
    console.error('Full stack:', error.stack);
    res.status(500).json({
      success: false,
      error: {
        code: 'CART_ADD_ERROR',
        message: 'Failed to add item to cart',
        details: process.env.NODE_ENV === 'development' ? error.message : undefined,
        stack: process.env.NODE_ENV === 'development' ? error.stack : undefined
      }
    });
  }
});

// Update cart item quantity
router.put('/update', authenticateToken, validateCSRFToken, async (req, res) => {
  try {
    const {
      productId,
      quantity
    } = req.body;

    // Validation
    if (!productId) {
      return res.status(400).json({
        success: false,
        error: {
          code: 'MISSING_PRODUCT_ID',
          message: 'Product ID is required'
        }
      });
    }
    if (!Number.isInteger(quantity) || quantity < 0 || quantity > 99) {
      return res.status(400).json({
        success: false,
        error: {
          code: 'INVALID_QUANTITY',
          message: 'Quantity must be between 0 and 99'
        }
      });
    }
    const {
      type,
      cart,
      user
    } = await getOrCreateCart(req);
    if (type === 'user') {
      // Update user's cart
      const itemIndex = user.cart.items.findIndex(item => item.product.toString() === productId.toString());
      if (itemIndex >= 0) {
        if (quantity === 0) {
          user.cart.items.splice(itemIndex, 1);
        } else {
          user.cart.items[itemIndex].quantity = quantity;
          user.cart.items[itemIndex].addedAt = new Date();
        }
        user.cart.updatedAt = new Date();
        await user.save();
      } else {
        return res.status(404).json({
          success: false,
          error: {
            code: 'ITEM_NOT_FOUND',
            message: 'Item not found in cart'
          }
        });
      }
    } else {
      // Update guest cart
      const itemIndex = cart.items.findIndex(item => item.product.toString() === productId.toString());
      if (itemIndex >= 0) {
        if (cart.updateItem && typeof cart.updateItem === 'function') {
          cart.updateItem(productId, quantity);
        } else {
          // Manual update
          if (quantity === 0) {
            cart.items.splice(itemIndex, 1);
          } else {
            cart.items[itemIndex].quantity = quantity;
            cart.items[itemIndex].addedAt = new Date();
          }
          cart.updatedAt = new Date();
        }
        if (cart.save && typeof cart.save === 'function') {
          await cart.save();
        } else {
          // Use findByIdAndUpdate for lean objects
          await Cart.findByIdAndUpdate(cart._id, {
            items: cart.items,
            updatedAt: cart.updatedAt
          }, {
            new: true
          });
        }
      } else {
        return res.status(404).json({
          success: false,
          error: {
            code: 'ITEM_NOT_FOUND',
            message: 'Item not found in cart'
          }
        });
      }
    }

    // Return updated cart
    const updatedCartData = await getOrCreateCart(req);
    const populatedCart = await Promise.all(updatedCartData.cart.items.map(async item => {
      const product = await Product.findById(item.product).select('-wholesaler');
      if (!product || !product.isActive) return null;
      return {
        _id: item.product,
        product: product.toPublicJSON(),
        quantity: item.quantity,
        price: item.price,
        subtotal: item.price * item.quantity
      };
    }));
    const validCartItems = populatedCart.filter(item => item !== null);
    const itemCount = validCartItems.reduce((total, item) => total + item.quantity, 0);
    const subtotal = validCartItems.reduce((total, item) => total + item.subtotal, 0);

    // Check if item was removed (quantity was 0)
    const wasRemoved = quantity === 0;
    res.json({
      success: true,
      message: wasRemoved ? 'Item removed from cart' : 'Cart updated',
      data: {
        cart: {
          items: validCartItems,
          itemCount,
          subtotal: Math.round(subtotal * 100) / 100,
          total: Math.round(subtotal * 100) / 100
        }
      },
      cartItemCount: itemCount
    });
  } catch (error) {
    console.error('Error updating cart:', error);
    res.status(500).json({
      success: false,
      error: {
        code: 'CART_UPDATE_ERROR',
        message: 'Failed to update cart'
      }
    });
  }
});

// Remove item from cart
router.delete('/remove', authenticateToken, validateCSRFToken, async (req, res) => {
  try {
    const {
      productId
    } = req.body;
    if (!productId) {
      return res.status(400).json({
        success: false,
        error: {
          code: 'MISSING_PRODUCT_ID',
          message: 'Product ID is required'
        }
      });
    }
    const {
      type,
      cart,
      user
    } = await getOrCreateCart(req);
    if (type === 'user') {
      // Remove from user's cart
      const itemIndex = user.cart.items.findIndex(item => item.product.toString() === productId.toString());
      if (itemIndex >= 0) {
        user.cart.items.splice(itemIndex, 1);
        user.cart.updatedAt = new Date();
        await user.save();
      } else {
        return res.status(404).json({
          success: false,
          error: {
            code: 'ITEM_NOT_FOUND',
            message: 'Item not found in cart'
          }
        });
      }
    } else {
      // Remove from guest cart
      const itemIndex = cart.items.findIndex(item => item.product.toString() === productId.toString());
      if (itemIndex >= 0) {
        if (cart.removeItem && typeof cart.removeItem === 'function') {
          cart.removeItem(productId);
        } else {
          // Manual removal
          cart.items.splice(itemIndex, 1);
          cart.updatedAt = new Date();
        }
        if (cart.save && typeof cart.save === 'function') {
          await cart.save();
        } else {
          // Use findByIdAndUpdate for lean objects
          await Cart.findByIdAndUpdate(cart._id, {
            items: cart.items,
            updatedAt: cart.updatedAt
          }, {
            new: true
          });
        }
      } else {
        return res.status(404).json({
          success: false,
          error: {
            code: 'ITEM_NOT_FOUND',
            message: 'Item not found in cart'
          }
        });
      }
    }

    // Return updated cart
    const updatedCartData = await getOrCreateCart(req);
    const populatedCart = await Promise.all(updatedCartData.cart.items.map(async item => {
      const product = await Product.findById(item.product).select('-wholesaler');
      if (!product || !product.isActive) return null;
      return {
        _id: item.product,
        product: product.toPublicJSON(),
        quantity: item.quantity,
        price: item.price,
        subtotal: item.price * item.quantity
      };
    }));
    const validCartItems = populatedCart.filter(item => item !== null);
    const itemCount = validCartItems.reduce((total, item) => total + item.quantity, 0);
    const subtotal = validCartItems.reduce((total, item) => total + item.subtotal, 0);
    res.json({
      success: true,
      message: 'Item removed from cart',
      data: {
        cart: {
          items: validCartItems,
          itemCount,
          subtotal: Math.round(subtotal * 100) / 100,
          total: Math.round(subtotal * 100) / 100
        }
      },
      cartItemCount: itemCount
    });
  } catch (error) {
    console.error('Error removing from cart:', error);
    res.status(500).json({
      success: false,
      error: {
        code: 'CART_REMOVE_ERROR',
        message: 'Failed to remove item from cart'
      }
    });
  }
});

// Clear cart
router.delete('/clear', authenticateToken, validateCSRFToken, async (req, res) => {
  try {
    const {
      type,
      cart,
      user
    } = await getOrCreateCart(req);
    if (type === 'user') {
      // Clear user's cart
      user.cart.items = [];
      user.cart.updatedAt = new Date();
      await user.save();
      console.log('Cleared user cart for user:', user._id);
    } else {
      // Clear guest cart - be more aggressive
      console.log('Clearing guest cart for session:', cart.sessionId);

      // Delete the entire cart record and create a new one
      await Cart.deleteOne({
        sessionId: cart.sessionId
      });

      // Create a fresh cart
      const newCart = new Cart({
        sessionId: cart.sessionId,
        items: []
      });
      await newCart.save();
      console.log('Created fresh guest cart for session:', cart.sessionId);
    }
    res.json({
      success: true,
      message: 'Cart cleared',
      data: {
        cart: {
          items: [],
          itemCount: 0,
          subtotal: 0,
          total: 0,
          isEmpty: true
        }
      },
      cartItemCount: 0
    });
  } catch (error) {
    console.error('Error clearing cart:', error);
    res.status(500).json({
      success: false,
      error: {
        code: 'CART_CLEAR_ERROR',
        message: 'Failed to clear cart'
      }
    });
  }
});

// Merge guest cart with user cart with conflict resolution
router.post('/merge', authenticateToken, async (req, res) => {
  try {
    if (!req.user) {
      return res.status(401).json({
        success: false,
        error: {
          code: 'AUTHENTICATION_REQUIRED',
          message: 'User must be authenticated to merge cart'
        }
      });
    }
    const {
      guestCartItems,
      sessionId
    } = req.body;
    console.log('Cart merge request:', {
      userId: req.user._id,
      sessionId,
      guestItemCount: guestCartItems?.length || 0
    });

    // Use enhanced cart service for merging with conflict resolution
    let mergeResult;
    try {
      mergeResult = await cartService.mergeCartsWithConflictResolution(req.user._id, guestCartItems, sessionId);
    } catch (serviceError) {
      console.warn('Cart service merge failed, using fallback:', serviceError.message);
      // Fallback to original merge logic
      const user = await User.findById(req.user._id);
      if (!user.cart) {
        user.cart = {
          items: [],
          updatedAt: new Date()
        };
      }
      let mergedItems = 0;

      // Process guest cart items
      if (guestCartItems && Array.isArray(guestCartItems) && guestCartItems.length > 0) {
        for (const guestItem of guestCartItems) {
          const product = await Product.findById(guestItem.productId || guestItem.product);
          if (!product || !product.isActive) {
            continue;
          }
          const productId = guestItem.productId || guestItem.product;
          const quantity = guestItem.quantity || 1;
          const existingItemIndex = user.cart.items.findIndex(item => item.product.toString() === productId.toString());
          if (existingItemIndex >= 0) {
            user.cart.items[existingItemIndex].quantity += quantity;
            user.cart.items[existingItemIndex].addedAt = new Date();
          } else {
            user.cart.items.push({
              product: productId,
              quantity,
              price: product.price,
              addedAt: new Date()
            });
          }
          mergedItems++;
        }
      }

      // Process session-based cart
      if (sessionId) {
        const guestCart = await Cart.findOne({
          sessionId
        });
        if (guestCart && guestCart.items.length > 0) {
          console.log('Found guest cart with', guestCart.items.length, 'items for session:', sessionId);
          for (const guestItem of guestCart.items) {
            const product = await Product.findById(guestItem.product);
            if (!product || !product.isActive) {
              continue;
            }
            const existingItemIndex = user.cart.items.findIndex(item => item.product.toString() === guestItem.product.toString());
            if (existingItemIndex >= 0) {
              user.cart.items[existingItemIndex].quantity += guestItem.quantity;
              user.cart.items[existingItemIndex].addedAt = new Date();
            } else {
              user.cart.items.push({
                product: guestItem.product,
                quantity: guestItem.quantity,
                price: guestItem.price,
                addedAt: new Date()
              });
            }
            mergedItems++;
          }

          // Clean up the guest cart after merge
          await Cart.deleteOne({
            sessionId
          });
          console.log('Deleted guest cart for session:', sessionId);
        } else {
          console.log('No guest cart found for session:', sessionId);
        }
      }
      user.cart.updatedAt = new Date();
      await user.save();
      mergeResult = {
        mergedItems,
        conflicts: [],
        duration: 0
      };
    }

    // Get updated cart data with fallback
    let updatedCartData;
    try {
      updatedCartData = await cartService.getCartWithPerformanceOptimization(req);
    } catch (serviceError) {
      console.warn('Cart service failed in merge, using fallback:', serviceError.message);
      updatedCartData = await getOrCreateCart(req);
    }

    // Return updated user cart
    const populatedCart = await Promise.all(updatedCartData.cart.items.map(async item => {
      try {
        const product = await Product.findById(item.product).select('-wholesaler');
        if (!product || !product.isActive) {
          return null; // Filter out inactive products
        }
        return {
          _id: item.product,
          product: product.toPublicJSON(),
          quantity: item.quantity,
          price: item.price,
          subtotal: item.price * item.quantity
        };
      } catch (error) {
        console.error('Error populating cart item:', error);
        return null;
      }
    }));

    // Filter out null items (inactive products)
    const validCartItems = populatedCart.filter(item => item !== null);
    const itemCount = validCartItems.reduce((total, item) => total + item.quantity, 0);
    const subtotal = validCartItems.reduce((total, item) => total + item.subtotal, 0);
    res.json({
      success: true,
      message: `Successfully merged ${mergeResult.mergedItems} items into your cart`,
      data: {
        cart: {
          items: validCartItems,
          itemCount,
          subtotal: Math.round(subtotal * 100) / 100,
          total: Math.round(subtotal * 100) / 100,
          isEmpty: validCartItems.length === 0
        },
        merge: {
          mergedItems: mergeResult.mergedItems,
          conflicts: mergeResult.conflicts,
          duration: mergeResult.duration
        }
      }
    });
  } catch (error) {
    console.error('Error merging guest cart:', error);
    res.status(500).json({
      success: false,
      error: {
        code: 'CART_MERGE_ERROR',
        message: 'Failed to merge guest cart',
        details: process.env.NODE_ENV === 'development' ? error.message : undefined
      }
    });
  }
});

// Reset guest cart session - helps fix cart persistence issues
router.post('/reset-guest-session', async (req, res) => {
  try {
    // Only allow this for non-authenticated users (guests)
    if (req.user) {
      return res.status(400).json({
        success: false,
        error: {
          code: 'NOT_GUEST_USER',
          message: 'This endpoint is only for guest users'
        }
      });
    }

    // Clear current session cart data
    if (req.session) {
      const oldSessionId = req.session.cartId;

      // Delete old guest cart if it exists
      if (oldSessionId && oldSessionId.startsWith('guest_')) {
        const deleteResult = await Cart.deleteMany({
          sessionId: oldSessionId
        });
        console.log(`Deleted ${deleteResult.deletedCount} guest cart(s) for old session ${oldSessionId}`);
      }

      // Clear session cart data
      delete req.session.cartId;
      delete req.session.guestId;
    }

    // Create a fresh guest session ID
    const newSessionId = `guest_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    if (req.session) {
      req.session.cartId = newSessionId;
    }

    // Create a fresh empty cart
    const newCart = new Cart({
      sessionId: newSessionId,
      items: []
    });
    await newCart.save();
    res.json({
      success: true,
      message: 'Guest cart session reset successfully',
      data: {
        sessionId: newSessionId,
        cart: {
          items: [],
          itemCount: 0,
          subtotal: 0,
          total: 0,
          isEmpty: true
        }
      }
    });
  } catch (error) {
    console.error('Error resetting guest cart session:', error);
    res.status(500).json({
      success: false,
      error: {
        code: 'RESET_SESSION_ERROR',
        message: 'Failed to reset guest cart session'
      }
    });
  }
});

// Debug endpoint to see all guest carts (development only)
if (process.env.NODE_ENV === 'development') {
  router.get('/debug', async (req, res) => {
    try {
      const guestCarts = await Cart.find({}).select('sessionId items createdAt updatedAt');
      const userCarts = await User.find({
        'cart.items.0': {
          $exists: true
        }
      }).select('email cart.items cart.updatedAt');
      res.json({
        success: true,
        data: {
          guestCarts: guestCarts.map(cart => ({
            sessionId: cart.sessionId,
            itemCount: cart.items.length,
            items: cart.items,
            createdAt: cart.createdAt,
            updatedAt: cart.updatedAt
          })),
          userCarts: userCarts.map(user => ({
            email: user.email,
            itemCount: user.cart?.items?.length || 0,
            items: user.cart?.items || [],
            updatedAt: user.cart?.updatedAt
          })),
          currentSession: {
            guestSessionId: req.headers['x-guest-session-id'],
            serverSessionId: req.sessionID
          }
        }
      });
    } catch (error) {
      res.status(500).json({
        success: false,
        error: error.message
      });
    }
  });
}
module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsIlByb2R1Y3QiLCJVc2VyIiwiQ2FydCIsImF1dGhlbnRpY2F0ZVRva2VuIiwidmFsaWRhdGVDU1JGVG9rZW4iLCJjYXJ0U2VydmljZSIsImdldE9yQ3JlYXRlQ2FydCIsInJlcSIsInVzZXIiLCJmaW5kQnlJZCIsIl9pZCIsImNhcnQiLCJpdGVtcyIsInVwZGF0ZWRBdCIsIkRhdGUiLCJzYXZlIiwidHlwZSIsInNlc3Npb25JZCIsImhlYWRlcnMiLCJzZXNzaW9uIiwiY2FydElkIiwic3RhcnRzV2l0aCIsIm5vdyIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0ciIsImNvbnNvbGUiLCJ3YXJuIiwiZXhpc3RpbmdDYXJ0cyIsImZpbmQiLCJsZW5ndGgiLCJzb3J0ZWRDYXJ0cyIsInNvcnQiLCJhIiwiYiIsImNhcnRzVG9EZWxldGUiLCJzbGljZSIsImNhcnRUb0RlbGV0ZSIsImRlbGV0ZU9uZSIsImZpbmRPbmUiLCJnZXQiLCJyZXMiLCJjYXJ0RGF0YSIsImdldENhcnRXaXRoUGVyZm9ybWFuY2VPcHRpbWl6YXRpb24iLCJzZXJ2aWNlRXJyb3IiLCJtZXNzYWdlIiwicG9wdWxhdGVkQ2FydCIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJpdGVtIiwicHJvZHVjdCIsInNlbGVjdCIsImlzQWN0aXZlIiwidG9QdWJsaWNKU09OIiwicXVhbnRpdHkiLCJwcmljZSIsInN1YnRvdGFsIiwiZXJyb3IiLCJ2YWxpZENhcnRJdGVtcyIsImZpbHRlciIsIml0ZW1Db3VudCIsInJlZHVjZSIsInRvdGFsIiwianNvbiIsInN1Y2Nlc3MiLCJkYXRhIiwicm91bmQiLCJpc0VtcHR5Iiwic3RhdHVzIiwiY29kZSIsInBvc3QiLCJwcm9kdWN0SWQiLCJib2R5IiwiTnVtYmVyIiwiaXNJbnRlZ2VyIiwiTUFYX1NBRkVfSU5URUdFUiIsIm1hdGNoIiwiZXhpc3RpbmdJdGVtSW5kZXgiLCJmaW5kSW5kZXgiLCJjdXJyZW50UXVhbnRpdHkiLCJuZXdRdWFudGl0eSIsInJlc3VsdCIsInVwZGF0ZUNhcnRPcHRpbWlzdGljYWxseSIsImZhbGxiYWNrQ2FydCIsImFkZGVkQXQiLCJwdXNoIiwiYWRkSXRlbSIsImR1cmF0aW9uIiwicGVyZm9ybWFuY2UiLCJ1cGRhdGVkQ2FydERhdGEiLCJwcm9kIiwidGhlbiIsInN0YWNrIiwiZGV0YWlscyIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsInVuZGVmaW5lZCIsInB1dCIsIml0ZW1JbmRleCIsInNwbGljZSIsInVwZGF0ZUl0ZW0iLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIm5ldyIsIndhc1JlbW92ZWQiLCJjYXJ0SXRlbUNvdW50IiwiZGVsZXRlIiwicmVtb3ZlSXRlbSIsImxvZyIsIm5ld0NhcnQiLCJndWVzdENhcnRJdGVtcyIsInVzZXJJZCIsImd1ZXN0SXRlbUNvdW50IiwibWVyZ2VSZXN1bHQiLCJtZXJnZUNhcnRzV2l0aENvbmZsaWN0UmVzb2x1dGlvbiIsIm1lcmdlZEl0ZW1zIiwiQXJyYXkiLCJpc0FycmF5IiwiZ3Vlc3RJdGVtIiwiZ3Vlc3RDYXJ0IiwiY29uZmxpY3RzIiwibWVyZ2UiLCJvbGRTZXNzaW9uSWQiLCJkZWxldGVSZXN1bHQiLCJkZWxldGVNYW55IiwiZGVsZXRlZENvdW50IiwiZ3Vlc3RJZCIsIm5ld1Nlc3Npb25JZCIsImd1ZXN0Q2FydHMiLCJ1c2VyQ2FydHMiLCIkZXhpc3RzIiwiY3JlYXRlZEF0IiwiZW1haWwiLCJjdXJyZW50U2Vzc2lvbiIsImd1ZXN0U2Vzc2lvbklkIiwic2VydmVyU2Vzc2lvbklkIiwic2Vzc2lvbklEIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImNhcnQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG5jb25zdCBQcm9kdWN0ID0gcmVxdWlyZSgnLi4vbW9kZWxzL1Byb2R1Y3QnKTtcbmNvbnN0IFVzZXIgPSByZXF1aXJlKCcuLi9tb2RlbHMvVXNlcicpO1xuY29uc3QgQ2FydCA9IHJlcXVpcmUoJy4uL21vZGVscy9DYXJ0Jyk7XG5jb25zdCB7IGF1dGhlbnRpY2F0ZVRva2VuIH0gPSByZXF1aXJlKCcuLi9taWRkbGV3YXJlL2F1dGgnKTtcbmNvbnN0IHsgdmFsaWRhdGVDU1JGVG9rZW4gfSA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmUvc2Vzc2lvbkNTUkYnKTtcbmNvbnN0IGNhcnRTZXJ2aWNlID0gcmVxdWlyZSgnLi4vc2VydmljZXMvY2FydFNlcnZpY2UnKTtcblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGdldCBvciBjcmVhdGUgY2FydCAtIEZpeGVkIGNhcnQgcGVyc2lzdGVuY2UgYnVnXG5jb25zdCBnZXRPckNyZWF0ZUNhcnQgPSBhc3luYyAocmVxKSA9PiB7XG4gIGlmIChyZXEudXNlcikge1xuICAgIC8vIEZvciBhdXRoZW50aWNhdGVkIHVzZXJzLCB1c2UgdXNlcidzIGNhcnRcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZChyZXEudXNlci5faWQpO1xuICAgIGlmICghdXNlci5jYXJ0KSB7XG4gICAgICB1c2VyLmNhcnQgPSB7IGl0ZW1zOiBbXSwgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpIH07XG4gICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcbiAgICB9XG4gICAgcmV0dXJuIHsgdHlwZTogJ3VzZXInLCBjYXJ0OiB1c2VyLmNhcnQsIHVzZXIgfTtcbiAgfSBlbHNlIHtcbiAgICAvLyBGb3IgZ3Vlc3RzLCB1c2Ugc2Vzc2lvbi1iYXNlZCBjYXJ0IHdpdGggZGF0YWJhc2Ugc3RvcmFnZVxuICAgIC8vIENyZWF0ZSBhIGNvbnNpc3RlbnQgc2Vzc2lvbiBJRCBzdHJhdGVneSB0byBwcmV2ZW50IGdob3N0IGNhcnRzXG4gICAgbGV0IHNlc3Npb25JZCA9IHJlcS5oZWFkZXJzWyd4LWd1ZXN0LXNlc3Npb24taWQnXSB8fCByZXEuc2Vzc2lvbj8uY2FydElkO1xuICAgIFxuICAgIC8vIElmIG5vIHZhbGlkIHNlc3Npb24gSUQgZXhpc3RzLCBjcmVhdGUgYSBuZXcgb25lXG4gICAgaWYgKCFzZXNzaW9uSWQgfHwgIXNlc3Npb25JZC5zdGFydHNXaXRoKCdndWVzdF8nKSkge1xuICAgICAgc2Vzc2lvbklkID0gYGd1ZXN0XyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YDtcbiAgICAgIFxuICAgICAgLy8gRW5zdXJlIHNlc3Npb24gZXhpc3RzIGJlZm9yZSBzZXR0aW5nIHByb3BlcnRpZXNcbiAgICAgIGlmICghcmVxLnNlc3Npb24pIHtcbiAgICAgICAgLy8gVGhpcyBzaG91bGRuJ3QgaGFwcGVuIHdpdGggcHJvcGVyIHNlc3Npb24gbWlkZGxld2FyZSwgYnV0IGhhbmRsZSBncmFjZWZ1bGx5XG4gICAgICAgIGNvbnNvbGUud2FybignTm8gc2Vzc2lvbiBmb3VuZCB3aGVuIGNyZWF0aW5nIGNhcnQgc2Vzc2lvbiBJRCcpO1xuICAgICAgICByZXEuc2Vzc2lvbiA9IHt9O1xuICAgICAgfVxuICAgICAgcmVxLnNlc3Npb24uY2FydElkID0gc2Vzc2lvbklkO1xuICAgIH1cbiAgICBcbiAgICAvLyBDbGVhbiB1cCBhbnkgb3JwaGFuZWQgY2FydHMgZm9yIHRoaXMgc2Vzc2lvbiBmaXJzdFxuICAgIGNvbnN0IGV4aXN0aW5nQ2FydHMgPSBhd2FpdCBDYXJ0LmZpbmQoeyBzZXNzaW9uSWQgfSk7XG4gICAgaWYgKGV4aXN0aW5nQ2FydHMubGVuZ3RoID4gMSkge1xuICAgICAgY29uc29sZS53YXJuKGBGb3VuZCAke2V4aXN0aW5nQ2FydHMubGVuZ3RofSBjYXJ0cyBmb3Igc2Vzc2lvbiAke3Nlc3Npb25JZH0sIGNsZWFuaW5nIHVwIGR1cGxpY2F0ZXNgKTtcbiAgICAgIC8vIEtlZXAgdGhlIG1vc3QgcmVjZW50bHkgdXBkYXRlZCBjYXJ0IGFuZCBkZWxldGUgdGhlIHJlc3RcbiAgICAgIGNvbnN0IHNvcnRlZENhcnRzID0gZXhpc3RpbmdDYXJ0cy5zb3J0KChhLCBiKSA9PiBuZXcgRGF0ZShiLnVwZGF0ZWRBdCkgLSBuZXcgRGF0ZShhLnVwZGF0ZWRBdCkpO1xuICAgICAgY29uc3QgY2FydHNUb0RlbGV0ZSA9IHNvcnRlZENhcnRzLnNsaWNlKDEpO1xuICAgICAgZm9yIChjb25zdCBjYXJ0VG9EZWxldGUgb2YgY2FydHNUb0RlbGV0ZSkge1xuICAgICAgICBhd2FpdCBDYXJ0LmRlbGV0ZU9uZSh7IF9pZDogY2FydFRvRGVsZXRlLl9pZCB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgbGV0IGNhcnQgPSBhd2FpdCBDYXJ0LmZpbmRPbmUoeyBzZXNzaW9uSWQgfSk7XG4gICAgXG4gICAgaWYgKCFjYXJ0KSB7XG4gICAgICBjYXJ0ID0gbmV3IENhcnQoeyBzZXNzaW9uSWQsIGl0ZW1zOiBbXSB9KTtcbiAgICAgIGF3YWl0IGNhcnQuc2F2ZSgpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4geyB0eXBlOiAnZ3Vlc3QnLCBjYXJ0LCBzZXNzaW9uSWQgfTtcbiAgfVxufTtcblxuLy8gR2V0IGNhcnQgY29udGVudHMgd2l0aCBwZXJmb3JtYW5jZSBvcHRpbWl6YXRpb25cbnJvdXRlci5nZXQoJy8nLCBhdXRoZW50aWNhdGVUb2tlbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgLy8gVXNlIGZhbGxiYWNrIHRvIG9yaWdpbmFsIGZ1bmN0aW9uIGlmIGNhcnQgc2VydmljZSBmYWlsc1xuICAgIGxldCBjYXJ0RGF0YTtcbiAgICB0cnkge1xuICAgICAgY2FydERhdGEgPSBhd2FpdCBjYXJ0U2VydmljZS5nZXRDYXJ0V2l0aFBlcmZvcm1hbmNlT3B0aW1pemF0aW9uKHJlcSk7XG4gICAgfSBjYXRjaCAoc2VydmljZUVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0NhcnQgc2VydmljZSBmYWlsZWQsIHVzaW5nIGZhbGxiYWNrOicsIHNlcnZpY2VFcnJvci5tZXNzYWdlKTtcbiAgICAgIGNhcnREYXRhID0gYXdhaXQgZ2V0T3JDcmVhdGVDYXJ0KHJlcSk7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHsgdHlwZSwgY2FydCwgdXNlciB9ID0gY2FydERhdGE7XG4gICAgXG4gICAgLy8gUG9wdWxhdGUgcHJvZHVjdCBkZXRhaWxzIGZvciBjYXJ0IGl0ZW1zXG4gICAgY29uc3QgcG9wdWxhdGVkQ2FydCA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgY2FydC5pdGVtcy5tYXAoYXN5bmMgKGl0ZW0pID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBwcm9kdWN0ID0gYXdhaXQgUHJvZHVjdC5maW5kQnlJZChpdGVtLnByb2R1Y3QpLnNlbGVjdCgnLXdob2xlc2FsZXInKTtcbiAgICAgICAgICBpZiAoIXByb2R1Y3QgfHwgIXByb2R1Y3QuaXNBY3RpdmUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsOyAvLyBGaWx0ZXIgb3V0IGluYWN0aXZlIHByb2R1Y3RzXG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBfaWQ6IGl0ZW0ucHJvZHVjdCxcbiAgICAgICAgICAgIHByb2R1Y3Q6IHByb2R1Y3QudG9QdWJsaWNKU09OKCksXG4gICAgICAgICAgICBxdWFudGl0eTogaXRlbS5xdWFudGl0eSxcbiAgICAgICAgICAgIHByaWNlOiBpdGVtLnByaWNlLFxuICAgICAgICAgICAgc3VidG90YWw6IGl0ZW0ucHJpY2UgKiBpdGVtLnF1YW50aXR5XG4gICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwb3B1bGF0aW5nIGNhcnQgaXRlbTonLCBlcnJvcik7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgKTtcblxuICAgIC8vIEZpbHRlciBvdXQgbnVsbCBpdGVtcyAoaW5hY3RpdmUgcHJvZHVjdHMpXG4gICAgY29uc3QgdmFsaWRDYXJ0SXRlbXMgPSBwb3B1bGF0ZWRDYXJ0LmZpbHRlcihpdGVtID0+IGl0ZW0gIT09IG51bGwpO1xuICAgIFxuICAgIC8vIENhbGN1bGF0ZSB0b3RhbHNcbiAgICBjb25zdCBpdGVtQ291bnQgPSB2YWxpZENhcnRJdGVtcy5yZWR1Y2UoKHRvdGFsLCBpdGVtKSA9PiB0b3RhbCArIGl0ZW0ucXVhbnRpdHksIDApO1xuICAgIGNvbnN0IHN1YnRvdGFsID0gdmFsaWRDYXJ0SXRlbXMucmVkdWNlKCh0b3RhbCwgaXRlbSkgPT4gdG90YWwgKyBpdGVtLnN1YnRvdGFsLCAwKTtcbiAgICBcbiAgICByZXMuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YToge1xuICAgICAgICBjYXJ0OiB7XG4gICAgICAgICAgaXRlbXM6IHZhbGlkQ2FydEl0ZW1zLFxuICAgICAgICAgIGl0ZW1Db3VudCxcbiAgICAgICAgICBzdWJ0b3RhbDogTWF0aC5yb3VuZChzdWJ0b3RhbCAqIDEwMCkgLyAxMDAsXG4gICAgICAgICAgdG90YWw6IE1hdGgucm91bmQoc3VidG90YWwgKiAxMDApIC8gMTAwLFxuICAgICAgICAgIGlzRW1wdHk6IHZhbGlkQ2FydEl0ZW1zLmxlbmd0aCA9PT0gMFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXJ0OicsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdDQVJUX0ZFVENIX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogJ0ZhaWxlZCB0byBmZXRjaCBjYXJ0J1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KTtcblxuLy8gQWRkIGl0ZW0gdG8gY2FydCB3aXRoIG9wdGltaXN0aWMgdXBkYXRlc1xucm91dGVyLnBvc3QoJy9hZGQnLCBhdXRoZW50aWNhdGVUb2tlbiwgdmFsaWRhdGVDU1JGVG9rZW4sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcHJvZHVjdElkLCBxdWFudGl0eSA9IDEgfSA9IHJlcS5ib2R5O1xuXG4gICAgLy8gVmFsaWRhdGlvblxuICAgIGlmICghcHJvZHVjdElkKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnTUlTU0lOR19QUk9EVUNUX0lEJyxcbiAgICAgICAgICBtZXNzYWdlOiAnUHJvZHVjdCBJRCBpcyByZXF1aXJlZCdcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gRW5oYW5jZWQgcXVhbnRpdHkgdmFsaWRhdGlvbiB0byBwcmV2ZW50IGludGVnZXIgb3ZlcmZsb3cgYW5kIG90aGVyIGVkZ2UgY2FzZXNcbiAgICBpZiAoIU51bWJlci5pc0ludGVnZXIocXVhbnRpdHkpIHx8IHF1YW50aXR5IDwgMSB8fCBxdWFudGl0eSA+IDk5KSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnSU5WQUxJRF9RVUFOVElUWScsXG4gICAgICAgICAgbWVzc2FnZTogJ1F1YW50aXR5IG11c3QgYmUgYmV0d2VlbiAxIGFuZCA5OSdcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQWRkaXRpb25hbCBzYWZldHkgY2hlY2sgZm9yIHBvdGVudGlhbCBpbnRlZ2VyIG92ZXJmbG93XG4gICAgaWYgKHF1YW50aXR5ID4gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdJTlZBTElEX1FVQU5USVRZJyxcbiAgICAgICAgICBtZXNzYWdlOiAnUXVhbnRpdHkgdmFsdWUgaXMgdG9vIGxhcmdlJ1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAgICAgLy8gVmFsaWRhdGUgcHJvZHVjdCBJRCBmb3JtYXRcbiAgICBpZiAoIXByb2R1Y3RJZC5tYXRjaCgvXlswLTlhLWZBLUZdezI0fSQvKSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0lOVkFMSURfUFJPRFVDVF9JRCcsXG4gICAgICAgICAgbWVzc2FnZTogJ0ludmFsaWQgcHJvZHVjdCBJRCBmb3JtYXQnXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIHByb2R1Y3QgZXhpc3RzIGFuZCBpcyBhY3RpdmVcbiAgICBjb25zdCBwcm9kdWN0ID0gYXdhaXQgUHJvZHVjdC5maW5kQnlJZChwcm9kdWN0SWQpO1xuICAgIGlmICghcHJvZHVjdCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ1BST0RVQ1RfTk9UX0ZPVU5EJyxcbiAgICAgICAgICBtZXNzYWdlOiAnUHJvZHVjdCBub3QgZm91bmQnXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICBpZiAoIXByb2R1Y3QuaXNBY3RpdmUpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdQUk9EVUNUX05PVF9GT1VORCcsXG4gICAgICAgICAgbWVzc2FnZTogJ1Byb2R1Y3Qgbm90IGZvdW5kIG9yIGluYWN0aXZlJ1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3IgZXhpc3RpbmcgaXRlbSBhbmQgdmFsaWRhdGUgbWF4aW11bSBxdWFudGl0eVxuICAgIGNvbnN0IHsgdHlwZSwgY2FydCwgdXNlciB9ID0gYXdhaXQgZ2V0T3JDcmVhdGVDYXJ0KHJlcSk7XG4gICAgXG4gICAgaWYgKHR5cGUgPT09ICd1c2VyJykge1xuICAgICAgY29uc3QgZXhpc3RpbmdJdGVtSW5kZXggPSB1c2VyLmNhcnQuaXRlbXMuZmluZEluZGV4KGl0ZW0gPT4gXG4gICAgICAgIGl0ZW0ucHJvZHVjdC50b1N0cmluZygpID09PSBwcm9kdWN0SWQudG9TdHJpbmcoKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgaWYgKGV4aXN0aW5nSXRlbUluZGV4ID49IDApIHtcbiAgICAgICAgY29uc3QgY3VycmVudFF1YW50aXR5ID0gdXNlci5jYXJ0Lml0ZW1zW2V4aXN0aW5nSXRlbUluZGV4XS5xdWFudGl0eTtcbiAgICAgICAgY29uc3QgbmV3UXVhbnRpdHkgPSBjdXJyZW50UXVhbnRpdHkgKyBxdWFudGl0eTtcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGZvciBpbnRlZ2VyIG92ZXJmbG93IGFuZCBtYXhpbXVtIHF1YW50aXR5XG4gICAgICAgIGlmIChuZXdRdWFudGl0eSA+IDk5IHx8IG5ld1F1YW50aXR5IDwgY3VycmVudFF1YW50aXR5KSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgICAgY29kZTogJ01BWF9RVUFOVElUWV9FWENFRURFRCcsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6ICdDYW5ub3QgZXhjZWVkIG1heGltdW0gcXVhbnRpdHkgb2YgOTknXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZXhpc3RpbmdJdGVtSW5kZXggPSBjYXJ0Lml0ZW1zLmZpbmRJbmRleChpdGVtID0+IFxuICAgICAgICBpdGVtLnByb2R1Y3QudG9TdHJpbmcoKSA9PT0gcHJvZHVjdElkLnRvU3RyaW5nKClcbiAgICAgICk7XG4gICAgICBcbiAgICAgIGlmIChleGlzdGluZ0l0ZW1JbmRleCA+PSAwKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRRdWFudGl0eSA9IGNhcnQuaXRlbXNbZXhpc3RpbmdJdGVtSW5kZXhdLnF1YW50aXR5O1xuICAgICAgICBjb25zdCBuZXdRdWFudGl0eSA9IGN1cnJlbnRRdWFudGl0eSArIHF1YW50aXR5O1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgZm9yIGludGVnZXIgb3ZlcmZsb3cgYW5kIG1heGltdW0gcXVhbnRpdHlcbiAgICAgICAgaWYgKG5ld1F1YW50aXR5ID4gOTkgfHwgbmV3UXVhbnRpdHkgPCBjdXJyZW50UXVhbnRpdHkpIHtcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgICBjb2RlOiAnTUFYX1FVQU5USVRZX0VYQ0VFREVEJyxcbiAgICAgICAgICAgICAgbWVzc2FnZTogJ0Nhbm5vdCBleGNlZWQgbWF4aW11bSBxdWFudGl0eSBvZiA5OSdcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFVzZSBvcHRpbWlzdGljIGNhcnQgc2VydmljZSB3aXRoIGZhbGxiYWNrXG4gICAgbGV0IHJlc3VsdDtcbiAgICB0cnkge1xuICAgICAgcmVzdWx0ID0gYXdhaXQgY2FydFNlcnZpY2UudXBkYXRlQ2FydE9wdGltaXN0aWNhbGx5KHJlcSwgJ2FkZCcsIHtcbiAgICAgICAgcHJvZHVjdElkLFxuICAgICAgICBxdWFudGl0eVxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoc2VydmljZUVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0NhcnQgc2VydmljZSBmYWlsZWQsIHVzaW5nIGZhbGxiYWNrOicsIHNlcnZpY2VFcnJvci5tZXNzYWdlKTtcbiAgICAgIC8vIEZhbGxiYWNrIHRvIG9yaWdpbmFsIGxvZ2ljIC0gbmVlZCB0byByZS1mZXRjaCBjYXJ0IHNpbmNlIHNlcnZpY2UgZmFpbGVkXG4gICAgICBjb25zdCBmYWxsYmFja0NhcnQgPSBhd2FpdCBnZXRPckNyZWF0ZUNhcnQocmVxKTtcbiAgICAgIFxuICAgICAgaWYgKGZhbGxiYWNrQ2FydC50eXBlID09PSAndXNlcicpIHtcbiAgICAgICAgLy8gQWRkIHRvIHVzZXIncyBjYXJ0XG4gICAgICAgIGNvbnN0IGV4aXN0aW5nSXRlbUluZGV4ID0gZmFsbGJhY2tDYXJ0LnVzZXIuY2FydC5pdGVtcy5maW5kSW5kZXgoaXRlbSA9PiBcbiAgICAgICAgICBpdGVtLnByb2R1Y3QudG9TdHJpbmcoKSA9PT0gcHJvZHVjdElkLnRvU3RyaW5nKClcbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoZXhpc3RpbmdJdGVtSW5kZXggPj0gMCkge1xuICAgICAgICAgIGZhbGxiYWNrQ2FydC51c2VyLmNhcnQuaXRlbXNbZXhpc3RpbmdJdGVtSW5kZXhdLnF1YW50aXR5ICs9IHF1YW50aXR5O1xuICAgICAgICAgIGZhbGxiYWNrQ2FydC51c2VyLmNhcnQuaXRlbXNbZXhpc3RpbmdJdGVtSW5kZXhdLmFkZGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZhbGxiYWNrQ2FydC51c2VyLmNhcnQuaXRlbXMucHVzaCh7XG4gICAgICAgICAgICBwcm9kdWN0OiBwcm9kdWN0SWQsXG4gICAgICAgICAgICBxdWFudGl0eSxcbiAgICAgICAgICAgIHByaWNlOiBwcm9kdWN0LnByaWNlLFxuICAgICAgICAgICAgYWRkZWRBdDogbmV3IERhdGUoKVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBmYWxsYmFja0NhcnQudXNlci5jYXJ0LnVwZGF0ZWRBdCA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGF3YWl0IGZhbGxiYWNrQ2FydC51c2VyLnNhdmUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEFkZCB0byBndWVzdCBjYXJ0IC0gdXNlIHRoZSBDYXJ0IG1vZGVsIG1ldGhvZFxuICAgICAgICBpZiAoZmFsbGJhY2tDYXJ0LmNhcnQuYWRkSXRlbSAmJiB0eXBlb2YgZmFsbGJhY2tDYXJ0LmNhcnQuYWRkSXRlbSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIGZhbGxiYWNrQ2FydC5jYXJ0LmFkZEl0ZW0ocHJvZHVjdElkLCBxdWFudGl0eSwgcHJvZHVjdC5wcmljZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gRmFsbGJhY2s6IG1hbnVhbGx5IGFkZCBpdGVtXG4gICAgICAgICAgY29uc3QgZXhpc3RpbmdJdGVtSW5kZXggPSBmYWxsYmFja0NhcnQuY2FydC5pdGVtcy5maW5kSW5kZXgoaXRlbSA9PiBcbiAgICAgICAgICAgIGl0ZW0ucHJvZHVjdC50b1N0cmluZygpID09PSBwcm9kdWN0SWQudG9TdHJpbmcoKVxuICAgICAgICAgICk7XG5cbiAgICAgICAgICBpZiAoZXhpc3RpbmdJdGVtSW5kZXggPj0gMCkge1xuICAgICAgICAgICAgZmFsbGJhY2tDYXJ0LmNhcnQuaXRlbXNbZXhpc3RpbmdJdGVtSW5kZXhdLnF1YW50aXR5ICs9IHF1YW50aXR5O1xuICAgICAgICAgICAgZmFsbGJhY2tDYXJ0LmNhcnQuaXRlbXNbZXhpc3RpbmdJdGVtSW5kZXhdLmFkZGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmYWxsYmFja0NhcnQuY2FydC5pdGVtcy5wdXNoKHtcbiAgICAgICAgICAgICAgcHJvZHVjdDogcHJvZHVjdElkLFxuICAgICAgICAgICAgICBxdWFudGl0eSxcbiAgICAgICAgICAgICAgcHJpY2U6IHByb2R1Y3QucHJpY2UsXG4gICAgICAgICAgICAgIGFkZGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBhd2FpdCBmYWxsYmFja0NhcnQuY2FydC5zYXZlKCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJlc3VsdCA9IHsgZHVyYXRpb246IDAsIHBlcmZvcm1hbmNlOiAnZmFsbGJhY2snIH07XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuIHVwZGF0ZWQgY2FydCB3aXRoIHBlcmZvcm1hbmNlIG1ldHJpY3NcbiAgICBsZXQgdXBkYXRlZENhcnREYXRhO1xuICAgIHRyeSB7XG4gICAgICB1cGRhdGVkQ2FydERhdGEgPSBhd2FpdCBjYXJ0U2VydmljZS5nZXRDYXJ0V2l0aFBlcmZvcm1hbmNlT3B0aW1pemF0aW9uKHJlcSk7XG4gICAgfSBjYXRjaCAoc2VydmljZUVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0NhcnQgc2VydmljZSBmYWlsZWQgYWZ0ZXIgYWRkLCB1c2luZyBmYWxsYmFjazonLCBzZXJ2aWNlRXJyb3IubWVzc2FnZSk7XG4gICAgICB1cGRhdGVkQ2FydERhdGEgPSBhd2FpdCBnZXRPckNyZWF0ZUNhcnQocmVxKTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgcG9wdWxhdGVkQ2FydCA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgdXBkYXRlZENhcnREYXRhLmNhcnQuaXRlbXMubWFwKGFzeW5jIChpdGVtKSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2QgPSBhd2FpdCBQcm9kdWN0LmZpbmRCeUlkKGl0ZW0ucHJvZHVjdCkuc2VsZWN0KCctd2hvbGVzYWxlcicpO1xuICAgICAgICBpZiAoIXByb2QpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDsgLy8gRmlsdGVyIG91dCBtaXNzaW5nIHByb2R1Y3RzXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBfaWQ6IGl0ZW0ucHJvZHVjdCxcbiAgICAgICAgICBwcm9kdWN0OiBwcm9kLnRvUHVibGljSlNPTigpLFxuICAgICAgICAgIHF1YW50aXR5OiBpdGVtLnF1YW50aXR5LFxuICAgICAgICAgIHByaWNlOiBpdGVtLnByaWNlLFxuICAgICAgICAgIHN1YnRvdGFsOiBpdGVtLnByaWNlICogaXRlbS5xdWFudGl0eVxuICAgICAgICB9O1xuICAgICAgfSlcbiAgICApLnRoZW4oaXRlbXMgPT4gaXRlbXMuZmlsdGVyKGl0ZW0gPT4gaXRlbSAhPT0gbnVsbCkpO1xuXG4gICAgY29uc3QgaXRlbUNvdW50ID0gcG9wdWxhdGVkQ2FydC5yZWR1Y2UoKHRvdGFsLCBpdGVtKSA9PiB0b3RhbCArIGl0ZW0ucXVhbnRpdHksIDApO1xuICAgIGNvbnN0IHN1YnRvdGFsID0gcG9wdWxhdGVkQ2FydC5yZWR1Y2UoKHRvdGFsLCBpdGVtKSA9PiB0b3RhbCArIGl0ZW0uc3VidG90YWwsIDApO1xuXG4gICAgcmVzLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdJdGVtIGFkZGVkIHRvIGNhcnQnLFxuICAgICAgZGF0YToge1xuICAgICAgICBjYXJ0OiB7XG4gICAgICAgICAgaXRlbXM6IHBvcHVsYXRlZENhcnQsXG4gICAgICAgICAgaXRlbUNvdW50LFxuICAgICAgICAgIHN1YnRvdGFsOiBNYXRoLnJvdW5kKHN1YnRvdGFsICogMTAwKSAvIDEwMCxcbiAgICAgICAgICB0b3RhbDogTWF0aC5yb3VuZChzdWJ0b3RhbCAqIDEwMCkgLyAxMDBcbiAgICAgICAgfSxcbiAgICAgICAgcGVyZm9ybWFuY2U6IHtcbiAgICAgICAgICBkdXJhdGlvbjogcmVzdWx0LmR1cmF0aW9uLFxuICAgICAgICAgIHN0YXR1czogcmVzdWx0LnBlcmZvcm1hbmNlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFkZGluZyB0byBjYXJ0OicsIGVycm9yKTtcbiAgICBjb25zb2xlLmVycm9yKCdGdWxsIHN0YWNrOicsIGVycm9yLnN0YWNrKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdDQVJUX0FERF9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gYWRkIGl0ZW0gdG8gY2FydCcsXG4gICAgICAgIGRldGFpbHM6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gZXJyb3IubWVzc2FnZSA6IHVuZGVmaW5lZCxcbiAgICAgICAgc3RhY2s6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gZXJyb3Iuc3RhY2sgOiB1bmRlZmluZWRcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSk7XG5cbi8vIFVwZGF0ZSBjYXJ0IGl0ZW0gcXVhbnRpdHlcbnJvdXRlci5wdXQoJy91cGRhdGUnLCBhdXRoZW50aWNhdGVUb2tlbiwgdmFsaWRhdGVDU1JGVG9rZW4sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcHJvZHVjdElkLCBxdWFudGl0eSB9ID0gcmVxLmJvZHk7XG5cbiAgICAvLyBWYWxpZGF0aW9uXG4gICAgaWYgKCFwcm9kdWN0SWQpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdNSVNTSU5HX1BST0RVQ1RfSUQnLFxuICAgICAgICAgIG1lc3NhZ2U6ICdQcm9kdWN0IElEIGlzIHJlcXVpcmVkJ1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoIU51bWJlci5pc0ludGVnZXIocXVhbnRpdHkpIHx8IHF1YW50aXR5IDwgMCB8fCBxdWFudGl0eSA+IDk5KSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnSU5WQUxJRF9RVUFOVElUWScsXG4gICAgICAgICAgbWVzc2FnZTogJ1F1YW50aXR5IG11c3QgYmUgYmV0d2VlbiAwIGFuZCA5OSdcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgeyB0eXBlLCBjYXJ0LCB1c2VyIH0gPSBhd2FpdCBnZXRPckNyZWF0ZUNhcnQocmVxKTtcblxuICAgIGlmICh0eXBlID09PSAndXNlcicpIHtcbiAgICAgIC8vIFVwZGF0ZSB1c2VyJ3MgY2FydFxuICAgICAgY29uc3QgaXRlbUluZGV4ID0gdXNlci5jYXJ0Lml0ZW1zLmZpbmRJbmRleChpdGVtID0+IFxuICAgICAgICBpdGVtLnByb2R1Y3QudG9TdHJpbmcoKSA9PT0gcHJvZHVjdElkLnRvU3RyaW5nKClcbiAgICAgICk7XG5cbiAgICAgIGlmIChpdGVtSW5kZXggPj0gMCkge1xuICAgICAgICBpZiAocXVhbnRpdHkgPT09IDApIHtcbiAgICAgICAgICB1c2VyLmNhcnQuaXRlbXMuc3BsaWNlKGl0ZW1JbmRleCwgMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdXNlci5jYXJ0Lml0ZW1zW2l0ZW1JbmRleF0ucXVhbnRpdHkgPSBxdWFudGl0eTtcbiAgICAgICAgICB1c2VyLmNhcnQuaXRlbXNbaXRlbUluZGV4XS5hZGRlZEF0ID0gbmV3IERhdGUoKTtcbiAgICAgICAgfVxuICAgICAgICB1c2VyLmNhcnQudXBkYXRlZEF0ID0gbmV3IERhdGUoKTtcbiAgICAgICAgYXdhaXQgdXNlci5zYXZlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICBjb2RlOiAnSVRFTV9OT1RfRk9VTkQnLFxuICAgICAgICAgICAgbWVzc2FnZTogJ0l0ZW0gbm90IGZvdW5kIGluIGNhcnQnXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gVXBkYXRlIGd1ZXN0IGNhcnRcbiAgICAgIGNvbnN0IGl0ZW1JbmRleCA9IGNhcnQuaXRlbXMuZmluZEluZGV4KGl0ZW0gPT4gXG4gICAgICAgIGl0ZW0ucHJvZHVjdC50b1N0cmluZygpID09PSBwcm9kdWN0SWQudG9TdHJpbmcoKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgaWYgKGl0ZW1JbmRleCA+PSAwKSB7XG4gICAgICAgIGlmIChjYXJ0LnVwZGF0ZUl0ZW0gJiYgdHlwZW9mIGNhcnQudXBkYXRlSXRlbSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIGNhcnQudXBkYXRlSXRlbShwcm9kdWN0SWQsIHF1YW50aXR5KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBNYW51YWwgdXBkYXRlXG4gICAgICAgICAgaWYgKHF1YW50aXR5ID09PSAwKSB7XG4gICAgICAgICAgICBjYXJ0Lml0ZW1zLnNwbGljZShpdGVtSW5kZXgsIDEpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYXJ0Lml0ZW1zW2l0ZW1JbmRleF0ucXVhbnRpdHkgPSBxdWFudGl0eTtcbiAgICAgICAgICAgIGNhcnQuaXRlbXNbaXRlbUluZGV4XS5hZGRlZEF0ID0gbmV3IERhdGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FydC51cGRhdGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoY2FydC5zYXZlICYmIHR5cGVvZiBjYXJ0LnNhdmUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICBhd2FpdCBjYXJ0LnNhdmUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBVc2UgZmluZEJ5SWRBbmRVcGRhdGUgZm9yIGxlYW4gb2JqZWN0c1xuICAgICAgICAgIGF3YWl0IENhcnQuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICAgICAgICBjYXJ0Ll9pZCxcbiAgICAgICAgICAgIHsgaXRlbXM6IGNhcnQuaXRlbXMsIHVwZGF0ZWRBdDogY2FydC51cGRhdGVkQXQgfSxcbiAgICAgICAgICAgIHsgbmV3OiB0cnVlIH1cbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICBjb2RlOiAnSVRFTV9OT1RfRk9VTkQnLFxuICAgICAgICAgICAgbWVzc2FnZTogJ0l0ZW0gbm90IGZvdW5kIGluIGNhcnQnXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gdXBkYXRlZCBjYXJ0XG4gICAgY29uc3QgdXBkYXRlZENhcnREYXRhID0gYXdhaXQgZ2V0T3JDcmVhdGVDYXJ0KHJlcSk7XG4gICAgY29uc3QgcG9wdWxhdGVkQ2FydCA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgdXBkYXRlZENhcnREYXRhLmNhcnQuaXRlbXMubWFwKGFzeW5jIChpdGVtKSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0LmZpbmRCeUlkKGl0ZW0ucHJvZHVjdCkuc2VsZWN0KCctd2hvbGVzYWxlcicpO1xuICAgICAgICBpZiAoIXByb2R1Y3QgfHwgIXByb2R1Y3QuaXNBY3RpdmUpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBfaWQ6IGl0ZW0ucHJvZHVjdCxcbiAgICAgICAgICBwcm9kdWN0OiBwcm9kdWN0LnRvUHVibGljSlNPTigpLFxuICAgICAgICAgIHF1YW50aXR5OiBpdGVtLnF1YW50aXR5LFxuICAgICAgICAgIHByaWNlOiBpdGVtLnByaWNlLFxuICAgICAgICAgIHN1YnRvdGFsOiBpdGVtLnByaWNlICogaXRlbS5xdWFudGl0eVxuICAgICAgICB9O1xuICAgICAgfSlcbiAgICApO1xuXG4gICAgY29uc3QgdmFsaWRDYXJ0SXRlbXMgPSBwb3B1bGF0ZWRDYXJ0LmZpbHRlcihpdGVtID0+IGl0ZW0gIT09IG51bGwpO1xuICAgIGNvbnN0IGl0ZW1Db3VudCA9IHZhbGlkQ2FydEl0ZW1zLnJlZHVjZSgodG90YWwsIGl0ZW0pID0+IHRvdGFsICsgaXRlbS5xdWFudGl0eSwgMCk7XG4gICAgY29uc3Qgc3VidG90YWwgPSB2YWxpZENhcnRJdGVtcy5yZWR1Y2UoKHRvdGFsLCBpdGVtKSA9PiB0b3RhbCArIGl0ZW0uc3VidG90YWwsIDApO1xuXG4gICAgLy8gQ2hlY2sgaWYgaXRlbSB3YXMgcmVtb3ZlZCAocXVhbnRpdHkgd2FzIDApXG4gICAgY29uc3Qgd2FzUmVtb3ZlZCA9IHF1YW50aXR5ID09PSAwO1xuICAgIFxuICAgIHJlcy5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiB3YXNSZW1vdmVkID8gJ0l0ZW0gcmVtb3ZlZCBmcm9tIGNhcnQnIDogJ0NhcnQgdXBkYXRlZCcsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIGNhcnQ6IHtcbiAgICAgICAgICBpdGVtczogdmFsaWRDYXJ0SXRlbXMsXG4gICAgICAgICAgaXRlbUNvdW50LFxuICAgICAgICAgIHN1YnRvdGFsOiBNYXRoLnJvdW5kKHN1YnRvdGFsICogMTAwKSAvIDEwMCxcbiAgICAgICAgICB0b3RhbDogTWF0aC5yb3VuZChzdWJ0b3RhbCAqIDEwMCkgLyAxMDBcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGNhcnRJdGVtQ291bnQ6IGl0ZW1Db3VudFxuICAgIH0pO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FydDonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnQ0FSVF9VUERBVEVfRVJST1InLFxuICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIHVwZGF0ZSBjYXJ0J1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KTtcblxuLy8gUmVtb3ZlIGl0ZW0gZnJvbSBjYXJ0XG5yb3V0ZXIuZGVsZXRlKCcvcmVtb3ZlJywgYXV0aGVudGljYXRlVG9rZW4sIHZhbGlkYXRlQ1NSRlRva2VuLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IHByb2R1Y3RJZCB9ID0gcmVxLmJvZHk7XG5cbiAgICBpZiAoIXByb2R1Y3RJZCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ01JU1NJTkdfUFJPRFVDVF9JRCcsXG4gICAgICAgICAgbWVzc2FnZTogJ1Byb2R1Y3QgSUQgaXMgcmVxdWlyZWQnXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHsgdHlwZSwgY2FydCwgdXNlciB9ID0gYXdhaXQgZ2V0T3JDcmVhdGVDYXJ0KHJlcSk7XG5cbiAgICBpZiAodHlwZSA9PT0gJ3VzZXInKSB7XG4gICAgICAvLyBSZW1vdmUgZnJvbSB1c2VyJ3MgY2FydFxuICAgICAgY29uc3QgaXRlbUluZGV4ID0gdXNlci5jYXJ0Lml0ZW1zLmZpbmRJbmRleChpdGVtID0+IFxuICAgICAgICBpdGVtLnByb2R1Y3QudG9TdHJpbmcoKSA9PT0gcHJvZHVjdElkLnRvU3RyaW5nKClcbiAgICAgICk7XG5cbiAgICAgIGlmIChpdGVtSW5kZXggPj0gMCkge1xuICAgICAgICB1c2VyLmNhcnQuaXRlbXMuc3BsaWNlKGl0ZW1JbmRleCwgMSk7XG4gICAgICAgIHVzZXIuY2FydC51cGRhdGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgIGNvZGU6ICdJVEVNX05PVF9GT1VORCcsXG4gICAgICAgICAgICBtZXNzYWdlOiAnSXRlbSBub3QgZm91bmQgaW4gY2FydCdcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBSZW1vdmUgZnJvbSBndWVzdCBjYXJ0XG4gICAgICBjb25zdCBpdGVtSW5kZXggPSBjYXJ0Lml0ZW1zLmZpbmRJbmRleChpdGVtID0+IFxuICAgICAgICBpdGVtLnByb2R1Y3QudG9TdHJpbmcoKSA9PT0gcHJvZHVjdElkLnRvU3RyaW5nKClcbiAgICAgICk7XG4gICAgICBcbiAgICAgIGlmIChpdGVtSW5kZXggPj0gMCkge1xuICAgICAgICBpZiAoY2FydC5yZW1vdmVJdGVtICYmIHR5cGVvZiBjYXJ0LnJlbW92ZUl0ZW0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICBjYXJ0LnJlbW92ZUl0ZW0ocHJvZHVjdElkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBNYW51YWwgcmVtb3ZhbFxuICAgICAgICAgIGNhcnQuaXRlbXMuc3BsaWNlKGl0ZW1JbmRleCwgMSk7XG4gICAgICAgICAgY2FydC51cGRhdGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoY2FydC5zYXZlICYmIHR5cGVvZiBjYXJ0LnNhdmUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICBhd2FpdCBjYXJ0LnNhdmUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBVc2UgZmluZEJ5SWRBbmRVcGRhdGUgZm9yIGxlYW4gb2JqZWN0c1xuICAgICAgICAgIGF3YWl0IENhcnQuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICAgICAgICBjYXJ0Ll9pZCxcbiAgICAgICAgICAgIHsgaXRlbXM6IGNhcnQuaXRlbXMsIHVwZGF0ZWRBdDogY2FydC51cGRhdGVkQXQgfSxcbiAgICAgICAgICAgIHsgbmV3OiB0cnVlIH1cbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICBjb2RlOiAnSVRFTV9OT1RfRk9VTkQnLFxuICAgICAgICAgICAgbWVzc2FnZTogJ0l0ZW0gbm90IGZvdW5kIGluIGNhcnQnXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gdXBkYXRlZCBjYXJ0XG4gICAgY29uc3QgdXBkYXRlZENhcnREYXRhID0gYXdhaXQgZ2V0T3JDcmVhdGVDYXJ0KHJlcSk7XG4gICAgY29uc3QgcG9wdWxhdGVkQ2FydCA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgdXBkYXRlZENhcnREYXRhLmNhcnQuaXRlbXMubWFwKGFzeW5jIChpdGVtKSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0LmZpbmRCeUlkKGl0ZW0ucHJvZHVjdCkuc2VsZWN0KCctd2hvbGVzYWxlcicpO1xuICAgICAgICBpZiAoIXByb2R1Y3QgfHwgIXByb2R1Y3QuaXNBY3RpdmUpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBfaWQ6IGl0ZW0ucHJvZHVjdCxcbiAgICAgICAgICBwcm9kdWN0OiBwcm9kdWN0LnRvUHVibGljSlNPTigpLFxuICAgICAgICAgIHF1YW50aXR5OiBpdGVtLnF1YW50aXR5LFxuICAgICAgICAgIHByaWNlOiBpdGVtLnByaWNlLFxuICAgICAgICAgIHN1YnRvdGFsOiBpdGVtLnByaWNlICogaXRlbS5xdWFudGl0eVxuICAgICAgICB9O1xuICAgICAgfSlcbiAgICApO1xuXG4gICAgY29uc3QgdmFsaWRDYXJ0SXRlbXMgPSBwb3B1bGF0ZWRDYXJ0LmZpbHRlcihpdGVtID0+IGl0ZW0gIT09IG51bGwpO1xuICAgIGNvbnN0IGl0ZW1Db3VudCA9IHZhbGlkQ2FydEl0ZW1zLnJlZHVjZSgodG90YWwsIGl0ZW0pID0+IHRvdGFsICsgaXRlbS5xdWFudGl0eSwgMCk7XG4gICAgY29uc3Qgc3VidG90YWwgPSB2YWxpZENhcnRJdGVtcy5yZWR1Y2UoKHRvdGFsLCBpdGVtKSA9PiB0b3RhbCArIGl0ZW0uc3VidG90YWwsIDApO1xuXG4gICAgcmVzLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdJdGVtIHJlbW92ZWQgZnJvbSBjYXJ0JyxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgY2FydDoge1xuICAgICAgICAgIGl0ZW1zOiB2YWxpZENhcnRJdGVtcyxcbiAgICAgICAgICBpdGVtQ291bnQsXG4gICAgICAgICAgc3VidG90YWw6IE1hdGgucm91bmQoc3VidG90YWwgKiAxMDApIC8gMTAwLFxuICAgICAgICAgIHRvdGFsOiBNYXRoLnJvdW5kKHN1YnRvdGFsICogMTAwKSAvIDEwMFxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgY2FydEl0ZW1Db3VudDogaXRlbUNvdW50XG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZW1vdmluZyBmcm9tIGNhcnQ6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ0NBUlRfUkVNT1ZFX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogJ0ZhaWxlZCB0byByZW1vdmUgaXRlbSBmcm9tIGNhcnQnXG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vLyBDbGVhciBjYXJ0XG5yb3V0ZXIuZGVsZXRlKCcvY2xlYXInLCBhdXRoZW50aWNhdGVUb2tlbiwgdmFsaWRhdGVDU1JGVG9rZW4sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgdHlwZSwgY2FydCwgdXNlciB9ID0gYXdhaXQgZ2V0T3JDcmVhdGVDYXJ0KHJlcSk7XG5cbiAgICBpZiAodHlwZSA9PT0gJ3VzZXInKSB7XG4gICAgICAvLyBDbGVhciB1c2VyJ3MgY2FydFxuICAgICAgdXNlci5jYXJ0Lml0ZW1zID0gW107XG4gICAgICB1c2VyLmNhcnQudXBkYXRlZEF0ID0gbmV3IERhdGUoKTtcbiAgICAgIGF3YWl0IHVzZXIuc2F2ZSgpO1xuICAgICAgY29uc29sZS5sb2coJ0NsZWFyZWQgdXNlciBjYXJ0IGZvciB1c2VyOicsIHVzZXIuX2lkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gQ2xlYXIgZ3Vlc3QgY2FydCAtIGJlIG1vcmUgYWdncmVzc2l2ZVxuICAgICAgY29uc29sZS5sb2coJ0NsZWFyaW5nIGd1ZXN0IGNhcnQgZm9yIHNlc3Npb246JywgY2FydC5zZXNzaW9uSWQpO1xuICAgICAgXG4gICAgICAvLyBEZWxldGUgdGhlIGVudGlyZSBjYXJ0IHJlY29yZCBhbmQgY3JlYXRlIGEgbmV3IG9uZVxuICAgICAgYXdhaXQgQ2FydC5kZWxldGVPbmUoeyBzZXNzaW9uSWQ6IGNhcnQuc2Vzc2lvbklkIH0pO1xuICAgICAgXG4gICAgICAvLyBDcmVhdGUgYSBmcmVzaCBjYXJ0XG4gICAgICBjb25zdCBuZXdDYXJ0ID0gbmV3IENhcnQoeyBzZXNzaW9uSWQ6IGNhcnQuc2Vzc2lvbklkLCBpdGVtczogW10gfSk7XG4gICAgICBhd2FpdCBuZXdDYXJ0LnNhdmUoKTtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ0NyZWF0ZWQgZnJlc2ggZ3Vlc3QgY2FydCBmb3Igc2Vzc2lvbjonLCBjYXJ0LnNlc3Npb25JZCk7XG4gICAgfVxuXG4gICAgcmVzLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdDYXJ0IGNsZWFyZWQnLFxuICAgICAgZGF0YToge1xuICAgICAgICBjYXJ0OiB7XG4gICAgICAgICAgaXRlbXM6IFtdLFxuICAgICAgICAgIGl0ZW1Db3VudDogMCxcbiAgICAgICAgICBzdWJ0b3RhbDogMCxcbiAgICAgICAgICB0b3RhbDogMCxcbiAgICAgICAgICBpc0VtcHR5OiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBjYXJ0SXRlbUNvdW50OiAwXG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjbGVhcmluZyBjYXJ0OicsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdDQVJUX0NMRUFSX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogJ0ZhaWxlZCB0byBjbGVhciBjYXJ0J1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KTtcblxuLy8gTWVyZ2UgZ3Vlc3QgY2FydCB3aXRoIHVzZXIgY2FydCB3aXRoIGNvbmZsaWN0IHJlc29sdXRpb25cbnJvdXRlci5wb3N0KCcvbWVyZ2UnLCBhdXRoZW50aWNhdGVUb2tlbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgaWYgKCFyZXEudXNlcikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0FVVEhFTlRJQ0FUSU9OX1JFUVVJUkVEJyxcbiAgICAgICAgICBtZXNzYWdlOiAnVXNlciBtdXN0IGJlIGF1dGhlbnRpY2F0ZWQgdG8gbWVyZ2UgY2FydCdcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgeyBndWVzdENhcnRJdGVtcywgc2Vzc2lvbklkIH0gPSByZXEuYm9keTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygnQ2FydCBtZXJnZSByZXF1ZXN0OicsIHsgXG4gICAgICB1c2VySWQ6IHJlcS51c2VyLl9pZCwgXG4gICAgICBzZXNzaW9uSWQsIFxuICAgICAgZ3Vlc3RJdGVtQ291bnQ6IGd1ZXN0Q2FydEl0ZW1zPy5sZW5ndGggfHwgMCBcbiAgICB9KTtcbiAgICBcbiAgICAvLyBVc2UgZW5oYW5jZWQgY2FydCBzZXJ2aWNlIGZvciBtZXJnaW5nIHdpdGggY29uZmxpY3QgcmVzb2x1dGlvblxuICAgIGxldCBtZXJnZVJlc3VsdDtcbiAgICB0cnkge1xuICAgICAgbWVyZ2VSZXN1bHQgPSBhd2FpdCBjYXJ0U2VydmljZS5tZXJnZUNhcnRzV2l0aENvbmZsaWN0UmVzb2x1dGlvbihcbiAgICAgICAgcmVxLnVzZXIuX2lkLFxuICAgICAgICBndWVzdENhcnRJdGVtcyxcbiAgICAgICAgc2Vzc2lvbklkXG4gICAgICApO1xuICAgIH0gY2F0Y2ggKHNlcnZpY2VFcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdDYXJ0IHNlcnZpY2UgbWVyZ2UgZmFpbGVkLCB1c2luZyBmYWxsYmFjazonLCBzZXJ2aWNlRXJyb3IubWVzc2FnZSk7XG4gICAgICAvLyBGYWxsYmFjayB0byBvcmlnaW5hbCBtZXJnZSBsb2dpY1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWQocmVxLnVzZXIuX2lkKTtcbiAgICAgIGlmICghdXNlci5jYXJ0KSB7XG4gICAgICAgIHVzZXIuY2FydCA9IHsgaXRlbXM6IFtdLCB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkgfTtcbiAgICAgIH1cblxuICAgICAgbGV0IG1lcmdlZEl0ZW1zID0gMDtcblxuICAgICAgLy8gUHJvY2VzcyBndWVzdCBjYXJ0IGl0ZW1zXG4gICAgICBpZiAoZ3Vlc3RDYXJ0SXRlbXMgJiYgQXJyYXkuaXNBcnJheShndWVzdENhcnRJdGVtcykgJiYgZ3Vlc3RDYXJ0SXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgICBmb3IgKGNvbnN0IGd1ZXN0SXRlbSBvZiBndWVzdENhcnRJdGVtcykge1xuICAgICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0LmZpbmRCeUlkKGd1ZXN0SXRlbS5wcm9kdWN0SWQgfHwgZ3Vlc3RJdGVtLnByb2R1Y3QpO1xuICAgICAgICAgIGlmICghcHJvZHVjdCB8fCAhcHJvZHVjdC5pc0FjdGl2ZSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgcHJvZHVjdElkID0gZ3Vlc3RJdGVtLnByb2R1Y3RJZCB8fCBndWVzdEl0ZW0ucHJvZHVjdDtcbiAgICAgICAgICBjb25zdCBxdWFudGl0eSA9IGd1ZXN0SXRlbS5xdWFudGl0eSB8fCAxO1xuXG4gICAgICAgICAgY29uc3QgZXhpc3RpbmdJdGVtSW5kZXggPSB1c2VyLmNhcnQuaXRlbXMuZmluZEluZGV4KGl0ZW0gPT4gXG4gICAgICAgICAgICBpdGVtLnByb2R1Y3QudG9TdHJpbmcoKSA9PT0gcHJvZHVjdElkLnRvU3RyaW5nKClcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgaWYgKGV4aXN0aW5nSXRlbUluZGV4ID49IDApIHtcbiAgICAgICAgICAgIHVzZXIuY2FydC5pdGVtc1tleGlzdGluZ0l0ZW1JbmRleF0ucXVhbnRpdHkgKz0gcXVhbnRpdHk7XG4gICAgICAgICAgICB1c2VyLmNhcnQuaXRlbXNbZXhpc3RpbmdJdGVtSW5kZXhdLmFkZGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB1c2VyLmNhcnQuaXRlbXMucHVzaCh7XG4gICAgICAgICAgICAgIHByb2R1Y3Q6IHByb2R1Y3RJZCxcbiAgICAgICAgICAgICAgcXVhbnRpdHksXG4gICAgICAgICAgICAgIHByaWNlOiBwcm9kdWN0LnByaWNlLFxuICAgICAgICAgICAgICBhZGRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVyZ2VkSXRlbXMrKztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBQcm9jZXNzIHNlc3Npb24tYmFzZWQgY2FydFxuICAgICAgaWYgKHNlc3Npb25JZCkge1xuICAgICAgICBjb25zdCBndWVzdENhcnQgPSBhd2FpdCBDYXJ0LmZpbmRPbmUoeyBzZXNzaW9uSWQgfSk7XG4gICAgICAgIGlmIChndWVzdENhcnQgJiYgZ3Vlc3RDYXJ0Lml0ZW1zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnRm91bmQgZ3Vlc3QgY2FydCB3aXRoJywgZ3Vlc3RDYXJ0Lml0ZW1zLmxlbmd0aCwgJ2l0ZW1zIGZvciBzZXNzaW9uOicsIHNlc3Npb25JZCk7XG4gICAgICAgICAgXG4gICAgICAgICAgZm9yIChjb25zdCBndWVzdEl0ZW0gb2YgZ3Vlc3RDYXJ0Lml0ZW1zKSB7XG4gICAgICAgICAgICBjb25zdCBwcm9kdWN0ID0gYXdhaXQgUHJvZHVjdC5maW5kQnlJZChndWVzdEl0ZW0ucHJvZHVjdCk7XG4gICAgICAgICAgICBpZiAoIXByb2R1Y3QgfHwgIXByb2R1Y3QuaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nSXRlbUluZGV4ID0gdXNlci5jYXJ0Lml0ZW1zLmZpbmRJbmRleChpdGVtID0+IFxuICAgICAgICAgICAgICBpdGVtLnByb2R1Y3QudG9TdHJpbmcoKSA9PT0gZ3Vlc3RJdGVtLnByb2R1Y3QudG9TdHJpbmcoKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgaWYgKGV4aXN0aW5nSXRlbUluZGV4ID49IDApIHtcbiAgICAgICAgICAgICAgdXNlci5jYXJ0Lml0ZW1zW2V4aXN0aW5nSXRlbUluZGV4XS5xdWFudGl0eSArPSBndWVzdEl0ZW0ucXVhbnRpdHk7XG4gICAgICAgICAgICAgIHVzZXIuY2FydC5pdGVtc1tleGlzdGluZ0l0ZW1JbmRleF0uYWRkZWRBdCA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB1c2VyLmNhcnQuaXRlbXMucHVzaCh7XG4gICAgICAgICAgICAgICAgcHJvZHVjdDogZ3Vlc3RJdGVtLnByb2R1Y3QsXG4gICAgICAgICAgICAgICAgcXVhbnRpdHk6IGd1ZXN0SXRlbS5xdWFudGl0eSxcbiAgICAgICAgICAgICAgICBwcmljZTogZ3Vlc3RJdGVtLnByaWNlLFxuICAgICAgICAgICAgICAgIGFkZGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtZXJnZWRJdGVtcysrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICAvLyBDbGVhbiB1cCB0aGUgZ3Vlc3QgY2FydCBhZnRlciBtZXJnZVxuICAgICAgICAgIGF3YWl0IENhcnQuZGVsZXRlT25lKHsgc2Vzc2lvbklkIH0pO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdEZWxldGVkIGd1ZXN0IGNhcnQgZm9yIHNlc3Npb246Jywgc2Vzc2lvbklkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnTm8gZ3Vlc3QgY2FydCBmb3VuZCBmb3Igc2Vzc2lvbjonLCBzZXNzaW9uSWQpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHVzZXIuY2FydC51cGRhdGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgYXdhaXQgdXNlci5zYXZlKCk7XG4gICAgICBcbiAgICAgIG1lcmdlUmVzdWx0ID0ge1xuICAgICAgICBtZXJnZWRJdGVtcyxcbiAgICAgICAgY29uZmxpY3RzOiBbXSxcbiAgICAgICAgZHVyYXRpb246IDBcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gR2V0IHVwZGF0ZWQgY2FydCBkYXRhIHdpdGggZmFsbGJhY2tcbiAgICBsZXQgdXBkYXRlZENhcnREYXRhO1xuICAgIHRyeSB7XG4gICAgICB1cGRhdGVkQ2FydERhdGEgPSBhd2FpdCBjYXJ0U2VydmljZS5nZXRDYXJ0V2l0aFBlcmZvcm1hbmNlT3B0aW1pemF0aW9uKHJlcSk7XG4gICAgfSBjYXRjaCAoc2VydmljZUVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0NhcnQgc2VydmljZSBmYWlsZWQgaW4gbWVyZ2UsIHVzaW5nIGZhbGxiYWNrOicsIHNlcnZpY2VFcnJvci5tZXNzYWdlKTtcbiAgICAgIHVwZGF0ZWRDYXJ0RGF0YSA9IGF3YWl0IGdldE9yQ3JlYXRlQ2FydChyZXEpO1xuICAgIH1cbiAgICBcbiAgICAvLyBSZXR1cm4gdXBkYXRlZCB1c2VyIGNhcnRcbiAgICBjb25zdCBwb3B1bGF0ZWRDYXJ0ID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICB1cGRhdGVkQ2FydERhdGEuY2FydC5pdGVtcy5tYXAoYXN5bmMgKGl0ZW0pID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBwcm9kdWN0ID0gYXdhaXQgUHJvZHVjdC5maW5kQnlJZChpdGVtLnByb2R1Y3QpLnNlbGVjdCgnLXdob2xlc2FsZXInKTtcbiAgICAgICAgICBpZiAoIXByb2R1Y3QgfHwgIXByb2R1Y3QuaXNBY3RpdmUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsOyAvLyBGaWx0ZXIgb3V0IGluYWN0aXZlIHByb2R1Y3RzXG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBfaWQ6IGl0ZW0ucHJvZHVjdCxcbiAgICAgICAgICAgIHByb2R1Y3Q6IHByb2R1Y3QudG9QdWJsaWNKU09OKCksXG4gICAgICAgICAgICBxdWFudGl0eTogaXRlbS5xdWFudGl0eSxcbiAgICAgICAgICAgIHByaWNlOiBpdGVtLnByaWNlLFxuICAgICAgICAgICAgc3VidG90YWw6IGl0ZW0ucHJpY2UgKiBpdGVtLnF1YW50aXR5XG4gICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwb3B1bGF0aW5nIGNhcnQgaXRlbTonLCBlcnJvcik7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgKTtcblxuICAgIC8vIEZpbHRlciBvdXQgbnVsbCBpdGVtcyAoaW5hY3RpdmUgcHJvZHVjdHMpXG4gICAgY29uc3QgdmFsaWRDYXJ0SXRlbXMgPSBwb3B1bGF0ZWRDYXJ0LmZpbHRlcihpdGVtID0+IGl0ZW0gIT09IG51bGwpO1xuICAgIGNvbnN0IGl0ZW1Db3VudCA9IHZhbGlkQ2FydEl0ZW1zLnJlZHVjZSgodG90YWwsIGl0ZW0pID0+IHRvdGFsICsgaXRlbS5xdWFudGl0eSwgMCk7XG4gICAgY29uc3Qgc3VidG90YWwgPSB2YWxpZENhcnRJdGVtcy5yZWR1Y2UoKHRvdGFsLCBpdGVtKSA9PiB0b3RhbCArIGl0ZW0uc3VidG90YWwsIDApO1xuXG4gICAgcmVzLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6IGBTdWNjZXNzZnVsbHkgbWVyZ2VkICR7bWVyZ2VSZXN1bHQubWVyZ2VkSXRlbXN9IGl0ZW1zIGludG8geW91ciBjYXJ0YCxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgY2FydDoge1xuICAgICAgICAgIGl0ZW1zOiB2YWxpZENhcnRJdGVtcyxcbiAgICAgICAgICBpdGVtQ291bnQsXG4gICAgICAgICAgc3VidG90YWw6IE1hdGgucm91bmQoc3VidG90YWwgKiAxMDApIC8gMTAwLFxuICAgICAgICAgIHRvdGFsOiBNYXRoLnJvdW5kKHN1YnRvdGFsICogMTAwKSAvIDEwMCxcbiAgICAgICAgICBpc0VtcHR5OiB2YWxpZENhcnRJdGVtcy5sZW5ndGggPT09IDBcbiAgICAgICAgfSxcbiAgICAgICAgbWVyZ2U6IHtcbiAgICAgICAgICBtZXJnZWRJdGVtczogbWVyZ2VSZXN1bHQubWVyZ2VkSXRlbXMsXG4gICAgICAgICAgY29uZmxpY3RzOiBtZXJnZVJlc3VsdC5jb25mbGljdHMsXG4gICAgICAgICAgZHVyYXRpb246IG1lcmdlUmVzdWx0LmR1cmF0aW9uXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIG1lcmdpbmcgZ3Vlc3QgY2FydDonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnQ0FSVF9NRVJHRV9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gbWVyZ2UgZ3Vlc3QgY2FydCcsXG4gICAgICAgIGRldGFpbHM6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gZXJyb3IubWVzc2FnZSA6IHVuZGVmaW5lZFxuICAgICAgfVxuICAgIH0pO1xuICB9XG59KTtcblxuLy8gUmVzZXQgZ3Vlc3QgY2FydCBzZXNzaW9uIC0gaGVscHMgZml4IGNhcnQgcGVyc2lzdGVuY2UgaXNzdWVzXG5yb3V0ZXIucG9zdCgnL3Jlc2V0LWd1ZXN0LXNlc3Npb24nLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICAvLyBPbmx5IGFsbG93IHRoaXMgZm9yIG5vbi1hdXRoZW50aWNhdGVkIHVzZXJzIChndWVzdHMpXG4gICAgaWYgKHJlcS51c2VyKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnTk9UX0dVRVNUX1VTRVInLFxuICAgICAgICAgIG1lc3NhZ2U6ICdUaGlzIGVuZHBvaW50IGlzIG9ubHkgZm9yIGd1ZXN0IHVzZXJzJ1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBDbGVhciBjdXJyZW50IHNlc3Npb24gY2FydCBkYXRhXG4gICAgaWYgKHJlcS5zZXNzaW9uKSB7XG4gICAgICBjb25zdCBvbGRTZXNzaW9uSWQgPSByZXEuc2Vzc2lvbi5jYXJ0SWQ7XG4gICAgICBcbiAgICAgIC8vIERlbGV0ZSBvbGQgZ3Vlc3QgY2FydCBpZiBpdCBleGlzdHNcbiAgICAgIGlmIChvbGRTZXNzaW9uSWQgJiYgb2xkU2Vzc2lvbklkLnN0YXJ0c1dpdGgoJ2d1ZXN0XycpKSB7XG4gICAgICAgIGNvbnN0IGRlbGV0ZVJlc3VsdCA9IGF3YWl0IENhcnQuZGVsZXRlTWFueSh7IHNlc3Npb25JZDogb2xkU2Vzc2lvbklkIH0pO1xuICAgICAgICBjb25zb2xlLmxvZyhgRGVsZXRlZCAke2RlbGV0ZVJlc3VsdC5kZWxldGVkQ291bnR9IGd1ZXN0IGNhcnQocykgZm9yIG9sZCBzZXNzaW9uICR7b2xkU2Vzc2lvbklkfWApO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBDbGVhciBzZXNzaW9uIGNhcnQgZGF0YVxuICAgICAgZGVsZXRlIHJlcS5zZXNzaW9uLmNhcnRJZDtcbiAgICAgIGRlbGV0ZSByZXEuc2Vzc2lvbi5ndWVzdElkO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBhIGZyZXNoIGd1ZXN0IHNlc3Npb24gSURcbiAgICBjb25zdCBuZXdTZXNzaW9uSWQgPSBgZ3Vlc3RfJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gO1xuICAgIFxuICAgIGlmIChyZXEuc2Vzc2lvbikge1xuICAgICAgcmVxLnNlc3Npb24uY2FydElkID0gbmV3U2Vzc2lvbklkO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBhIGZyZXNoIGVtcHR5IGNhcnRcbiAgICBjb25zdCBuZXdDYXJ0ID0gbmV3IENhcnQoeyBzZXNzaW9uSWQ6IG5ld1Nlc3Npb25JZCwgaXRlbXM6IFtdIH0pO1xuICAgIGF3YWl0IG5ld0NhcnQuc2F2ZSgpO1xuXG4gICAgcmVzLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdHdWVzdCBjYXJ0IHNlc3Npb24gcmVzZXQgc3VjY2Vzc2Z1bGx5JyxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgc2Vzc2lvbklkOiBuZXdTZXNzaW9uSWQsXG4gICAgICAgIGNhcnQ6IHtcbiAgICAgICAgICBpdGVtczogW10sXG4gICAgICAgICAgaXRlbUNvdW50OiAwLFxuICAgICAgICAgIHN1YnRvdGFsOiAwLFxuICAgICAgICAgIHRvdGFsOiAwLFxuICAgICAgICAgIGlzRW1wdHk6IHRydWVcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVzZXR0aW5nIGd1ZXN0IGNhcnQgc2Vzc2lvbjonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnUkVTRVRfU0VTU0lPTl9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gcmVzZXQgZ3Vlc3QgY2FydCBzZXNzaW9uJ1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KTtcblxuLy8gRGVidWcgZW5kcG9pbnQgdG8gc2VlIGFsbCBndWVzdCBjYXJ0cyAoZGV2ZWxvcG1lbnQgb25seSlcbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50Jykge1xuICByb3V0ZXIuZ2V0KCcvZGVidWcnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZ3Vlc3RDYXJ0cyA9IGF3YWl0IENhcnQuZmluZCh7fSkuc2VsZWN0KCdzZXNzaW9uSWQgaXRlbXMgY3JlYXRlZEF0IHVwZGF0ZWRBdCcpO1xuICAgICAgY29uc3QgdXNlckNhcnRzID0gYXdhaXQgVXNlci5maW5kKHsgJ2NhcnQuaXRlbXMuMCc6IHsgJGV4aXN0czogdHJ1ZSB9IH0pXG4gICAgICAgIC5zZWxlY3QoJ2VtYWlsIGNhcnQuaXRlbXMgY2FydC51cGRhdGVkQXQnKTtcbiAgICAgIFxuICAgICAgcmVzLmpzb24oe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgZ3Vlc3RDYXJ0czogZ3Vlc3RDYXJ0cy5tYXAoY2FydCA9PiAoe1xuICAgICAgICAgICAgc2Vzc2lvbklkOiBjYXJ0LnNlc3Npb25JZCxcbiAgICAgICAgICAgIGl0ZW1Db3VudDogY2FydC5pdGVtcy5sZW5ndGgsXG4gICAgICAgICAgICBpdGVtczogY2FydC5pdGVtcyxcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogY2FydC5jcmVhdGVkQXQsXG4gICAgICAgICAgICB1cGRhdGVkQXQ6IGNhcnQudXBkYXRlZEF0XG4gICAgICAgICAgfSkpLFxuICAgICAgICAgIHVzZXJDYXJ0czogdXNlckNhcnRzLm1hcCh1c2VyID0+ICh7XG4gICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICAgIGl0ZW1Db3VudDogdXNlci5jYXJ0Py5pdGVtcz8ubGVuZ3RoIHx8IDAsXG4gICAgICAgICAgICBpdGVtczogdXNlci5jYXJ0Py5pdGVtcyB8fCBbXSxcbiAgICAgICAgICAgIHVwZGF0ZWRBdDogdXNlci5jYXJ0Py51cGRhdGVkQXRcbiAgICAgICAgICB9KSksXG4gICAgICAgICAgY3VycmVudFNlc3Npb246IHtcbiAgICAgICAgICAgIGd1ZXN0U2Vzc2lvbklkOiByZXEuaGVhZGVyc1sneC1ndWVzdC1zZXNzaW9uLWlkJ10sXG4gICAgICAgICAgICBzZXJ2ZXJTZXNzaW9uSWQ6IHJlcS5zZXNzaW9uSURcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcbiAgICB9XG4gIH0pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNQyxNQUFNLEdBQUdGLE9BQU8sQ0FBQ0csTUFBTSxDQUFDLENBQUM7QUFDL0IsTUFBTUMsT0FBTyxHQUFHSCxPQUFPLENBQUMsbUJBQW1CLENBQUM7QUFDNUMsTUFBTUksSUFBSSxHQUFHSixPQUFPLENBQUMsZ0JBQWdCLENBQUM7QUFDdEMsTUFBTUssSUFBSSxHQUFHTCxPQUFPLENBQUMsZ0JBQWdCLENBQUM7QUFDdEMsTUFBTTtFQUFFTTtBQUFrQixDQUFDLEdBQUdOLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQztBQUMzRCxNQUFNO0VBQUVPO0FBQWtCLENBQUMsR0FBR1AsT0FBTyxDQUFDLDJCQUEyQixDQUFDO0FBQ2xFLE1BQU1RLFdBQVcsR0FBR1IsT0FBTyxDQUFDLHlCQUF5QixDQUFDOztBQUV0RDtBQUNBLE1BQU1TLGVBQWUsR0FBRyxNQUFPQyxHQUFHLElBQUs7RUFDckMsSUFBSUEsR0FBRyxDQUFDQyxJQUFJLEVBQUU7SUFDWjtJQUNBLE1BQU1BLElBQUksR0FBRyxNQUFNUCxJQUFJLENBQUNRLFFBQVEsQ0FBQ0YsR0FBRyxDQUFDQyxJQUFJLENBQUNFLEdBQUcsQ0FBQztJQUM5QyxJQUFJLENBQUNGLElBQUksQ0FBQ0csSUFBSSxFQUFFO01BQ2RILElBQUksQ0FBQ0csSUFBSSxHQUFHO1FBQUVDLEtBQUssRUFBRSxFQUFFO1FBQUVDLFNBQVMsRUFBRSxJQUFJQyxJQUFJLENBQUM7TUFBRSxDQUFDO01BQ2hELE1BQU1OLElBQUksQ0FBQ08sSUFBSSxDQUFDLENBQUM7SUFDbkI7SUFDQSxPQUFPO01BQUVDLElBQUksRUFBRSxNQUFNO01BQUVMLElBQUksRUFBRUgsSUFBSSxDQUFDRyxJQUFJO01BQUVIO0lBQUssQ0FBQztF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