e9cec42015c309554d4282b434911f5f
const {
  logger
} = require('../utils/logger');
const {
  getErrorMessage
} = require('../utils/i18n');

// Custom error class for application errors
class AppError extends Error {
  constructor(message, statusCode, code = null, isOperational = true) {
    super(message);
    this.statusCode = statusCode;
    this.code = code;
    this.isOperational = isOperational;
    this.status = `${statusCode}`.startsWith('4') ? 'fail' : 'error';
    this.defaultMessage = message; // Store original message

    Error.captureStackTrace(this, this.constructor);
  }
}

// Error handling for different error types
const handleCastErrorDB = err => {
  const message = `Invalid ${err.path}: ${err.value}`;
  return new AppError(message, 400, 'INVALID_ID');
};
const handleDuplicateFieldsDB = err => {
  const value = err.errmsg.match(/(["'])(\\?.)*?\1/)[0];
  const message = `Duplicate field value: ${value}. Please use another value!`;
  return new AppError(message, 400, 'DUPLICATE_FIELD');
};
const handleValidationErrorDB = err => {
  const errors = Object.values(err.errors).map(el => el.message);
  const message = `Invalid input data. ${errors.join('. ')}`;
  return new AppError(message, 400, 'VALIDATION_ERROR');
};
const handleJWTError = () => new AppError('Invalid token. Please log in again!', 401, 'INVALID_TOKEN');
const handleJWTExpiredError = () => new AppError('Your token has expired! Please log in again.', 401, 'TOKEN_EXPIRED');

// Send error response in development
const sendErrorDev = (err, req, res) => {
  // Log error details
  logger.error('Error in development:', {
    error: err.message,
    stack: err.stack,
    url: req.originalUrl,
    method: req.method,
    ip: req.ip,
    userAgent: req.get('User-Agent')
  });

  // Get locale from request
  const locale = req.locale || req.headers['x-locale'] || 'en';

  // Get translated message if code is provided
  let translatedMessage = err.message;
  if (err.code) {
    translatedMessage = getErrorMessage(err.code, locale, err.defaultMessage || err.message);
  }
  return res.status(err.statusCode).json({
    success: false,
    error: {
      code: err.code,
      message: translatedMessage,
      originalMessage: err.message,
      // Show original message in dev
      locale: locale,
      // Show which locale was used
      stack: err.stack,
      details: err
    }
  });
};

// Send error response in production
const sendErrorProd = (err, req, res) => {
  // Log error details
  logger.error('Production error:', {
    error: err.message,
    code: err.code,
    url: req.originalUrl,
    method: req.method,
    ip: req.ip,
    statusCode: err.statusCode
  });

  // Get locale from request
  const locale = req.locale || req.headers['x-locale'] || 'en';

  // Operational, trusted error: send message to client
  if (err.isOperational) {
    // Try to get translated message if code is provided
    let message = err.message;
    if (err.code) {
      message = getErrorMessage(err.code, locale, err.defaultMessage || err.message);
    }
    return res.status(err.statusCode).json({
      success: false,
      error: {
        code: err.code,
        message: message
      }
    });
  }

  // Programming or other unknown error: don't leak error details
  logger.error('Unknown error:', {
    error: err,
    stack: err.stack
  });

  // Get translated message for internal error
  const internalErrorMessage = getErrorMessage('INTERNAL_ERROR', locale, 'Something went wrong!');
  return res.status(500).json({
    success: false,
    error: {
      code: 'INTERNAL_ERROR',
      message: internalErrorMessage
    }
  });
};

// Global error handling middleware
const globalErrorHandler = (err, req, res, next) => {
  err.statusCode = err.statusCode || 500;
  err.status = err.status || 'error';
  if (process.env.NODE_ENV === 'development') {
    sendErrorDev(err, req, res);
  } else {
    let error = {
      ...err
    };
    error.message = err.message;

    // Handle specific error types
    if (error.name === 'CastError') error = handleCastErrorDB(error);
    if (error.code === 11000) error = handleDuplicateFieldsDB(error);
    if (error.name === 'ValidationError') error = handleValidationErrorDB(error);
    if (error.name === 'JsonWebTokenError') error = handleJWTError();
    if (error.name === 'TokenExpiredError') error = handleJWTExpiredError();
    sendErrorProd(error, req, res);
  }
};

// Async error wrapper
const catchAsync = fn => {
  return (req, res, next) => {
    fn(req, res, next).catch(next);
  };
};

// Handle unhandled promise rejections
process.on('unhandledRejection', (err, promise) => {
  logger.error('Unhandled Promise Rejection:', {
    error: err.message,
    stack: err.stack,
    promise: promise
  });

  // Close server gracefully
  process.exit(1);
});

// Handle uncaught exceptions
process.on('uncaughtException', err => {
  logger.error('Uncaught Exception:', {
    error: err.message,
    stack: err.stack
  });

  // Close server gracefully
  process.exit(1);
});
module.exports = {
  AppError,
  globalErrorHandler,
  catchAsync
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJsb2dnZXIiLCJyZXF1aXJlIiwiZ2V0RXJyb3JNZXNzYWdlIiwiQXBwRXJyb3IiLCJFcnJvciIsImNvbnN0cnVjdG9yIiwibWVzc2FnZSIsInN0YXR1c0NvZGUiLCJjb2RlIiwiaXNPcGVyYXRpb25hbCIsInN0YXR1cyIsInN0YXJ0c1dpdGgiLCJkZWZhdWx0TWVzc2FnZSIsImNhcHR1cmVTdGFja1RyYWNlIiwiaGFuZGxlQ2FzdEVycm9yREIiLCJlcnIiLCJwYXRoIiwidmFsdWUiLCJoYW5kbGVEdXBsaWNhdGVGaWVsZHNEQiIsImVycm1zZyIsIm1hdGNoIiwiaGFuZGxlVmFsaWRhdGlvbkVycm9yREIiLCJlcnJvcnMiLCJPYmplY3QiLCJ2YWx1ZXMiLCJtYXAiLCJlbCIsImpvaW4iLCJoYW5kbGVKV1RFcnJvciIsImhhbmRsZUpXVEV4cGlyZWRFcnJvciIsInNlbmRFcnJvckRldiIsInJlcSIsInJlcyIsImVycm9yIiwic3RhY2siLCJ1cmwiLCJvcmlnaW5hbFVybCIsIm1ldGhvZCIsImlwIiwidXNlckFnZW50IiwiZ2V0IiwibG9jYWxlIiwiaGVhZGVycyIsInRyYW5zbGF0ZWRNZXNzYWdlIiwianNvbiIsInN1Y2Nlc3MiLCJvcmlnaW5hbE1lc3NhZ2UiLCJkZXRhaWxzIiwic2VuZEVycm9yUHJvZCIsImludGVybmFsRXJyb3JNZXNzYWdlIiwiZ2xvYmFsRXJyb3JIYW5kbGVyIiwibmV4dCIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsIm5hbWUiLCJjYXRjaEFzeW5jIiwiZm4iLCJjYXRjaCIsIm9uIiwicHJvbWlzZSIsImV4aXQiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiZXJyb3JIYW5kbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgbG9nZ2VyIH0gPSByZXF1aXJlKCcuLi91dGlscy9sb2dnZXInKTtcbmNvbnN0IHsgZ2V0RXJyb3JNZXNzYWdlIH0gPSByZXF1aXJlKCcuLi91dGlscy9pMThuJyk7XG5cbi8vIEN1c3RvbSBlcnJvciBjbGFzcyBmb3IgYXBwbGljYXRpb24gZXJyb3JzXG5jbGFzcyBBcHBFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSwgc3RhdHVzQ29kZSwgY29kZSA9IG51bGwsIGlzT3BlcmF0aW9uYWwgPSB0cnVlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5zdGF0dXNDb2RlID0gc3RhdHVzQ29kZTtcbiAgICB0aGlzLmNvZGUgPSBjb2RlO1xuICAgIHRoaXMuaXNPcGVyYXRpb25hbCA9IGlzT3BlcmF0aW9uYWw7XG4gICAgdGhpcy5zdGF0dXMgPSBgJHtzdGF0dXNDb2RlfWAuc3RhcnRzV2l0aCgnNCcpID8gJ2ZhaWwnIDogJ2Vycm9yJztcbiAgICB0aGlzLmRlZmF1bHRNZXNzYWdlID0gbWVzc2FnZTsgLy8gU3RvcmUgb3JpZ2luYWwgbWVzc2FnZVxuXG4gICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgdGhpcy5jb25zdHJ1Y3Rvcik7XG4gIH1cbn1cblxuLy8gRXJyb3IgaGFuZGxpbmcgZm9yIGRpZmZlcmVudCBlcnJvciB0eXBlc1xuY29uc3QgaGFuZGxlQ2FzdEVycm9yREIgPSAoZXJyKSA9PiB7XG4gIGNvbnN0IG1lc3NhZ2UgPSBgSW52YWxpZCAke2Vyci5wYXRofTogJHtlcnIudmFsdWV9YDtcbiAgcmV0dXJuIG5ldyBBcHBFcnJvcihtZXNzYWdlLCA0MDAsICdJTlZBTElEX0lEJyk7XG59O1xuXG5jb25zdCBoYW5kbGVEdXBsaWNhdGVGaWVsZHNEQiA9IChlcnIpID0+IHtcbiAgY29uc3QgdmFsdWUgPSBlcnIuZXJybXNnLm1hdGNoKC8oW1wiJ10pKFxcXFw/LikqP1xcMS8pWzBdO1xuICBjb25zdCBtZXNzYWdlID0gYER1cGxpY2F0ZSBmaWVsZCB2YWx1ZTogJHt2YWx1ZX0uIFBsZWFzZSB1c2UgYW5vdGhlciB2YWx1ZSFgO1xuICByZXR1cm4gbmV3IEFwcEVycm9yKG1lc3NhZ2UsIDQwMCwgJ0RVUExJQ0FURV9GSUVMRCcpO1xufTtcblxuY29uc3QgaGFuZGxlVmFsaWRhdGlvbkVycm9yREIgPSAoZXJyKSA9PiB7XG4gIGNvbnN0IGVycm9ycyA9IE9iamVjdC52YWx1ZXMoZXJyLmVycm9ycykubWFwKGVsID0+IGVsLm1lc3NhZ2UpO1xuICBjb25zdCBtZXNzYWdlID0gYEludmFsaWQgaW5wdXQgZGF0YS4gJHtlcnJvcnMuam9pbignLiAnKX1gO1xuICByZXR1cm4gbmV3IEFwcEVycm9yKG1lc3NhZ2UsIDQwMCwgJ1ZBTElEQVRJT05fRVJST1InKTtcbn07XG5cbmNvbnN0IGhhbmRsZUpXVEVycm9yID0gKCkgPT5cbiAgbmV3IEFwcEVycm9yKCdJbnZhbGlkIHRva2VuLiBQbGVhc2UgbG9nIGluIGFnYWluIScsIDQwMSwgJ0lOVkFMSURfVE9LRU4nKTtcblxuY29uc3QgaGFuZGxlSldURXhwaXJlZEVycm9yID0gKCkgPT5cbiAgbmV3IEFwcEVycm9yKCdZb3VyIHRva2VuIGhhcyBleHBpcmVkISBQbGVhc2UgbG9nIGluIGFnYWluLicsIDQwMSwgJ1RPS0VOX0VYUElSRUQnKTtcblxuLy8gU2VuZCBlcnJvciByZXNwb25zZSBpbiBkZXZlbG9wbWVudFxuY29uc3Qgc2VuZEVycm9yRGV2ID0gKGVyciwgcmVxLCByZXMpID0+IHtcbiAgLy8gTG9nIGVycm9yIGRldGFpbHNcbiAgbG9nZ2VyLmVycm9yKCdFcnJvciBpbiBkZXZlbG9wbWVudDonLCB7XG4gICAgZXJyb3I6IGVyci5tZXNzYWdlLFxuICAgIHN0YWNrOiBlcnIuc3RhY2ssXG4gICAgdXJsOiByZXEub3JpZ2luYWxVcmwsXG4gICAgbWV0aG9kOiByZXEubWV0aG9kLFxuICAgIGlwOiByZXEuaXAsXG4gICAgdXNlckFnZW50OiByZXEuZ2V0KCdVc2VyLUFnZW50JylcbiAgfSk7XG5cbiAgLy8gR2V0IGxvY2FsZSBmcm9tIHJlcXVlc3RcbiAgY29uc3QgbG9jYWxlID0gcmVxLmxvY2FsZSB8fCByZXEuaGVhZGVyc1sneC1sb2NhbGUnXSB8fCAnZW4nO1xuICBcbiAgLy8gR2V0IHRyYW5zbGF0ZWQgbWVzc2FnZSBpZiBjb2RlIGlzIHByb3ZpZGVkXG4gIGxldCB0cmFuc2xhdGVkTWVzc2FnZSA9IGVyci5tZXNzYWdlO1xuICBpZiAoZXJyLmNvZGUpIHtcbiAgICB0cmFuc2xhdGVkTWVzc2FnZSA9IGdldEVycm9yTWVzc2FnZShlcnIuY29kZSwgbG9jYWxlLCBlcnIuZGVmYXVsdE1lc3NhZ2UgfHwgZXJyLm1lc3NhZ2UpO1xuICB9XG5cbiAgcmV0dXJuIHJlcy5zdGF0dXMoZXJyLnN0YXR1c0NvZGUpLmpzb24oe1xuICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgIGVycm9yOiB7XG4gICAgICBjb2RlOiBlcnIuY29kZSxcbiAgICAgIG1lc3NhZ2U6IHRyYW5zbGF0ZWRNZXNzYWdlLFxuICAgICAgb3JpZ2luYWxNZXNzYWdlOiBlcnIubWVzc2FnZSwgLy8gU2hvdyBvcmlnaW5hbCBtZXNzYWdlIGluIGRldlxuICAgICAgbG9jYWxlOiBsb2NhbGUsIC8vIFNob3cgd2hpY2ggbG9jYWxlIHdhcyB1c2VkXG4gICAgICBzdGFjazogZXJyLnN0YWNrLFxuICAgICAgZGV0YWlsczogZXJyXG4gICAgfVxuICB9KTtcbn07XG5cbi8vIFNlbmQgZXJyb3IgcmVzcG9uc2UgaW4gcHJvZHVjdGlvblxuY29uc3Qgc2VuZEVycm9yUHJvZCA9IChlcnIsIHJlcSwgcmVzKSA9PiB7XG4gIC8vIExvZyBlcnJvciBkZXRhaWxzXG4gIGxvZ2dlci5lcnJvcignUHJvZHVjdGlvbiBlcnJvcjonLCB7XG4gICAgZXJyb3I6IGVyci5tZXNzYWdlLFxuICAgIGNvZGU6IGVyci5jb2RlLFxuICAgIHVybDogcmVxLm9yaWdpbmFsVXJsLFxuICAgIG1ldGhvZDogcmVxLm1ldGhvZCxcbiAgICBpcDogcmVxLmlwLFxuICAgIHN0YXR1c0NvZGU6IGVyci5zdGF0dXNDb2RlXG4gIH0pO1xuXG4gIC8vIEdldCBsb2NhbGUgZnJvbSByZXF1ZXN0XG4gIGNvbnN0IGxvY2FsZSA9IHJlcS5sb2NhbGUgfHwgcmVxLmhlYWRlcnNbJ3gtbG9jYWxlJ10gfHwgJ2VuJztcblxuICAvLyBPcGVyYXRpb25hbCwgdHJ1c3RlZCBlcnJvcjogc2VuZCBtZXNzYWdlIHRvIGNsaWVudFxuICBpZiAoZXJyLmlzT3BlcmF0aW9uYWwpIHtcbiAgICAvLyBUcnkgdG8gZ2V0IHRyYW5zbGF0ZWQgbWVzc2FnZSBpZiBjb2RlIGlzIHByb3ZpZGVkXG4gICAgbGV0IG1lc3NhZ2UgPSBlcnIubWVzc2FnZTtcbiAgICBpZiAoZXJyLmNvZGUpIHtcbiAgICAgIG1lc3NhZ2UgPSBnZXRFcnJvck1lc3NhZ2UoZXJyLmNvZGUsIGxvY2FsZSwgZXJyLmRlZmF1bHRNZXNzYWdlIHx8IGVyci5tZXNzYWdlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzLnN0YXR1cyhlcnIuc3RhdHVzQ29kZSkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6IGVyci5jb2RlLFxuICAgICAgICBtZXNzYWdlOiBtZXNzYWdlXG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvLyBQcm9ncmFtbWluZyBvciBvdGhlciB1bmtub3duIGVycm9yOiBkb24ndCBsZWFrIGVycm9yIGRldGFpbHNcbiAgbG9nZ2VyLmVycm9yKCdVbmtub3duIGVycm9yOicsIHtcbiAgICBlcnJvcjogZXJyLFxuICAgIHN0YWNrOiBlcnIuc3RhY2tcbiAgfSk7XG5cbiAgLy8gR2V0IHRyYW5zbGF0ZWQgbWVzc2FnZSBmb3IgaW50ZXJuYWwgZXJyb3JcbiAgY29uc3QgaW50ZXJuYWxFcnJvck1lc3NhZ2UgPSBnZXRFcnJvck1lc3NhZ2UoJ0lOVEVSTkFMX0VSUk9SJywgbG9jYWxlLCAnU29tZXRoaW5nIHdlbnQgd3JvbmchJyk7XG5cbiAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICBlcnJvcjoge1xuICAgICAgY29kZTogJ0lOVEVSTkFMX0VSUk9SJyxcbiAgICAgIG1lc3NhZ2U6IGludGVybmFsRXJyb3JNZXNzYWdlXG4gICAgfVxuICB9KTtcbn07XG5cbi8vIEdsb2JhbCBlcnJvciBoYW5kbGluZyBtaWRkbGV3YXJlXG5jb25zdCBnbG9iYWxFcnJvckhhbmRsZXIgPSAoZXJyLCByZXEsIHJlcywgbmV4dCkgPT4ge1xuICBlcnIuc3RhdHVzQ29kZSA9IGVyci5zdGF0dXNDb2RlIHx8IDUwMDtcbiAgZXJyLnN0YXR1cyA9IGVyci5zdGF0dXMgfHwgJ2Vycm9yJztcblxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgICBzZW5kRXJyb3JEZXYoZXJyLCByZXEsIHJlcyk7XG4gIH0gZWxzZSB7XG4gICAgbGV0IGVycm9yID0geyAuLi5lcnIgfTtcbiAgICBlcnJvci5tZXNzYWdlID0gZXJyLm1lc3NhZ2U7XG5cbiAgICAvLyBIYW5kbGUgc3BlY2lmaWMgZXJyb3IgdHlwZXNcbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0Nhc3RFcnJvcicpIGVycm9yID0gaGFuZGxlQ2FzdEVycm9yREIoZXJyb3IpO1xuICAgIGlmIChlcnJvci5jb2RlID09PSAxMTAwMCkgZXJyb3IgPSBoYW5kbGVEdXBsaWNhdGVGaWVsZHNEQihlcnJvcik7XG4gICAgaWYgKGVycm9yLm5hbWUgPT09ICdWYWxpZGF0aW9uRXJyb3InKSBlcnJvciA9IGhhbmRsZVZhbGlkYXRpb25FcnJvckRCKGVycm9yKTtcbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0pzb25XZWJUb2tlbkVycm9yJykgZXJyb3IgPSBoYW5kbGVKV1RFcnJvcigpO1xuICAgIGlmIChlcnJvci5uYW1lID09PSAnVG9rZW5FeHBpcmVkRXJyb3InKSBlcnJvciA9IGhhbmRsZUpXVEV4cGlyZWRFcnJvcigpO1xuXG4gICAgc2VuZEVycm9yUHJvZChlcnJvciwgcmVxLCByZXMpO1xuICB9XG59O1xuXG4vLyBBc3luYyBlcnJvciB3cmFwcGVyXG5jb25zdCBjYXRjaEFzeW5jID0gKGZuKSA9PiB7XG4gIHJldHVybiAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBmbihyZXEsIHJlcywgbmV4dCkuY2F0Y2gobmV4dCk7XG4gIH07XG59O1xuXG4vLyBIYW5kbGUgdW5oYW5kbGVkIHByb21pc2UgcmVqZWN0aW9uc1xucHJvY2Vzcy5vbigndW5oYW5kbGVkUmVqZWN0aW9uJywgKGVyciwgcHJvbWlzZSkgPT4ge1xuICBsb2dnZXIuZXJyb3IoJ1VuaGFuZGxlZCBQcm9taXNlIFJlamVjdGlvbjonLCB7XG4gICAgZXJyb3I6IGVyci5tZXNzYWdlLFxuICAgIHN0YWNrOiBlcnIuc3RhY2ssXG4gICAgcHJvbWlzZTogcHJvbWlzZVxuICB9KTtcbiAgXG4gIC8vIENsb3NlIHNlcnZlciBncmFjZWZ1bGx5XG4gIHByb2Nlc3MuZXhpdCgxKTtcbn0pO1xuXG4vLyBIYW5kbGUgdW5jYXVnaHQgZXhjZXB0aW9uc1xucHJvY2Vzcy5vbigndW5jYXVnaHRFeGNlcHRpb24nLCAoZXJyKSA9PiB7XG4gIGxvZ2dlci5lcnJvcignVW5jYXVnaHQgRXhjZXB0aW9uOicsIHtcbiAgICBlcnJvcjogZXJyLm1lc3NhZ2UsXG4gICAgc3RhY2s6IGVyci5zdGFja1xuICB9KTtcbiAgXG4gIC8vIENsb3NlIHNlcnZlciBncmFjZWZ1bGx5XG4gIHByb2Nlc3MuZXhpdCgxKTtcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgQXBwRXJyb3IsXG4gIGdsb2JhbEVycm9ySGFuZGxlcixcbiAgY2F0Y2hBc3luY1xufTsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU07RUFBRUE7QUFBTyxDQUFDLEdBQUdDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQztBQUM3QyxNQUFNO0VBQUVDO0FBQWdCLENBQUMsR0FBR0QsT0FBTyxDQUFDLGVBQWUsQ0FBQzs7QUFFcEQ7QUFDQSxNQUFNRSxRQUFRLFNBQVNDLEtBQUssQ0FBQztFQUMzQkMsV0FBV0EsQ0FBQ0MsT0FBTyxFQUFFQyxVQUFVLEVBQUVDLElBQUksR0FBRyxJQUFJLEVBQUVDLGFBQWEsR0FBRyxJQUFJLEVBQUU7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