fabb45357cdeda32c293ea591a6c4064
// Currency conversion utilities for multi-currency support

// Static exchange rates (relative to USD)
// In production, these would be fetched from an API
const STATIC_RATES = {
  USD: 1,
  EUR: 0.85,
  GBP: 0.73,
  CNY: 6.45,
  JPY: 110.0,
  SAR: 3.75,
  CAD: 1.25
};

// Map locales to currencies
const LOCALE_CURRENCY_MAP = {
  'en': 'USD',
  'es': 'EUR',
  'fr': 'EUR',
  'de': 'EUR',
  'zh': 'CNY',
  'ja': 'JPY',
  'ar': 'SAR'
};

// Currency symbols
const CURRENCY_SYMBOLS = {
  USD: '$',
  EUR: '€',
  GBP: '£',
  CNY: '¥',
  JPY: '¥',
  SAR: 'ر.س',
  CAD: 'C$'
};

/**
 * Convert price from one currency to another
 * @param {number} amount - The amount to convert
 * @param {string} fromCurrency - Source currency code
 * @param {string} toCurrency - Target currency code
 * @param {object} rates - Exchange rates object (optional, uses static rates if not provided)
 * @returns {number} Converted amount
 */
function convertPrice(amount, fromCurrency, toCurrency, rates = STATIC_RATES) {
  if (fromCurrency === toCurrency) {
    return amount;
  }

  // Convert to USD first (base currency)
  const usdAmount = amount / rates[fromCurrency];

  // Then convert to target currency
  const convertedAmount = usdAmount * rates[toCurrency];

  // Round to 2 decimal places for most currencies, 0 for JPY
  if (toCurrency === 'JPY') {
    return Math.round(convertedAmount);
  }
  return Math.round(convertedAmount * 100) / 100;
}

/**
 * Format price for display with proper currency symbol and locale formatting
 * @param {number} amount - The amount to format
 * @param {string} currency - Currency code
 * @param {string} locale - Locale code for formatting
 * @returns {string} Formatted price string
 */
function formatPrice(amount, currency, locale = 'en') {
  try {
    return new Intl.NumberFormat(locale, {
      style: 'currency',
      currency: currency,
      minimumFractionDigits: currency === 'JPY' ? 0 : 2,
      maximumFractionDigits: currency === 'JPY' ? 0 : 2
    }).format(amount);
  } catch (error) {
    // Fallback to simple formatting if Intl is not available
    const symbol = CURRENCY_SYMBOLS[currency] || currency;
    return `${symbol}${amount.toFixed(currency === 'JPY' ? 0 : 2)}`;
  }
}

/**
 * Get currency for a given locale
 * @param {string} locale - Locale code
 * @returns {string} Currency code
 */
function getCurrencyForLocale(locale) {
  return LOCALE_CURRENCY_MAP[locale] || 'USD';
}

/**
 * Get current exchange rates
 * @returns {object} Exchange rates object
 */
function getExchangeRates() {
  // In production, this would fetch from an API
  // For now, return static rates
  return STATIC_RATES;
}

/**
 * Calculate prices for all currencies given a base price
 * @param {number} basePrice - Price in base currency (USD)
 * @param {object} rates - Exchange rates object (optional)
 * @returns {object} Prices in all supported currencies
 */
function calculateAllPrices(basePrice, rates = STATIC_RATES) {
  const prices = {};
  Object.keys(rates).forEach(currency => {
    prices[currency] = convertPrice(basePrice, 'USD', currency, rates);
  });
  return prices;
}

/**
 * Get currency symbol
 * @param {string} currency - Currency code
 * @returns {string} Currency symbol
 */
function getCurrencySymbol(currency) {
  return CURRENCY_SYMBOLS[currency] || currency;
}
module.exports = {
  convertPrice,
  formatPrice,
  getCurrencyForLocale,
  getExchangeRates,
  calculateAllPrices,
  getCurrencySymbol,
  STATIC_RATES,
  LOCALE_CURRENCY_MAP,
  CURRENCY_SYMBOLS
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTVEFUSUNfUkFURVMiLCJVU0QiLCJFVVIiLCJHQlAiLCJDTlkiLCJKUFkiLCJTQVIiLCJDQUQiLCJMT0NBTEVfQ1VSUkVOQ1lfTUFQIiwiQ1VSUkVOQ1lfU1lNQk9MUyIsImNvbnZlcnRQcmljZSIsImFtb3VudCIsImZyb21DdXJyZW5jeSIsInRvQ3VycmVuY3kiLCJyYXRlcyIsInVzZEFtb3VudCIsImNvbnZlcnRlZEFtb3VudCIsIk1hdGgiLCJyb3VuZCIsImZvcm1hdFByaWNlIiwiY3VycmVuY3kiLCJsb2NhbGUiLCJJbnRsIiwiTnVtYmVyRm9ybWF0Iiwic3R5bGUiLCJtaW5pbXVtRnJhY3Rpb25EaWdpdHMiLCJtYXhpbXVtRnJhY3Rpb25EaWdpdHMiLCJmb3JtYXQiLCJlcnJvciIsInN5bWJvbCIsInRvRml4ZWQiLCJnZXRDdXJyZW5jeUZvckxvY2FsZSIsImdldEV4Y2hhbmdlUmF0ZXMiLCJjYWxjdWxhdGVBbGxQcmljZXMiLCJiYXNlUHJpY2UiLCJwcmljZXMiLCJPYmplY3QiLCJrZXlzIiwiZm9yRWFjaCIsImdldEN1cnJlbmN5U3ltYm9sIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImN1cnJlbmN5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEN1cnJlbmN5IGNvbnZlcnNpb24gdXRpbGl0aWVzIGZvciBtdWx0aS1jdXJyZW5jeSBzdXBwb3J0XG5cbi8vIFN0YXRpYyBleGNoYW5nZSByYXRlcyAocmVsYXRpdmUgdG8gVVNEKVxuLy8gSW4gcHJvZHVjdGlvbiwgdGhlc2Ugd291bGQgYmUgZmV0Y2hlZCBmcm9tIGFuIEFQSVxuY29uc3QgU1RBVElDX1JBVEVTID0ge1xuICBVU0Q6IDEsXG4gIEVVUjogMC44NSxcbiAgR0JQOiAwLjczLFxuICBDTlk6IDYuNDUsXG4gIEpQWTogMTEwLjAsXG4gIFNBUjogMy43NSxcbiAgQ0FEOiAxLjI1XG59O1xuXG4vLyBNYXAgbG9jYWxlcyB0byBjdXJyZW5jaWVzXG5jb25zdCBMT0NBTEVfQ1VSUkVOQ1lfTUFQID0ge1xuICAnZW4nOiAnVVNEJyxcbiAgJ2VzJzogJ0VVUicsXG4gICdmcic6ICdFVVInLFxuICAnZGUnOiAnRVVSJyxcbiAgJ3poJzogJ0NOWScsXG4gICdqYSc6ICdKUFknLFxuICAnYXInOiAnU0FSJ1xufTtcblxuLy8gQ3VycmVuY3kgc3ltYm9sc1xuY29uc3QgQ1VSUkVOQ1lfU1lNQk9MUyA9IHtcbiAgVVNEOiAnJCcsXG4gIEVVUjogJ+KCrCcsXG4gIEdCUDogJ8KjJyxcbiAgQ05ZOiAnwqUnLFxuICBKUFk6ICfCpScsXG4gIFNBUjogJ9ixLtizJyxcbiAgQ0FEOiAnQyQnXG59O1xuXG4vKipcbiAqIENvbnZlcnQgcHJpY2UgZnJvbSBvbmUgY3VycmVuY3kgdG8gYW5vdGhlclxuICogQHBhcmFtIHtudW1iZXJ9IGFtb3VudCAtIFRoZSBhbW91bnQgdG8gY29udmVydFxuICogQHBhcmFtIHtzdHJpbmd9IGZyb21DdXJyZW5jeSAtIFNvdXJjZSBjdXJyZW5jeSBjb2RlXG4gKiBAcGFyYW0ge3N0cmluZ30gdG9DdXJyZW5jeSAtIFRhcmdldCBjdXJyZW5jeSBjb2RlXG4gKiBAcGFyYW0ge29iamVjdH0gcmF0ZXMgLSBFeGNoYW5nZSByYXRlcyBvYmplY3QgKG9wdGlvbmFsLCB1c2VzIHN0YXRpYyByYXRlcyBpZiBub3QgcHJvdmlkZWQpXG4gKiBAcmV0dXJucyB7bnVtYmVyfSBDb252ZXJ0ZWQgYW1vdW50XG4gKi9cbmZ1bmN0aW9uIGNvbnZlcnRQcmljZShhbW91bnQsIGZyb21DdXJyZW5jeSwgdG9DdXJyZW5jeSwgcmF0ZXMgPSBTVEFUSUNfUkFURVMpIHtcbiAgaWYgKGZyb21DdXJyZW5jeSA9PT0gdG9DdXJyZW5jeSkge1xuICAgIHJldHVybiBhbW91bnQ7XG4gIH1cblxuICAvLyBDb252ZXJ0IHRvIFVTRCBmaXJzdCAoYmFzZSBjdXJyZW5jeSlcbiAgY29uc3QgdXNkQW1vdW50ID0gYW1vdW50IC8gcmF0ZXNbZnJvbUN1cnJlbmN5XTtcbiAgXG4gIC8vIFRoZW4gY29udmVydCB0byB0YXJnZXQgY3VycmVuY3lcbiAgY29uc3QgY29udmVydGVkQW1vdW50ID0gdXNkQW1vdW50ICogcmF0ZXNbdG9DdXJyZW5jeV07XG4gIFxuICAvLyBSb3VuZCB0byAyIGRlY2ltYWwgcGxhY2VzIGZvciBtb3N0IGN1cnJlbmNpZXMsIDAgZm9yIEpQWVxuICBpZiAodG9DdXJyZW5jeSA9PT0gJ0pQWScpIHtcbiAgICByZXR1cm4gTWF0aC5yb3VuZChjb252ZXJ0ZWRBbW91bnQpO1xuICB9XG4gIFxuICByZXR1cm4gTWF0aC5yb3VuZChjb252ZXJ0ZWRBbW91bnQgKiAxMDApIC8gMTAwO1xufVxuXG4vKipcbiAqIEZvcm1hdCBwcmljZSBmb3IgZGlzcGxheSB3aXRoIHByb3BlciBjdXJyZW5jeSBzeW1ib2wgYW5kIGxvY2FsZSBmb3JtYXR0aW5nXG4gKiBAcGFyYW0ge251bWJlcn0gYW1vdW50IC0gVGhlIGFtb3VudCB0byBmb3JtYXRcbiAqIEBwYXJhbSB7c3RyaW5nfSBjdXJyZW5jeSAtIEN1cnJlbmN5IGNvZGVcbiAqIEBwYXJhbSB7c3RyaW5nfSBsb2NhbGUgLSBMb2NhbGUgY29kZSBmb3IgZm9ybWF0dGluZ1xuICogQHJldHVybnMge3N0cmluZ30gRm9ybWF0dGVkIHByaWNlIHN0cmluZ1xuICovXG5mdW5jdGlvbiBmb3JtYXRQcmljZShhbW91bnQsIGN1cnJlbmN5LCBsb2NhbGUgPSAnZW4nKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIG5ldyBJbnRsLk51bWJlckZvcm1hdChsb2NhbGUsIHtcbiAgICAgIHN0eWxlOiAnY3VycmVuY3knLFxuICAgICAgY3VycmVuY3k6IGN1cnJlbmN5LFxuICAgICAgbWluaW11bUZyYWN0aW9uRGlnaXRzOiBjdXJyZW5jeSA9PT0gJ0pQWScgPyAwIDogMixcbiAgICAgIG1heGltdW1GcmFjdGlvbkRpZ2l0czogY3VycmVuY3kgPT09ICdKUFknID8gMCA6IDJcbiAgICB9KS5mb3JtYXQoYW1vdW50KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAvLyBGYWxsYmFjayB0byBzaW1wbGUgZm9ybWF0dGluZyBpZiBJbnRsIGlzIG5vdCBhdmFpbGFibGVcbiAgICBjb25zdCBzeW1ib2wgPSBDVVJSRU5DWV9TWU1CT0xTW2N1cnJlbmN5XSB8fCBjdXJyZW5jeTtcbiAgICByZXR1cm4gYCR7c3ltYm9sfSR7YW1vdW50LnRvRml4ZWQoY3VycmVuY3kgPT09ICdKUFknID8gMCA6IDIpfWA7XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgY3VycmVuY3kgZm9yIGEgZ2l2ZW4gbG9jYWxlXG4gKiBAcGFyYW0ge3N0cmluZ30gbG9jYWxlIC0gTG9jYWxlIGNvZGVcbiAqIEByZXR1cm5zIHtzdHJpbmd9IEN1cnJlbmN5IGNvZGVcbiAqL1xuZnVuY3Rpb24gZ2V0Q3VycmVuY3lGb3JMb2NhbGUobG9jYWxlKSB7XG4gIHJldHVybiBMT0NBTEVfQ1VSUkVOQ1lfTUFQW2xvY2FsZV0gfHwgJ1VTRCc7XG59XG5cbi8qKlxuICogR2V0IGN1cnJlbnQgZXhjaGFuZ2UgcmF0ZXNcbiAqIEByZXR1cm5zIHtvYmplY3R9IEV4Y2hhbmdlIHJhdGVzIG9iamVjdFxuICovXG5mdW5jdGlvbiBnZXRFeGNoYW5nZVJhdGVzKCkge1xuICAvLyBJbiBwcm9kdWN0aW9uLCB0aGlzIHdvdWxkIGZldGNoIGZyb20gYW4gQVBJXG4gIC8vIEZvciBub3csIHJldHVybiBzdGF0aWMgcmF0ZXNcbiAgcmV0dXJuIFNUQVRJQ19SQVRFUztcbn1cblxuLyoqXG4gKiBDYWxjdWxhdGUgcHJpY2VzIGZvciBhbGwgY3VycmVuY2llcyBnaXZlbiBhIGJhc2UgcHJpY2VcbiAqIEBwYXJhbSB7bnVtYmVyfSBiYXNlUHJpY2UgLSBQcmljZSBpbiBiYXNlIGN1cnJlbmN5IChVU0QpXG4gKiBAcGFyYW0ge29iamVjdH0gcmF0ZXMgLSBFeGNoYW5nZSByYXRlcyBvYmplY3QgKG9wdGlvbmFsKVxuICogQHJldHVybnMge29iamVjdH0gUHJpY2VzIGluIGFsbCBzdXBwb3J0ZWQgY3VycmVuY2llc1xuICovXG5mdW5jdGlvbiBjYWxjdWxhdGVBbGxQcmljZXMoYmFzZVByaWNlLCByYXRlcyA9IFNUQVRJQ19SQVRFUykge1xuICBjb25zdCBwcmljZXMgPSB7fTtcbiAgXG4gIE9iamVjdC5rZXlzKHJhdGVzKS5mb3JFYWNoKGN1cnJlbmN5ID0+IHtcbiAgICBwcmljZXNbY3VycmVuY3ldID0gY29udmVydFByaWNlKGJhc2VQcmljZSwgJ1VTRCcsIGN1cnJlbmN5LCByYXRlcyk7XG4gIH0pO1xuICBcbiAgcmV0dXJuIHByaWNlcztcbn1cblxuLyoqXG4gKiBHZXQgY3VycmVuY3kgc3ltYm9sXG4gKiBAcGFyYW0ge3N0cmluZ30gY3VycmVuY3kgLSBDdXJyZW5jeSBjb2RlXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBDdXJyZW5jeSBzeW1ib2xcbiAqL1xuZnVuY3Rpb24gZ2V0Q3VycmVuY3lTeW1ib2woY3VycmVuY3kpIHtcbiAgcmV0dXJuIENVUlJFTkNZX1NZTUJPTFNbY3VycmVuY3ldIHx8IGN1cnJlbmN5O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgY29udmVydFByaWNlLFxuICBmb3JtYXRQcmljZSxcbiAgZ2V0Q3VycmVuY3lGb3JMb2NhbGUsXG4gIGdldEV4Y2hhbmdlUmF0ZXMsXG4gIGNhbGN1bGF0ZUFsbFByaWNlcyxcbiAgZ2V0Q3VycmVuY3lTeW1ib2wsXG4gIFNUQVRJQ19SQVRFUyxcbiAgTE9DQUxFX0NVUlJFTkNZX01BUCxcbiAgQ1VSUkVOQ1lfU1lNQk9MU1xufTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQSxNQUFNQSxZQUFZLEdBQUc7RUFDbkJDLEdBQUcsRUFBRSxDQUFDO0VBQ05DLEdBQUcsRUFBRSxJQUFJO0VBQ1RDLEdBQUcsRUFBRSxJQUFJO0VBQ1RDLEdBQUcsRUFBRSxJQUFJO0VBQ1RDLEdBQUcsRUFBRSxLQUFLO0VBQ1ZDLEdBQUcsRUFBRSxJQUFJO0VBQ1RDLEdBQUcsRUFBRTtBQUNQLENBQUM7O0FBRUQ7QUFDQSxNQUFNQyxtQkFBbUIsR0FBRztFQUMxQixJQUFJLEVBQUUs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