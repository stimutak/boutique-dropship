efabb78fca4db1f0e6f6b28837697f3f
// Clear the global mock for emailService to test the actual implementation

// Mock nodemailer BEFORE importing emailService
_getJestObj().unmock('../../utils/emailService');
_getJestObj().mock('nodemailer');
function _getJestObj() {
  const {
    jest
  } = require("@jest/globals");
  _getJestObj = () => jest;
  return jest;
}
const nodemailer = require('nodemailer');

// Now require the email service after the mock is set up
const {
  sendOrderConfirmation,
  sendPaymentReceipt,
  sendOrderStatusUpdate,
  sendWelcomeEmail,
  sendPasswordResetEmail,
  sendWholesalerNotification,
  sendEmail,
  emailTemplates
} = require('../../utils/emailService');
describe('Email Service', () => {
  let mockTransporter;
  beforeEach(() => {
    mockTransporter = {
      sendMail: jest.fn()
    };
    nodemailer.createTransport = jest.fn().mockReturnValue(mockTransporter);

    // Set up environment variables for tests
    process.env.EMAIL_HOST = 'smtp.test.com';
    process.env.EMAIL_PORT = '587';
    process.env.EMAIL_USER = 'test@example.com';
    process.env.EMAIL_PASS = 'testpass';
  });
  afterEach(() => {
    jest.clearAllMocks();
  });
  describe('sendOrderConfirmation', () => {
    const mockOrderData = {
      orderNumber: 'ORD-123456',
      customerName: 'John Doe',
      items: [{
        productName: 'Crystal Healing Set',
        quantity: 2,
        price: 29.99
      }, {
        productName: 'Essential Oil Bundle',
        quantity: 1,
        price: 45.00
      }],
      total: 104.98,
      shippingAddress: {
        firstName: 'John',
        lastName: 'Doe',
        street: '123 Main St',
        city: 'Anytown',
        state: 'CA',
        zipCode: '12345',
        country: 'US'
      }
    };
    it('should send order confirmation email successfully', async () => {
      mockTransporter.sendMail.mockResolvedValue({
        messageId: 'test-message-id'
      });
      const result = await sendOrderConfirmation('customer@example.com', mockOrderData);
      expect(result.success).toBe(true);
      expect(result.messageId).toBe('test-message-id');
      expect(mockTransporter.sendMail).toHaveBeenCalledWith({
        from: 'test@example.com',
        to: 'customer@example.com',
        subject: 'Order Confirmation - ORD-123456',
        text: expect.stringContaining('Thank you for your order!'),
        html: expect.stringContaining('Order Confirmation')
      });
    });
    it('should handle email sending failure', async () => {
      const error = new Error('SMTP connection failed');
      mockTransporter.sendMail.mockRejectedValue(error);
      const result = await sendOrderConfirmation('customer@example.com', mockOrderData);
      expect(result.success).toBe(false);
      expect(result.error).toBe('SMTP connection failed');
    });
  });
  describe('sendPaymentReceipt', () => {
    const mockPaymentData = {
      orderNumber: 'ORD-123456',
      customerName: 'John Doe',
      total: 104.98,
      paymentMethod: 'Credit Card',
      transactionId: 'txn_123456789',
      paidAt: new Date('2023-12-01T10:00:00Z')
    };
    it('should send payment receipt email successfully', async () => {
      mockTransporter.sendMail.mockResolvedValue({
        messageId: 'test-message-id'
      });
      const result = await sendPaymentReceipt('customer@example.com', mockPaymentData);
      expect(result.success).toBe(true);
      expect(mockTransporter.sendMail).toHaveBeenCalledWith({
        from: 'test@example.com',
        to: 'customer@example.com',
        subject: 'Payment Receipt - ORD-123456',
        text: expect.stringContaining('Your payment has been successfully processed!'),
        html: expect.stringContaining('Payment Receipt')
      });
    });
  });
  describe('sendOrderStatusUpdate', () => {
    const mockStatusData = {
      orderNumber: 'ORD-123456',
      customerName: 'John Doe',
      status: 'shipped',
      trackingNumber: 'TRK123456789'
    };
    it('should send order status update email successfully', async () => {
      mockTransporter.sendMail.mockResolvedValue({
        messageId: 'test-message-id'
      });
      const result = await sendOrderStatusUpdate('customer@example.com', mockStatusData);
      expect(result.success).toBe(true);
      expect(mockTransporter.sendMail).toHaveBeenCalledWith({
        from: 'test@example.com',
        to: 'customer@example.com',
        subject: 'Order Update - ORD-123456',
        text: expect.stringContaining('Great news! Your order has been shipped.'),
        html: expect.stringContaining('Order Update')
      });
    });
    it('should handle different order statuses', async () => {
      mockTransporter.sendMail.mockResolvedValue({
        messageId: 'test-message-id'
      });
      const processingData = {
        ...mockStatusData,
        status: 'processing'
      };
      await sendOrderStatusUpdate('customer@example.com', processingData);
      expect(mockTransporter.sendMail).toHaveBeenCalledWith(expect.objectContaining({
        text: expect.stringContaining('Your order is being processed')
      }));
    });
  });
  describe('sendWelcomeEmail', () => {
    const mockUserData = {
      firstName: 'John',
      email: 'john@example.com'
    };
    it('should send welcome email successfully', async () => {
      mockTransporter.sendMail.mockResolvedValue({
        messageId: 'test-message-id'
      });
      const result = await sendWelcomeEmail('john@example.com', mockUserData);
      expect(result.success).toBe(true);
      expect(mockTransporter.sendMail).toHaveBeenCalledWith({
        from: 'test@example.com',
        to: 'john@example.com',
        subject: 'Welcome to Our Holistic Store!',
        text: expect.stringContaining('Welcome to our holistic wellness community!'),
        html: expect.stringContaining('Welcome to Our Holistic Store!')
      });
    });
  });
  describe('sendPasswordResetEmail', () => {
    const mockResetData = {
      firstName: 'John',
      resetToken: 'reset-token-123',
      resetUrl: 'https://example.com/reset-password?token=reset-token-123'
    };
    it('should send password reset email successfully', async () => {
      mockTransporter.sendMail.mockResolvedValue({
        messageId: 'test-message-id'
      });
      const result = await sendPasswordResetEmail('john@example.com', mockResetData);
      expect(result.success).toBe(true);
      expect(mockTransporter.sendMail).toHaveBeenCalledWith({
        from: 'test@example.com',
        to: 'john@example.com',
        subject: 'Password Reset Request',
        text: expect.stringContaining('We received a request to reset your password'),
        html: expect.stringContaining('Password Reset Request')
      });
    });
  });
  describe('sendWholesalerNotification', () => {
    const mockOrderData = {
      orderNumber: 'ORD-123456',
      orderDate: '12/1/2023',
      shippingAddress: {
        firstName: 'John',
        lastName: 'Doe',
        street: '123 Main St',
        city: 'Anytown',
        state: 'CA',
        zipCode: '12345',
        country: 'US',
        phone: '555-1234'
      },
      items: [{
        wholesaler: {
          productCode: 'WS-CRYSTAL-001'
        },
        quantity: 2,
        productName: 'Crystal Healing Set'
      }],
      notes: 'Handle with care'
    };
    it('should send wholesaler notification email successfully', async () => {
      mockTransporter.sendMail.mockResolvedValue({
        messageId: 'test-message-id'
      });
      const result = await sendWholesalerNotification('wholesaler@example.com', mockOrderData);
      expect(result.success).toBe(true);
      expect(mockTransporter.sendMail).toHaveBeenCalledWith({
        from: 'test@example.com',
        to: 'wholesaler@example.com',
        subject: 'New Order - ORD-123456',
        text: expect.stringContaining('We have received a new order that requires fulfillment')
      });
    });
  });
  describe('sendEmail (generic)', () => {
    it('should send generic email successfully', async () => {
      mockTransporter.sendMail.mockResolvedValue({
        messageId: 'test-message-id'
      });
      const result = await sendEmail('recipient@example.com', 'Test Subject', 'Test message content', '<p>Test HTML content</p>');
      expect(result.success).toBe(true);
      expect(mockTransporter.sendMail).toHaveBeenCalledWith({
        from: 'test@example.com',
        to: 'recipient@example.com',
        subject: 'Test Subject',
        text: 'Test message content',
        html: '<p>Test HTML content</p>'
      });
    });
    it('should send text-only email when HTML is not provided', async () => {
      mockTransporter.sendMail.mockResolvedValue({
        messageId: 'test-message-id'
      });
      const result = await sendEmail('recipient@example.com', 'Test Subject', 'Test message content');
      expect(result.success).toBe(true);
      expect(mockTransporter.sendMail).toHaveBeenCalledWith({
        from: 'test@example.com',
        to: 'recipient@example.com',
        subject: 'Test Subject',
        text: 'Test message content'
      });
    });
  });
  describe('Email Templates', () => {
    it('should generate order confirmation template correctly', () => {
      const orderData = {
        orderNumber: 'ORD-123456',
        customerName: 'John Doe',
        items: [{
          productName: 'Test Product',
          quantity: 1,
          price: 29.99
        }],
        total: 29.99,
        shippingAddress: {
          firstName: 'John',
          lastName: 'Doe',
          street: '123 Main St',
          city: 'Anytown',
          state: 'CA',
          zipCode: '12345',
          country: 'US'
        }
      };
      const template = emailTemplates.orderConfirmation(orderData);
      expect(template.subject).toBe('Order Confirmation - ORD-123456');
      expect(template.text).toContain('Dear John Doe');
      expect(template.text).toContain('Order Number: ORD-123456');
      expect(template.html).toContain('Order Confirmation');
    });
    it('should generate payment receipt template correctly', () => {
      const paymentData = {
        orderNumber: 'ORD-123456',
        customerName: 'John Doe',
        total: 29.99,
        paymentMethod: 'Credit Card',
        transactionId: 'txn_123',
        paidAt: new Date('2023-12-01')
      };
      const template = emailTemplates.paymentReceipt(paymentData);
      expect(template.subject).toBe('Payment Receipt - ORD-123456');
      expect(template.text).toContain('Your payment has been successfully processed!');
      expect(template.html).toContain('Payment Receipt');
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsInVubW9jayIsIm1vY2siLCJqZXN0IiwicmVxdWlyZSIsIm5vZGVtYWlsZXIiLCJzZW5kT3JkZXJDb25maXJtYXRpb24iLCJzZW5kUGF5bWVudFJlY2VpcHQiLCJzZW5kT3JkZXJTdGF0dXNVcGRhdGUiLCJzZW5kV2VsY29tZUVtYWlsIiwic2VuZFBhc3N3b3JkUmVzZXRFbWFpbCIsInNlbmRXaG9sZXNhbGVyTm90aWZpY2F0aW9uIiwic2VuZEVtYWlsIiwiZW1haWxUZW1wbGF0ZXMiLCJkZXNjcmliZSIsIm1vY2tUcmFuc3BvcnRlciIsImJlZm9yZUVhY2giLCJzZW5kTWFpbCIsImZuIiwiY3JlYXRlVHJhbnNwb3J0IiwibW9ja1JldHVyblZhbHVlIiwicHJvY2VzcyIsImVudiIsIkVNQUlMX0hPU1QiLCJFTUFJTF9QT1JUIiwiRU1BSUxfVVNFUiIsIkVNQUlMX1BBU1MiLCJhZnRlckVhY2giLCJjbGVhckFsbE1vY2tzIiwibW9ja09yZGVyRGF0YSIsIm9yZGVyTnVtYmVyIiwiY3VzdG9tZXJOYW1lIiwiaXRlbXMiLCJwcm9kdWN0TmFtZSIsInF1YW50aXR5IiwicHJpY2UiLCJ0b3RhbCIsInNoaXBwaW5nQWRkcmVzcyIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwic3RyZWV0IiwiY2l0eSIsInN0YXRlIiwiemlwQ29kZSIsImNvdW50cnkiLCJpdCIsIm1vY2tSZXNvbHZlZFZhbHVlIiwibWVzc2FnZUlkIiwicmVzdWx0IiwiZXhwZWN0Iiwic3VjY2VzcyIsInRvQmUiLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsImZyb20iLCJ0byIsInN1YmplY3QiLCJ0ZXh0Iiwic3RyaW5nQ29udGFpbmluZyIsImh0bWwiLCJlcnJvciIsIkVycm9yIiwibW9ja1JlamVjdGVkVmFsdWUiLCJtb2NrUGF5bWVudERhdGEiLCJwYXltZW50TWV0aG9kIiwidHJhbnNhY3Rpb25JZCIsInBhaWRBdCIsIkRhdGUiLCJtb2NrU3RhdHVzRGF0YSIsInN0YXR1cyIsInRyYWNraW5nTnVtYmVyIiwicHJvY2Vzc2luZ0RhdGEiLCJvYmplY3RDb250YWluaW5nIiwibW9ja1VzZXJEYXRhIiwiZW1haWwiLCJtb2NrUmVzZXREYXRhIiwicmVzZXRUb2tlbiIsInJlc2V0VXJsIiwib3JkZXJEYXRlIiwicGhvbmUiLCJ3aG9sZXNhbGVyIiwicHJvZHVjdENvZGUiLCJub3RlcyIsIm9yZGVyRGF0YSIsInRlbXBsYXRlIiwib3JkZXJDb25maXJtYXRpb24iLCJ0b0NvbnRhaW4iLCJwYXltZW50RGF0YSIsInBheW1lbnRSZWNlaXB0Il0sInNvdXJjZXMiOlsiZW1haWxTZXJ2aWNlLnRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ2xlYXIgdGhlIGdsb2JhbCBtb2NrIGZvciBlbWFpbFNlcnZpY2UgdG8gdGVzdCB0aGUgYWN0dWFsIGltcGxlbWVudGF0aW9uXG5qZXN0LnVubW9jaygnLi4vLi4vdXRpbHMvZW1haWxTZXJ2aWNlJyk7XG5cbi8vIE1vY2sgbm9kZW1haWxlciBCRUZPUkUgaW1wb3J0aW5nIGVtYWlsU2VydmljZVxuamVzdC5tb2NrKCdub2RlbWFpbGVyJyk7XG5cbmNvbnN0IG5vZGVtYWlsZXIgPSByZXF1aXJlKCdub2RlbWFpbGVyJyk7XG5cbi8vIE5vdyByZXF1aXJlIHRoZSBlbWFpbCBzZXJ2aWNlIGFmdGVyIHRoZSBtb2NrIGlzIHNldCB1cFxuY29uc3Qge1xuICBzZW5kT3JkZXJDb25maXJtYXRpb24sXG4gIHNlbmRQYXltZW50UmVjZWlwdCxcbiAgc2VuZE9yZGVyU3RhdHVzVXBkYXRlLFxuICBzZW5kV2VsY29tZUVtYWlsLFxuICBzZW5kUGFzc3dvcmRSZXNldEVtYWlsLFxuICBzZW5kV2hvbGVzYWxlck5vdGlmaWNhdGlvbixcbiAgc2VuZEVtYWlsLFxuICBlbWFpbFRlbXBsYXRlc1xufSA9IHJlcXVpcmUoJy4uLy4uL3V0aWxzL2VtYWlsU2VydmljZScpO1xuXG5kZXNjcmliZSgnRW1haWwgU2VydmljZScsICgpID0+IHtcbiAgbGV0IG1vY2tUcmFuc3BvcnRlcjtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBtb2NrVHJhbnNwb3J0ZXIgPSB7XG4gICAgICBzZW5kTWFpbDogamVzdC5mbigpXG4gICAgfTtcbiAgICBub2RlbWFpbGVyLmNyZWF0ZVRyYW5zcG9ydCA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUobW9ja1RyYW5zcG9ydGVyKTtcbiAgICBcbiAgICAvLyBTZXQgdXAgZW52aXJvbm1lbnQgdmFyaWFibGVzIGZvciB0ZXN0c1xuICAgIHByb2Nlc3MuZW52LkVNQUlMX0hPU1QgPSAnc210cC50ZXN0LmNvbSc7XG4gICAgcHJvY2Vzcy5lbnYuRU1BSUxfUE9SVCA9ICc1ODcnO1xuICAgIHByb2Nlc3MuZW52LkVNQUlMX1VTRVIgPSAndGVzdEBleGFtcGxlLmNvbSc7XG4gICAgcHJvY2Vzcy5lbnYuRU1BSUxfUEFTUyA9ICd0ZXN0cGFzcyc7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzZW5kT3JkZXJDb25maXJtYXRpb24nLCAoKSA9PiB7XG4gICAgY29uc3QgbW9ja09yZGVyRGF0YSA9IHtcbiAgICAgIG9yZGVyTnVtYmVyOiAnT1JELTEyMzQ1NicsXG4gICAgICBjdXN0b21lck5hbWU6ICdKb2huIERvZScsXG4gICAgICBpdGVtczogW1xuICAgICAgICB7IHByb2R1Y3ROYW1lOiAnQ3J5c3RhbCBIZWFsaW5nIFNldCcsIHF1YW50aXR5OiAyLCBwcmljZTogMjkuOTkgfSxcbiAgICAgICAgeyBwcm9kdWN0TmFtZTogJ0Vzc2VudGlhbCBPaWwgQnVuZGxlJywgcXVhbnRpdHk6IDEsIHByaWNlOiA0NS4wMCB9XG4gICAgICBdLFxuICAgICAgdG90YWw6IDEwNC45OCxcbiAgICAgIHNoaXBwaW5nQWRkcmVzczoge1xuICAgICAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICAgICAgbGFzdE5hbWU6ICdEb2UnLFxuICAgICAgICBzdHJlZXQ6ICcxMjMgTWFpbiBTdCcsXG4gICAgICAgIGNpdHk6ICdBbnl0b3duJyxcbiAgICAgICAgc3RhdGU6ICdDQScsXG4gICAgICAgIHppcENvZGU6ICcxMjM0NScsXG4gICAgICAgIGNvdW50cnk6ICdVUydcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgaXQoJ3Nob3VsZCBzZW5kIG9yZGVyIGNvbmZpcm1hdGlvbiBlbWFpbCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrVHJhbnNwb3J0ZXIuc2VuZE1haWwubW9ja1Jlc29sdmVkVmFsdWUoeyBtZXNzYWdlSWQ6ICd0ZXN0LW1lc3NhZ2UtaWQnIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZW5kT3JkZXJDb25maXJtYXRpb24oJ2N1c3RvbWVyQGV4YW1wbGUuY29tJywgbW9ja09yZGVyRGF0YSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQubWVzc2FnZUlkKS50b0JlKCd0ZXN0LW1lc3NhZ2UtaWQnKTtcbiAgICAgIGV4cGVjdChtb2NrVHJhbnNwb3J0ZXIuc2VuZE1haWwpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgZnJvbTogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICB0bzogJ2N1c3RvbWVyQGV4YW1wbGUuY29tJyxcbiAgICAgICAgc3ViamVjdDogJ09yZGVyIENvbmZpcm1hdGlvbiAtIE9SRC0xMjM0NTYnLFxuICAgICAgICB0ZXh0OiBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnVGhhbmsgeW91IGZvciB5b3VyIG9yZGVyIScpLFxuICAgICAgICBodG1sOiBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnT3JkZXIgQ29uZmlybWF0aW9uJylcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1haWwgc2VuZGluZyBmYWlsdXJlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ1NNVFAgY29ubmVjdGlvbiBmYWlsZWQnKTtcbiAgICAgIG1vY2tUcmFuc3BvcnRlci5zZW5kTWFpbC5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlbmRPcmRlckNvbmZpcm1hdGlvbignY3VzdG9tZXJAZXhhbXBsZS5jb20nLCBtb2NrT3JkZXJEYXRhKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmUoJ1NNVFAgY29ubmVjdGlvbiBmYWlsZWQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3NlbmRQYXltZW50UmVjZWlwdCcsICgpID0+IHtcbiAgICBjb25zdCBtb2NrUGF5bWVudERhdGEgPSB7XG4gICAgICBvcmRlck51bWJlcjogJ09SRC0xMjM0NTYnLFxuICAgICAgY3VzdG9tZXJOYW1lOiAnSm9obiBEb2UnLFxuICAgICAgdG90YWw6IDEwNC45OCxcbiAgICAgIHBheW1lbnRNZXRob2Q6ICdDcmVkaXQgQ2FyZCcsXG4gICAgICB0cmFuc2FjdGlvbklkOiAndHhuXzEyMzQ1Njc4OScsXG4gICAgICBwYWlkQXQ6IG5ldyBEYXRlKCcyMDIzLTEyLTAxVDEwOjAwOjAwWicpXG4gICAgfTtcblxuICAgIGl0KCdzaG91bGQgc2VuZCBwYXltZW50IHJlY2VpcHQgZW1haWwgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsLm1vY2tSZXNvbHZlZFZhbHVlKHsgbWVzc2FnZUlkOiAndGVzdC1tZXNzYWdlLWlkJyB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VuZFBheW1lbnRSZWNlaXB0KCdjdXN0b21lckBleGFtcGxlLmNvbScsIG1vY2tQYXltZW50RGF0YSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChtb2NrVHJhbnNwb3J0ZXIuc2VuZE1haWwpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgZnJvbTogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICB0bzogJ2N1c3RvbWVyQGV4YW1wbGUuY29tJyxcbiAgICAgICAgc3ViamVjdDogJ1BheW1lbnQgUmVjZWlwdCAtIE9SRC0xMjM0NTYnLFxuICAgICAgICB0ZXh0OiBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnWW91ciBwYXltZW50IGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSBwcm9jZXNzZWQhJyksXG4gICAgICAgIGh0bWw6IGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdQYXltZW50IFJlY2VpcHQnKVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzZW5kT3JkZXJTdGF0dXNVcGRhdGUnLCAoKSA9PiB7XG4gICAgY29uc3QgbW9ja1N0YXR1c0RhdGEgPSB7XG4gICAgICBvcmRlck51bWJlcjogJ09SRC0xMjM0NTYnLFxuICAgICAgY3VzdG9tZXJOYW1lOiAnSm9obiBEb2UnLFxuICAgICAgc3RhdHVzOiAnc2hpcHBlZCcsXG4gICAgICB0cmFja2luZ051bWJlcjogJ1RSSzEyMzQ1Njc4OSdcbiAgICB9O1xuXG4gICAgaXQoJ3Nob3VsZCBzZW5kIG9yZGVyIHN0YXR1cyB1cGRhdGUgZW1haWwgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsLm1vY2tSZXNvbHZlZFZhbHVlKHsgbWVzc2FnZUlkOiAndGVzdC1tZXNzYWdlLWlkJyB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VuZE9yZGVyU3RhdHVzVXBkYXRlKCdjdXN0b21lckBleGFtcGxlLmNvbScsIG1vY2tTdGF0dXNEYXRhKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KG1vY2tUcmFuc3BvcnRlci5zZW5kTWFpbCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBmcm9tOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgIHRvOiAnY3VzdG9tZXJAZXhhbXBsZS5jb20nLFxuICAgICAgICBzdWJqZWN0OiAnT3JkZXIgVXBkYXRlIC0gT1JELTEyMzQ1NicsXG4gICAgICAgIHRleHQ6IGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdHcmVhdCBuZXdzISBZb3VyIG9yZGVyIGhhcyBiZWVuIHNoaXBwZWQuJyksXG4gICAgICAgIGh0bWw6IGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdPcmRlciBVcGRhdGUnKVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkaWZmZXJlbnQgb3JkZXIgc3RhdHVzZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrVHJhbnNwb3J0ZXIuc2VuZE1haWwubW9ja1Jlc29sdmVkVmFsdWUoeyBtZXNzYWdlSWQ6ICd0ZXN0LW1lc3NhZ2UtaWQnIH0pO1xuXG4gICAgICBjb25zdCBwcm9jZXNzaW5nRGF0YSA9IHsgLi4ubW9ja1N0YXR1c0RhdGEsIHN0YXR1czogJ3Byb2Nlc3NpbmcnIH07XG4gICAgICBhd2FpdCBzZW5kT3JkZXJTdGF0dXNVcGRhdGUoJ2N1c3RvbWVyQGV4YW1wbGUuY29tJywgcHJvY2Vzc2luZ0RhdGEpO1xuXG4gICAgICBleHBlY3QobW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIHRleHQ6IGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdZb3VyIG9yZGVyIGlzIGJlaW5nIHByb2Nlc3NlZCcpXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnc2VuZFdlbGNvbWVFbWFpbCcsICgpID0+IHtcbiAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB7XG4gICAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICAgIGVtYWlsOiAnam9obkBleGFtcGxlLmNvbSdcbiAgICB9O1xuXG4gICAgaXQoJ3Nob3VsZCBzZW5kIHdlbGNvbWUgZW1haWwgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsLm1vY2tSZXNvbHZlZFZhbHVlKHsgbWVzc2FnZUlkOiAndGVzdC1tZXNzYWdlLWlkJyB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VuZFdlbGNvbWVFbWFpbCgnam9obkBleGFtcGxlLmNvbScsIG1vY2tVc2VyRGF0YSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChtb2NrVHJhbnNwb3J0ZXIuc2VuZE1haWwpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgZnJvbTogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICB0bzogJ2pvaG5AZXhhbXBsZS5jb20nLFxuICAgICAgICBzdWJqZWN0OiAnV2VsY29tZSB0byBPdXIgSG9saXN0aWMgU3RvcmUhJyxcbiAgICAgICAgdGV4dDogZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ1dlbGNvbWUgdG8gb3VyIGhvbGlzdGljIHdlbGxuZXNzIGNvbW11bml0eSEnKSxcbiAgICAgICAgaHRtbDogZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ1dlbGNvbWUgdG8gT3VyIEhvbGlzdGljIFN0b3JlIScpXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3NlbmRQYXNzd29yZFJlc2V0RW1haWwnLCAoKSA9PiB7XG4gICAgY29uc3QgbW9ja1Jlc2V0RGF0YSA9IHtcbiAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgcmVzZXRUb2tlbjogJ3Jlc2V0LXRva2VuLTEyMycsXG4gICAgICByZXNldFVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vcmVzZXQtcGFzc3dvcmQ/dG9rZW49cmVzZXQtdG9rZW4tMTIzJ1xuICAgIH07XG5cbiAgICBpdCgnc2hvdWxkIHNlbmQgcGFzc3dvcmQgcmVzZXQgZW1haWwgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsLm1vY2tSZXNvbHZlZFZhbHVlKHsgbWVzc2FnZUlkOiAndGVzdC1tZXNzYWdlLWlkJyB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VuZFBhc3N3b3JkUmVzZXRFbWFpbCgnam9obkBleGFtcGxlLmNvbScsIG1vY2tSZXNldERhdGEpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QobW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGZyb206ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgdG86ICdqb2huQGV4YW1wbGUuY29tJyxcbiAgICAgICAgc3ViamVjdDogJ1Bhc3N3b3JkIFJlc2V0IFJlcXVlc3QnLFxuICAgICAgICB0ZXh0OiBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnV2UgcmVjZWl2ZWQgYSByZXF1ZXN0IHRvIHJlc2V0IHlvdXIgcGFzc3dvcmQnKSxcbiAgICAgICAgaHRtbDogZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ1Bhc3N3b3JkIFJlc2V0IFJlcXVlc3QnKVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzZW5kV2hvbGVzYWxlck5vdGlmaWNhdGlvbicsICgpID0+IHtcbiAgICBjb25zdCBtb2NrT3JkZXJEYXRhID0ge1xuICAgICAgb3JkZXJOdW1iZXI6ICdPUkQtMTIzNDU2JyxcbiAgICAgIG9yZGVyRGF0ZTogJzEyLzEvMjAyMycsXG4gICAgICBzaGlwcGluZ0FkZHJlc3M6IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICAgICAgc3RyZWV0OiAnMTIzIE1haW4gU3QnLFxuICAgICAgICBjaXR5OiAnQW55dG93bicsXG4gICAgICAgIHN0YXRlOiAnQ0EnLFxuICAgICAgICB6aXBDb2RlOiAnMTIzNDUnLFxuICAgICAgICBjb3VudHJ5OiAnVVMnLFxuICAgICAgICBwaG9uZTogJzU1NS0xMjM0J1xuICAgICAgfSxcbiAgICAgIGl0ZW1zOiBbXG4gICAgICAgIHtcbiAgICAgICAgICB3aG9sZXNhbGVyOiB7IHByb2R1Y3RDb2RlOiAnV1MtQ1JZU1RBTC0wMDEnIH0sXG4gICAgICAgICAgcXVhbnRpdHk6IDIsXG4gICAgICAgICAgcHJvZHVjdE5hbWU6ICdDcnlzdGFsIEhlYWxpbmcgU2V0J1xuICAgICAgICB9XG4gICAgICBdLFxuICAgICAgbm90ZXM6ICdIYW5kbGUgd2l0aCBjYXJlJ1xuICAgIH07XG5cbiAgICBpdCgnc2hvdWxkIHNlbmQgd2hvbGVzYWxlciBub3RpZmljYXRpb24gZW1haWwgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsLm1vY2tSZXNvbHZlZFZhbHVlKHsgbWVzc2FnZUlkOiAndGVzdC1tZXNzYWdlLWlkJyB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VuZFdob2xlc2FsZXJOb3RpZmljYXRpb24oJ3dob2xlc2FsZXJAZXhhbXBsZS5jb20nLCBtb2NrT3JkZXJEYXRhKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KG1vY2tUcmFuc3BvcnRlci5zZW5kTWFpbCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBmcm9tOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgIHRvOiAnd2hvbGVzYWxlckBleGFtcGxlLmNvbScsXG4gICAgICAgIHN1YmplY3Q6ICdOZXcgT3JkZXIgLSBPUkQtMTIzNDU2JyxcbiAgICAgICAgdGV4dDogZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ1dlIGhhdmUgcmVjZWl2ZWQgYSBuZXcgb3JkZXIgdGhhdCByZXF1aXJlcyBmdWxmaWxsbWVudCcpXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3NlbmRFbWFpbCAoZ2VuZXJpYyknLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzZW5kIGdlbmVyaWMgZW1haWwgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsLm1vY2tSZXNvbHZlZFZhbHVlKHsgbWVzc2FnZUlkOiAndGVzdC1tZXNzYWdlLWlkJyB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VuZEVtYWlsKFxuICAgICAgICAncmVjaXBpZW50QGV4YW1wbGUuY29tJyxcbiAgICAgICAgJ1Rlc3QgU3ViamVjdCcsXG4gICAgICAgICdUZXN0IG1lc3NhZ2UgY29udGVudCcsXG4gICAgICAgICc8cD5UZXN0IEhUTUwgY29udGVudDwvcD4nXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QobW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGZyb206ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgdG86ICdyZWNpcGllbnRAZXhhbXBsZS5jb20nLFxuICAgICAgICBzdWJqZWN0OiAnVGVzdCBTdWJqZWN0JyxcbiAgICAgICAgdGV4dDogJ1Rlc3QgbWVzc2FnZSBjb250ZW50JyxcbiAgICAgICAgaHRtbDogJzxwPlRlc3QgSFRNTCBjb250ZW50PC9wPidcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzZW5kIHRleHQtb25seSBlbWFpbCB3aGVuIEhUTUwgaXMgbm90IHByb3ZpZGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1RyYW5zcG9ydGVyLnNlbmRNYWlsLm1vY2tSZXNvbHZlZFZhbHVlKHsgbWVzc2FnZUlkOiAndGVzdC1tZXNzYWdlLWlkJyB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VuZEVtYWlsKFxuICAgICAgICAncmVjaXBpZW50QGV4YW1wbGUuY29tJyxcbiAgICAgICAgJ1Rlc3QgU3ViamVjdCcsXG4gICAgICAgICdUZXN0IG1lc3NhZ2UgY29udGVudCdcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChtb2NrVHJhbnNwb3J0ZXIuc2VuZE1haWwpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgZnJvbTogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICB0bzogJ3JlY2lwaWVudEBleGFtcGxlLmNvbScsXG4gICAgICAgIHN1YmplY3Q6ICdUZXN0IFN1YmplY3QnLFxuICAgICAgICB0ZXh0OiAnVGVzdCBtZXNzYWdlIGNvbnRlbnQnXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0VtYWlsIFRlbXBsYXRlcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGdlbmVyYXRlIG9yZGVyIGNvbmZpcm1hdGlvbiB0ZW1wbGF0ZSBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBvcmRlckRhdGEgPSB7XG4gICAgICAgIG9yZGVyTnVtYmVyOiAnT1JELTEyMzQ1NicsXG4gICAgICAgIGN1c3RvbWVyTmFtZTogJ0pvaG4gRG9lJyxcbiAgICAgICAgaXRlbXM6IFt7IHByb2R1Y3ROYW1lOiAnVGVzdCBQcm9kdWN0JywgcXVhbnRpdHk6IDEsIHByaWNlOiAyOS45OSB9XSxcbiAgICAgICAgdG90YWw6IDI5Ljk5LFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICAgICAgICBsYXN0TmFtZTogJ0RvZScsXG4gICAgICAgICAgc3RyZWV0OiAnMTIzIE1haW4gU3QnLFxuICAgICAgICAgIGNpdHk6ICdBbnl0b3duJyxcbiAgICAgICAgICBzdGF0ZTogJ0NBJyxcbiAgICAgICAgICB6aXBDb2RlOiAnMTIzNDUnLFxuICAgICAgICAgIGNvdW50cnk6ICdVUydcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgY29uc3QgdGVtcGxhdGUgPSBlbWFpbFRlbXBsYXRlcy5vcmRlckNvbmZpcm1hdGlvbihvcmRlckRhdGEpO1xuXG4gICAgICBleHBlY3QodGVtcGxhdGUuc3ViamVjdCkudG9CZSgnT3JkZXIgQ29uZmlybWF0aW9uIC0gT1JELTEyMzQ1NicpO1xuICAgICAgZXhwZWN0KHRlbXBsYXRlLnRleHQpLnRvQ29udGFpbignRGVhciBKb2huIERvZScpO1xuICAgICAgZXhwZWN0KHRlbXBsYXRlLnRleHQpLnRvQ29udGFpbignT3JkZXIgTnVtYmVyOiBPUkQtMTIzNDU2Jyk7XG4gICAgICBleHBlY3QodGVtcGxhdGUuaHRtbCkudG9Db250YWluKCdPcmRlciBDb25maXJtYXRpb24nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgcGF5bWVudCByZWNlaXB0IHRlbXBsYXRlIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGNvbnN0IHBheW1lbnREYXRhID0ge1xuICAgICAgICBvcmRlck51bWJlcjogJ09SRC0xMjM0NTYnLFxuICAgICAgICBjdXN0b21lck5hbWU6ICdKb2huIERvZScsXG4gICAgICAgIHRvdGFsOiAyOS45OSxcbiAgICAgICAgcGF5bWVudE1ldGhvZDogJ0NyZWRpdCBDYXJkJyxcbiAgICAgICAgdHJhbnNhY3Rpb25JZDogJ3R4bl8xMjMnLFxuICAgICAgICBwYWlkQXQ6IG5ldyBEYXRlKCcyMDIzLTEyLTAxJylcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHRlbXBsYXRlID0gZW1haWxUZW1wbGF0ZXMucGF5bWVudFJlY2VpcHQocGF5bWVudERhdGEpO1xuXG4gICAgICBleHBlY3QodGVtcGxhdGUuc3ViamVjdCkudG9CZSgnUGF5bWVudCBSZWNlaXB0IC0gT1JELTEyMzQ1NicpO1xuICAgICAgZXhwZWN0KHRlbXBsYXRlLnRleHQpLnRvQ29udGFpbignWW91ciBwYXltZW50IGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSBwcm9jZXNzZWQhJyk7XG4gICAgICBleHBlY3QodGVtcGxhdGUuaHRtbCkudG9Db250YWluKCdQYXltZW50IFJlY2VpcHQnKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUdBO0FBRkFBLFdBQUEsR0FBS0MsTUFBTSxDQUFDLDBCQUEwQixDQUFDO0FBR3ZDRCxXQUFBLEdBQUtFLElBQUksQ0FBQyxZQUFZLENBQUM7QUFBQyxTQUFBRixZQUFBO0VBQUE7SUFBQUc7RUFBQSxJQUFBQyxPQUFBO0VBQUFKLFdBQUEsR0FBQUEsQ0FBQSxLQUFBRyxJQUFBO0VBQUEsT0FBQUEsSUFBQTtBQUFBO0FBRXhCLE1BQU1FLFVBQVUsR0FBR0QsT0FBTyxDQUFDLFlBQVksQ0FBQzs7QUFFeEM7QUFDQSxNQUFNO0VBQ0pFLHFCQUFxQjtFQUNyQkMsa0JBQWtCO0VBQ2xCQyxxQkFBcUI7RUFDckJDLGdCQUFnQjtFQUNoQkMsc0JBQXNCO0VBQ3RCQywwQkFBMEI7RUFDMUJDLFNBQVM7RUFDVEM7QUFDRixDQUFDLEdBQUdULE9BQU8sQ0FBQywwQkFBMEIsQ0FBQztBQUV2Q1UsUUFBUSxDQUFDLGVBQWUsRUFBRSxNQUFNO0VBQzlCLElBQUlDLGVBQWU7RUFFbkJDLFVBQVUsQ0FBQyxNQUFNO0lBQ2ZELGVBQWUsR0FBRztNQUNoQkUsUUFBUSxFQUFFZCxJQUFJLENBQUNlLEVBQUUsQ0FBQztJQUNwQixDQUFDO0lBQ0RiLFVBQVUsQ0FBQ2MsZUFBZSxHQUFHaEIsSUFBSSxDQUFDZSxFQUFFLENBQUMsQ0FBQyxDQUFDRSxlQUFlLENBQUNMLGVBQWUsQ0FBQzs7SUFFdkU7SUFDQU0sT0FBTyxDQUFDQyxHQUFHLENBQUNDLFVBQVUsR0FBRyxlQUFlO0lBQ3hDRixPQUFPLENBQUNDLEdBQUcsQ0FBQ0UsVUFBVSxHQUFHLEtBQUs7SUFDOUJILE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRyxVQUFVLEdBQUcsa0JBQWtCO0lBQzNDSixPQUFPLENBQUNDLEdBQUcsQ0FBQ0ksVUFBVSxHQUFHLFVBQVU7RUFDckMsQ0FBQyxDQUFDO0VBRUZDLFNBQVMsQ0FBQyxNQUFNO0lBQ2R4QixJQUFJLENBQUN5QixhQUFhLENBQUMsQ0FBQztFQUN0QixDQUFDLENBQUM7RUFFRmQsUUFBUSxDQUFDLHVCQUF1QixFQUFFLE1BQU07SUFDdEMsTUFBTWUsYUFBYSxHQUFHO01BQ3BCQyxXQUFXLEVBQUUsWUFBWTtNQUN6QkMsWUFBWSxFQUFFLFVBQVU7TUFDeEJDLEtBQUssRUFBRSxDQUNMO1FBQUVDLFdBQVcsRUFBRSxxQkFBcUI7UUFBRUMsUUFBUSxFQUFFLENBQUM7UUFBRUMsS0FBSyxFQUFFO01BQU0sQ0FBQyxFQUNqRTtRQUFFRixXQUFXLEVBQUUsc0JBQXNCO1FBQUVDLFFBQVEsRUFBRSxDQUFDO1FBQUVDLEtBQUssRUFBRTtNQUFNLENBQUMsQ0FDbkU7TUFDREMsS0FBSyxFQUFFLE1BQU07TUFDYkMsZUFBZSxFQUFFO1FBQ2ZDLFNBQVMsRUFBRSxNQUFNO1FBQ2pCQyxRQUFRLEVBQUUsS0FBSztRQUNmQyxNQUFNLEVBQUUsYUFBYTtRQUNyQkMsSUFBSSxFQUFFLFNBQVM7UUFDZkMsS0FBSyxFQUFFLElBQUk7UUFDWEMsT0FBTyxFQUFFLE9BQU87UUFDaEJDLE9BQU8sRUFBRTtNQUNYO0lBQ0YsQ0FBQztJQUVEQyxFQUFFLENBQUMsbURBQW1ELEVBQUUsWUFBWTtNQUNsRTlCLGVBQWUsQ0FBQ0UsUUFBUSxDQUFDNkIsaUJBQWlCLENBQUM7UUFBRUMsU0FBUyxFQUFFO01BQWtCLENBQUMsQ0FBQztNQUU1RSxNQUFNQyxNQUFNLEdBQUcsTUFBTTFDLHFCQUFxQixDQUFDLHNCQUFzQixFQUFFdUIsYUFBYSxDQUFDO01BRWpGb0IsTUFBTSxDQUFDRCxNQUFNLENBQUNFLE9BQU8sQ0FBQyxDQUFDQyxJQUFJLENBQUMsSUFBSSxDQUFDO01BQ2pDRixNQUFNLENBQUNELE1BQU0sQ0FBQ0QsU0FBUyxDQUFDLENBQUNJLElBQUksQ0FBQyxpQkFBaUIsQ0FBQztNQUNoREYsTUFBTSxDQUFDbEMsZUFBZSxDQUFDRSxRQUFRLENBQUMsQ0FBQ21DLG9CQUFvQixDQUFDO1FBQ3BEQyxJQUFJLEVBQUUsa0JBQWtCO1FBQ3hCQyxFQUFFLEVBQUUsc0JBQXNCO1FBQzFCQyxPQUFPLEVBQUUsaUNBQWlDO1FBQzFDQyxJQUFJLEVBQUVQLE1BQU0sQ0FBQ1EsZ0JBQWdCLENBQUMsMkJBQTJCLENBQUM7UUFDMURDLElBQUksRUFBRVQsTUFBTSxDQUFDUSxnQkFBZ0IsQ0FBQyxvQkFBb0I7TUFDcEQsQ0FBQyxDQUFDO0lBQ0osQ0FBQyxDQUFDO0lBRUZaLEVBQUUsQ0FBQyxxQ0FBcUMsRUFBRSxZQUFZO01BQ3BELE1BQU1jLEtBQUssR0FBRyxJQUFJQyxLQUFLLENBQUMsd0JBQXdCLENBQUM7TUFDakQ3QyxlQUFlLENBQUNFLFFBQVEsQ0FBQzRDLGlCQUFpQixDQUFDRixLQUFLLENBQUM7TUFFakQsTUFBTVgsTUFBTSxHQUFHLE1BQU0xQyxxQkFBcUIsQ0FBQyxzQkFBc0IsRUFBRXVCLGFBQWEsQ0FBQztNQUVqRm9CLE1BQU0sQ0FBQ0QsTUFBTSxDQUFDRSxPQUFPLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLEtBQUssQ0FBQztNQUNsQ0YsTUFBTSxDQUFDRCxNQUFNLENBQUNXLEtBQUssQ0FBQyxDQUFDUixJQUFJLENBQUMsd0JBQXdCLENBQUM7SUFDckQsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0VBRUZyQyxRQUFRLENBQUMsb0JBQW9CLEVBQUUsTUFBTTtJQUNuQyxNQUFNZ0QsZUFBZSxHQUFHO01BQ3RCaEMsV0FBVyxFQUFFLFlBQVk7TUFDekJDLFlBQVksRUFBRSxVQUFVO01BQ3hCSyxLQUFLLEVBQUUsTUFBTTtNQUNiMkIsYUFBYSxFQUFFLGFBQWE7TUFDNUJDLGFBQWEsRUFBRSxlQUFlO01BQzlCQyxNQUFNLEVBQUUsSUFBSUMsSUFBSSxDQUFDLHNCQUFzQjtJQUN6QyxDQUFDO0lBRURyQixFQUFFLENBQUMsZ0RBQWdELEVBQUUsWUFBWTtNQUMvRDlCLGVBQWUsQ0FBQ0UsUUFBUSxDQUFDNkIsaUJBQWlCLENBQUM7UUFBRUMsU0FBUyxFQUFFO01BQWtCLENBQUMsQ0FBQztNQUU1RSxNQUFNQyxNQUFNLEdBQUcsTUFBTXpDLGtCQUFrQixDQUFDLHNCQUFzQixFQUFFdUQsZUFBZSxDQUFDO01BRWhGYixNQUFNLENBQUNELE1BQU0sQ0FBQ0UsT0FBTyxDQUFDLENBQUNDLElBQUksQ0FBQyxJQUFJLENBQUM7TUFDakNGLE1BQU0sQ0FBQ2xDLGVBQWUsQ0FBQ0UsUUFBUSxDQUFDLENBQUNtQyxvQkFBb0IsQ0FBQztRQUNwREMsSUFBSSxFQUFFLGtCQUFrQjtRQUN4QkMsRUFBRSxFQUFFLHNCQUFzQjtRQUMxQkMsT0FBTyxFQUFFLDhCQUE4QjtRQUN2Q0MsSUFBSSxFQUFFUCxNQUFNLENBQUNRLGdCQUFnQixDQUFDLCtDQUErQyxDQUFDO1FBQzlFQyxJQUFJLEVBQUVULE1BQU0sQ0FBQ1EsZ0JBQWdCLENBQUMsaUJBQWlCO01BQ2pELENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztFQUVGM0MsUUFBUSxDQUFDLHVCQUF1QixFQUFFLE1BQU07SUFDdEMsTUFBTXFELGNBQWMsR0FBRztNQUNyQnJDLFdBQVcsRUFBRSxZQUFZO01BQ3pCQyxZQUFZLEVBQUUsVUFBVTtNQUN4QnFDLE1BQU0sRUFBRSxTQUFTO01BQ2pCQyxjQUFjLEVBQUU7SUFDbEIsQ0FBQztJQUVEeEIsRUFBRSxDQUFDLG9EQUFvRCxFQUFFLFlBQVk7TUFDbkU5QixlQUFlLENBQUNFLFFBQVEsQ0FBQzZCLGlCQUFpQixDQUFDO1FBQUVDLFNBQVMsRUFBRTtNQUFrQixDQUFDLENBQUM7TUFFNUUsTUFBTUMsTUFBTSxHQUFHLE1BQU14QyxxQkFBcUIsQ0FBQyxzQkFBc0IsRUFBRTJELGNBQWMsQ0FBQztNQUVsRmxCLE1BQU0sQ0FBQ0QsTUFBTSxDQUFDRSxPQUFPLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLElBQUksQ0FBQztNQUNqQ0YsTUFBTSxDQUFDbEMsZUFBZSxDQUFDRSxRQUFRLENBQUMsQ0FBQ21DLG9CQUFvQixDQUFDO1FBQ3BEQyxJQUFJLEVBQUUsa0JBQWtCO1FBQ3hCQyxFQUFFLEVBQUUsc0JBQXNCO1FBQzFCQyxPQUFPLEVBQUUsMkJBQTJCO1FBQ3BDQyxJQUFJLEVBQUVQLE1BQU0sQ0FBQ1EsZ0JBQWdCLENBQUMsMENBQTBDLENBQUM7UUFDekVDLElBQUksRUFBRVQsTUFBTSxDQUFDUSxnQkFBZ0IsQ0FBQyxjQUFjO01BQzlDLENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQztJQUVGWixFQUFFLENBQUMsd0NBQXdDLEVBQUUsWUFBWTtNQUN2RDlCLGVBQWUsQ0FBQ0UsUUFBUSxDQUFDNkIsaUJBQWlCLENBQUM7UUFBRUMsU0FBUyxFQUFFO01BQWtCLENBQUMsQ0FBQztNQUU1RSxNQUFNdUIsY0FBYyxHQUFHO1FBQUUsR0FBR0gsY0FBYztRQUFFQyxNQUFNLEVBQUU7TUFBYSxDQUFDO01BQ2xFLE1BQU01RCxxQkFBcUIsQ0FBQyxzQkFBc0IsRUFBRThELGNBQWMsQ0FBQztNQUVuRXJCLE1BQU0sQ0FBQ2xDLGVBQWUsQ0FBQ0UsUUFBUSxDQUFDLENBQUNtQyxvQkFBb0IsQ0FDbkRILE1BQU0sQ0FBQ3NCLGdCQUFnQixDQUFDO1FBQ3RCZixJQUFJLEVBQUVQLE1BQU0sQ0FBQ1EsZ0JBQWdCLENBQUMsK0JBQStCO01BQy9ELENBQUMsQ0FDSCxDQUFDO0lBQ0gsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0VBRUYzQyxRQUFRLENBQUMsa0JBQWtCLEVBQUUsTUFBTTtJQUNqQyxNQUFNMEQsWUFBWSxHQUFHO01BQ25CbEMsU0FBUyxFQUFFLE1BQU07TUFDakJtQyxLQUFLLEVBQUU7SUFDVCxDQUFDO0lBRUQ1QixFQUFFLENBQUMsd0NBQXdDLEVBQUUsWUFBWTtNQUN2RDlCLGVBQWUsQ0FBQ0UsUUFBUSxDQUFDNkIsaUJBQWlCLENBQUM7UUFBRUMsU0FBUyxFQUFFO01BQWtCLENBQUMsQ0FBQztNQUU1RSxNQUFNQyxNQUFNLEdBQUcsTUFBTXZDLGdCQUFnQixDQUFDLGtCQUFrQixFQUFFK0QsWUFBWSxDQUFDO01BRXZFdkIsTUFBTSxDQUFDRCxNQUFNLENBQUNFLE9BQU8sQ0FBQyxDQUFDQyxJQUFJLENBQUMsSUFBSSxDQUFDO01BQ2pDRixNQUFNLENBQUNsQyxlQUFlLENBQUNFLFFBQVEsQ0FBQyxDQUFDbUMsb0JBQW9CLENBQUM7UUFDcERDLElBQUksRUFBRSxrQkFBa0I7UUFDeEJDLEVBQUUsRUFBRSxrQkFBa0I7UUFDdEJDLE9BQU8sRUFBRSxnQ0FBZ0M7UUFDekNDLElBQUksRUFBRVAsTUFBTSxDQUFDUSxnQkFBZ0IsQ0FBQyw2Q0FBNkMsQ0FBQztRQUM1RUMsSUFBSSxFQUFFVCxNQUFNLENBQUNRLGdCQUFnQixDQUFDLGdDQUFnQztNQUNoRSxDQUFDLENBQUM7SUFDSixDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7RUFFRjNDLFFBQVEsQ0FBQyx3QkFBd0IsRUFBRSxNQUFNO0lBQ3ZDLE1BQU00RCxhQUFhLEdBQUc7TUFDcEJwQyxTQUFTLEVBQUUsTUFBTTtNQUNqQnFDLFVBQVUsRUFBRSxpQkFBaUI7TUFDN0JDLFFBQVEsRUFBRTtJQUNaLENBQUM7SUFFRC9CLEVBQUUsQ0FBQywrQ0FBK0MsRUFBRSxZQUFZO01BQzlEOUIsZUFBZSxDQUFDRSxRQUFRLENBQUM2QixpQkFBaUIsQ0FBQztRQUFFQyxTQUFTLEVBQUU7TUFBa0IsQ0FBQyxDQUFDO01BRTVFLE1BQU1DLE1BQU0sR0FBRyxNQUFNdEMsc0JBQXNCLENBQUMsa0JBQWtCLEVBQUVnRSxhQUFhLENBQUM7TUFFOUV6QixNQUFNLENBQUNELE1BQU0sQ0FBQ0UsT0FBTyxDQUFDLENBQUNDLElBQUksQ0FBQyxJQUFJLENBQUM7TUFDakNGLE1BQU0sQ0FBQ2xDLGVBQWUsQ0FBQ0UsUUFBUSxDQUFDLENBQUNtQyxvQkFBb0IsQ0FBQztRQUNwREMsSUFBSSxFQUFFLGtCQUFrQjtRQUN4QkMsRUFBRSxFQUFFLGtCQUFrQjtRQUN0QkMsT0FBTyxFQUFFLHdCQUF3QjtRQUNqQ0MsSUFBSSxFQUFFUCxNQUFNLENBQUNRLGdCQUFnQixDQUFDLDhDQUE4QyxDQUFDO1FBQzdFQyxJQUFJLEVBQUVULE1BQU0sQ0FBQ1EsZ0JBQWdCLENBQUMsd0JBQXdCO01BQ3hELENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztFQUVGM0MsUUFBUSxDQUFDLDRCQUE0QixFQUFFLE1BQU07SUFDM0MsTUFBTWUsYUFBYSxHQUFHO01BQ3BCQyxXQUFXLEVBQUUsWUFBWTtNQUN6QitDLFNBQVMsRUFBRSxXQUFXO01BQ3RCeEMsZUFBZSxFQUFFO1FBQ2ZDLFNBQVMsRUFBRSxNQUFNO1FBQ2pCQyxRQUFRLEVBQUUsS0FBSztRQUNmQyxNQUFNLEVBQUUsYUFBYTtRQUNyQkMsSUFBSSxFQUFFLFNBQVM7UUFDZkMsS0FBSyxFQUFFLElBQUk7UUFDWEMsT0FBTyxFQUFFLE9BQU87UUFDaEJDLE9BQU8sRUFBRSxJQUFJO1FBQ2JrQyxLQUFLLEVBQUU7TUFDVCxDQUFDO01BQ0Q5QyxLQUFLLEVBQUUsQ0FDTDtRQUNFK0MsVUFBVSxFQUFFO1VBQUVDLFdBQVcsRUFBRTtRQUFpQixDQUFDO1FBQzdDOUMsUUFBUSxFQUFFLENBQUM7UUFDWEQsV0FBVyxFQUFFO01BQ2YsQ0FBQyxDQUNGO01BQ0RnRCxLQUFLLEVBQUU7SUFDVCxDQUFDO0lBRURwQyxFQUFFLENBQUMsd0RBQXdELEVBQUUsWUFBWTtNQUN2RTlCLGVBQWUsQ0FBQ0UsUUFBUSxDQUFDNkIsaUJBQWlCLENBQUM7UUFBRUMsU0FBUyxFQUFFO01BQWtCLENBQUMsQ0FBQztNQUU1RSxNQUFNQyxNQUFNLEdBQUcsTUFBTXJDLDBCQUEwQixDQUFDLHdCQUF3QixFQUFFa0IsYUFBYSxDQUFDO01BRXhGb0IsTUFBTSxDQUFDRCxNQUFNLENBQUNFLE9BQU8sQ0FBQyxDQUFDQyxJQUFJLENBQUMsSUFBSSxDQUFDO01BQ2pDRixNQUFNLENBQUNsQyxlQUFlLENBQUNFLFFBQVEsQ0FBQyxDQUFDbUMsb0JBQW9CLENBQUM7UUFDcERDLElBQUksRUFBRSxrQkFBa0I7UUFDeEJDLEVBQUUsRUFBRSx3QkFBd0I7UUFDNUJDLE9BQU8sRUFBRSx3QkFBd0I7UUFDakNDLElBQUksRUFBRVAsTUFBTSxDQUFDUSxnQkFBZ0IsQ0FBQyx3REFBd0Q7TUFDeEYsQ0FBQyxDQUFDO0lBQ0osQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0VBRUYzQyxRQUFRLENBQUMscUJBQXFCLEVBQUUsTUFBTTtJQUNwQytCLEVBQUUsQ0FBQyx3Q0FBd0MsRUFBRSxZQUFZO01BQ3ZEOUIsZUFBZSxDQUFDRSxRQUFRLENBQUM2QixpQkFBaUIsQ0FBQztRQUFFQyxTQUFTLEVBQUU7TUFBa0IsQ0FBQyxDQUFDO01BRTVFLE1BQU1DLE1BQU0sR0FBRyxNQUFNcEMsU0FBUyxDQUM1Qix1QkFBdUIsRUFDdkIsY0FBYyxFQUNkLHNCQUFzQixFQUN0QiwwQkFDRixDQUFDO01BRURxQyxNQUFNLENBQUNELE1BQU0sQ0FBQ0UsT0FBTyxDQUFDLENBQUNDLElBQUksQ0FBQyxJQUFJLENBQUM7TUFDakNGLE1BQU0sQ0FBQ2xDLGVBQWUsQ0FBQ0UsUUFBUSxDQUFDLENBQUNtQyxvQkFBb0IsQ0FBQztRQUNwREMsSUFBSSxFQUFFLGtCQUFrQjtRQUN4QkMsRUFBRSxFQUFFLHVCQUF1QjtRQUMzQkMsT0FBTyxFQUFFLGNBQWM7UUFDdkJDLElBQUksRUFBRSxzQkFBc0I7UUFDNUJFLElBQUksRUFBRTtNQUNSLENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQztJQUVGYixFQUFFLENBQUMsdURBQXVELEVBQUUsWUFBWTtNQUN0RTlCLGVBQWUsQ0FBQ0UsUUFBUSxDQUFDNkIsaUJBQWlCLENBQUM7UUFBRUMsU0FBUyxFQUFFO01BQWtCLENBQUMsQ0FBQztNQUU1RSxNQUFNQyxNQUFNLEdBQUcsTUFBTXBDLFNBQVMsQ0FDNUIsdUJBQXVCLEVBQ3ZCLGNBQWMsRUFDZCxzQkFDRixDQUFDO01BRURxQyxNQUFNLENBQUNELE1BQU0sQ0FBQ0UsT0FBTyxDQUFDLENBQUNDLElBQUksQ0FBQyxJQUFJLENBQUM7TUFDakNGLE1BQU0sQ0FBQ2xDLGVBQWUsQ0FBQ0UsUUFBUSxDQUFDLENBQUNtQyxvQkFBb0IsQ0FBQztRQUNwREMsSUFBSSxFQUFFLGtCQUFrQjtRQUN4QkMsRUFBRSxFQUFFLHVCQUF1QjtRQUMzQkMsT0FBTyxFQUFFLGNBQWM7UUFDdkJDLElBQUksRUFBRTtNQUNSLENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztFQUVGMUMsUUFBUSxDQUFDLGlCQUFpQixFQUFFLE1BQU07SUFDaEMrQixFQUFFLENBQUMsdURBQXVELEVBQUUsTUFBTTtNQUNoRSxNQUFNcUMsU0FBUyxHQUFHO1FBQ2hCcEQsV0FBVyxFQUFFLFlBQVk7UUFDekJDLFlBQVksRUFBRSxVQUFVO1FBQ3hCQyxLQUFLLEVBQUUsQ0FBQztVQUFFQyxXQUFXLEVBQUUsY0FBYztVQUFFQyxRQUFRLEVBQUUsQ0FBQztVQUFFQyxLQUFLLEVBQUU7UUFBTSxDQUFDLENBQUM7UUFDbkVDLEtBQUssRUFBRSxLQUFLO1FBQ1pDLGVBQWUsRUFBRTtVQUNmQyxTQUFTLEVBQUUsTUFBTTtVQUNqQkMsUUFBUSxFQUFFLEtBQUs7VUFDZkMsTUFBTSxFQUFFLGFBQWE7VUFDckJDLElBQUksRUFBRSxTQUFTO1VBQ2ZDLEtBQUssRUFBRSxJQUFJO1VBQ1hDLE9BQU8sRUFBRSxPQUFPO1VBQ2hCQyxPQUFPLEVBQUU7UUFDWDtNQUNGLENBQUM7TUFFRCxNQUFNdUMsUUFBUSxHQUFHdEUsY0FBYyxDQUFDdUUsaUJBQWlCLENBQUNGLFNBQVMsQ0FBQztNQUU1RGpDLE1BQU0sQ0FBQ2tDLFFBQVEsQ0FBQzVCLE9BQU8sQ0FBQyxDQUFDSixJQUFJLENBQUMsaUNBQWlDLENBQUM7TUFDaEVGLE1BQU0sQ0FBQ2tDLFFBQVEsQ0FBQzNCLElBQUksQ0FBQyxDQUFDNkIsU0FBUyxDQUFDLGVBQWUsQ0FBQztNQUNoRHBDLE1BQU0sQ0FBQ2tDLFFBQVEsQ0FBQzNCLElBQUksQ0FBQyxDQUFDNkIsU0FBUyxDQUFDLDBCQUEwQixDQUFDO01BQzNEcEMsTUFBTSxDQUFDa0MsUUFBUSxDQUFDekIsSUFBSSxDQUFDLENBQUMyQixTQUFTLENBQUMsb0JBQW9CLENBQUM7SUFDdkQsQ0FBQyxDQUFDO0lBRUZ4QyxFQUFFLENBQUMsb0RBQW9ELEVBQUUsTUFBTTtNQUM3RCxNQUFNeUMsV0FBVyxHQUFHO1FBQ2xCeEQsV0FBVyxFQUFFLFlBQVk7UUFDekJDLFlBQVksRUFBRSxVQUFVO1FBQ3hCSyxLQUFLLEVBQUUsS0FBSztRQUNaMkIsYUFBYSxFQUFFLGFBQWE7UUFDNUJDLGFBQWEsRUFBRSxTQUFTO1FBQ3hCQyxNQUFNLEVBQUUsSUFBSUMsSUFBSSxDQUFDLFlBQVk7TUFDL0IsQ0FBQztNQUVELE1BQU1pQixRQUFRLEdBQUd0RSxjQUFjLENBQUMwRSxjQUFjLENBQUNELFdBQVcsQ0FBQztNQUUzRHJDLE1BQU0sQ0FBQ2tDLFFBQVEsQ0FBQzVCLE9BQU8sQ0FBQyxDQUFDSixJQUFJLENBQUMsOEJBQThCLENBQUM7TUFDN0RGLE1BQU0sQ0FBQ2tDLFFBQVEsQ0FBQzNCLElBQUksQ0FBQyxDQUFDNkIsU0FBUyxDQUFDLCtDQUErQyxDQUFDO01BQ2hGcEMsTUFBTSxDQUFDa0MsUUFBUSxDQUFDekIsSUFBSSxDQUFDLENBQUMyQixTQUFTLENBQUMsaUJBQWlCLENBQUM7SUFDcEQsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119