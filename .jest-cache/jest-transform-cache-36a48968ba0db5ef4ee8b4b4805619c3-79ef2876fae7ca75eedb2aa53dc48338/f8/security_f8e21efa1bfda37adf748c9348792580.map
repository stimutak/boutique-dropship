{"version":3,"names":["cov_jjf21zbn6","actualCoverage","crypto","s","require","mongoSanitize","rateLimit","slowDown","body","validationResult","csrfProtection","req","res","next","f","includes","method","b","headers","token","_csrf","sessionToken","session","csrfToken","status","json","success","error","code","message","generateCSRFToken","randomBytes","toString","apiKeyAuth","apiKey","validApiKeys","process","env","VALID_API_KEYS","split","createRateLimit","windowMs","max","standardHeaders","legacyHeaders","rateLimits","general","auth","payment","admin","integration","speedLimiter","delayAfter","delayMs","maxDelayMs","validate","sanitizeInput","replaceWith","onSanitize","key","console","warn","path","validationRules","email","isEmail","normalizeEmail","withMessage","password","isLength","min","matches","name","trim","phone","optional","isMobilePhone","address","price","isFloat","quantity","isInt","handleValidationErrors","errors","isEmpty","details","array","map","field","msg","value","securityHeaders","setHeader","removeHeader","module","exports"],"sources":["security.js"],"sourcesContent":["const crypto = require('crypto');\nconst mongoSanitize = require('express-mongo-sanitize');\nconst rateLimit = require('express-rate-limit');\nconst slowDown = require('express-slow-down');\nconst { body, validationResult } = require('express-validator');\n\n// CSRF Protection Middleware\nconst csrfProtection = (req, res, next) => {\n  // Skip CSRF for GET, HEAD, OPTIONS requests\n  if (['GET', 'HEAD', 'OPTIONS'].includes(req.method)) {\n    return next();\n  }\n\n  // Skip CSRF for API key authenticated requests\n  if (req.headers['x-api-key']) {\n    return next();\n  }\n\n  const token = req.headers['x-csrf-token'] || req.body._csrf;\n  const sessionToken = req.session.csrfToken;\n\n  if (!token || !sessionToken || token !== sessionToken) {\n    return res.status(403).json({\n      success: false,\n      error: {\n        code: 'CSRF_TOKEN_MISMATCH',\n        message: 'Invalid CSRF token'\n      }\n    });\n  }\n\n  next();\n};\n\n// Generate CSRF token\nconst generateCSRFToken = (req, res, next) => {\n  if (!req.session.csrfToken) {\n    req.session.csrfToken = crypto.randomBytes(32).toString('hex');\n  }\n  next();\n};\n\n// API Key Authentication\nconst apiKeyAuth = (req, res, next) => {\n  const apiKey = req.headers['x-api-key'];\n  \n  if (!apiKey) {\n    return res.status(401).json({\n      success: false,\n      error: {\n        code: 'API_KEY_REQUIRED',\n        message: 'API key is required for cross-site integration'\n      }\n    });\n  }\n\n  // Validate API key (in production, store these securely)\n  const validApiKeys = process.env.VALID_API_KEYS?.split(',') || [];\n  \n  if (!validApiKeys.includes(apiKey)) {\n    return res.status(401).json({\n      success: false,\n      error: {\n        code: 'INVALID_API_KEY',\n        message: 'Invalid API key'\n      }\n    });\n  }\n\n  req.apiKeyAuth = true;\n  next();\n};\n\n// Enhanced Rate Limiting\nconst createRateLimit = (windowMs, max, message) => {\n  return rateLimit({\n    windowMs,\n    max,\n    message: {\n      success: false,\n      error: {\n        code: 'RATE_LIMIT_EXCEEDED',\n        message\n      }\n    },\n    standardHeaders: true,\n    legacyHeaders: false,\n  });\n};\n\n// Different rate limits for different endpoints\n// More forgiving limits for development while still providing protection\nconst rateLimits = {\n  // General API rate limit - increased for development\n  general: createRateLimit(\n    15 * 60 * 1000, // 15 minutes\n    500, // 500 requests per window (was 100)\n    'Too many requests, please try again later'\n  ),\n  \n  // Authentication endpoints - more forgiving for dev/testing\n  auth: createRateLimit(\n    15 * 60 * 1000, // 15 minutes\n    50, // 50 requests per window (was 10)\n    'Too many authentication attempts, please try again later'\n  ),\n  \n  // Payment endpoints rate limit - slightly increased\n  payment: createRateLimit(\n    60 * 60 * 1000, // 1 hour\n    50, // 50 requests per hour (was 20)\n    'Too many payment requests, please try again later'\n  ),\n  \n  // Admin endpoints rate limit - increased\n  admin: createRateLimit(\n    15 * 60 * 1000, // 15 minutes\n    200, // 200 requests per window (was 50)\n    'Too many admin requests, please try again later'\n  ),\n  \n  // Cross-site integration rate limit - increased\n  integration: createRateLimit(\n    60 * 1000, // 1 minute\n    100, // 100 requests per minute (was 30)\n    'Too many integration requests, please try again later'\n  )\n};\n\n// Slow down middleware for brute force protection\nconst speedLimiter = slowDown({\n  windowMs: 15 * 60 * 1000, // 15 minutes\n  delayAfter: 5, // allow 5 requests per windowMs without delay\n  delayMs: () => 500, // add 500ms delay per request after delayAfter\n  maxDelayMs: 20000, // max delay of 20 seconds\n  validate: { delayMs: false } // disable warning\n});\n\n// Input sanitization middleware\nconst sanitizeInput = [\n  mongoSanitize({\n    replaceWith: '_',\n    onSanitize: ({ req, key }) => {\n      console.warn(`Sanitized input: ${key} in ${req.method} ${req.path}`);\n    },\n  }),\n];\n\n// Common validation rules\nconst validationRules = {\n  email: body('email')\n    .isEmail()\n    .normalizeEmail()\n    .withMessage('Please provide a valid email address'),\n  \n  password: body('password')\n    .isLength({ min: 8 })\n    .withMessage('Password must be at least 8 characters long')\n    .matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]/)\n    .withMessage('Password must contain at least one uppercase letter, one lowercase letter, one number, and one special character'),\n  \n  name: body('name')\n    .trim()\n    .isLength({ min: 2, max: 50 })\n    .withMessage('Name must be between 2 and 50 characters')\n    .matches(/^[a-zA-Z\\s'-]+$/)\n    .withMessage('Name can only contain letters, spaces, hyphens, and apostrophes'),\n  \n  phone: body('phone')\n    .optional()\n    .isMobilePhone()\n    .withMessage('Please provide a valid phone number'),\n  \n  address: body('address')\n    .optional()\n    .trim()\n    .isLength({ max: 200 })\n    .withMessage('Address must not exceed 200 characters'),\n  \n  price: body('price')\n    .isFloat({ min: 0 })\n    .withMessage('Price must be a positive number'),\n  \n  quantity: body('quantity')\n    .isInt({ min: 1 })\n    .withMessage('Quantity must be a positive integer'),\n};\n\n// Validation error handler\nconst handleValidationErrors = (req, res, next) => {\n  const errors = validationResult(req);\n  \n  if (!errors.isEmpty()) {\n    return res.status(400).json({\n      success: false,\n      error: {\n        code: 'VALIDATION_ERROR',\n        message: 'Invalid input data',\n        details: errors.array().map(error => ({\n          field: error.path,\n          message: error.msg,\n          value: error.value\n        }))\n      }\n    });\n  }\n  \n  next();\n};\n\n// Security headers middleware\nconst securityHeaders = (req, res, next) => {\n  // Additional security headers beyond helmet\n  res.setHeader('X-Content-Type-Options', 'nosniff');\n  res.setHeader('X-Frame-Options', 'DENY');\n  res.setHeader('X-XSS-Protection', '1; mode=block');\n  res.setHeader('Referrer-Policy', 'strict-origin-when-cross-origin');\n  res.setHeader('Permissions-Policy', 'geolocation=(), microphone=(), camera=()');\n  \n  // Remove server information\n  res.removeHeader('X-Powered-By');\n  \n  next();\n};\n\nmodule.exports = {\n  csrfProtection,\n  generateCSRFToken,\n  apiKeyAuth,\n  rateLimits,\n  speedLimiter,\n  sanitizeInput,\n  validationRules,\n  handleValidationErrors,\n  securityHeaders\n};"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,aAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,aAAA;AAfZ,MAAME,MAAM;AAAA;AAAA,CAAAF,aAAA,GAAAG,CAAA,OAAGC,OAAO,CAAC,QAAQ,CAAC;AAChC,MAAMC,aAAa;AAAA;AAAA,CAAAL,aAAA,GAAAG,CAAA,OAAGC,OAAO,CAAC,wBAAwB,CAAC;AACvD,MAAME,SAAS;AAAA;AAAA,CAAAN,aAAA,GAAAG,CAAA,OAAGC,OAAO,CAAC,oBAAoB,CAAC;AAC/C,MAAMG,QAAQ;AAAA;AAAA,CAAAP,aAAA,GAAAG,CAAA,OAAGC,OAAO,CAAC,mBAAmB,CAAC;AAC7C,MAAM;EAAEI,IAAI;EAAEC;AAAiB,CAAC;AAAA;AAAA,CAAAT,aAAA,GAAAG,CAAA,OAAGC,OAAO,CAAC,mBAAmB,CAAC;;AAE/D;AAAA;AAAAJ,aAAA,GAAAG,CAAA;AACA,MAAMO,cAAc,GAAGA,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EAAA;EAAAb,aAAA,GAAAc,CAAA;EAAAd,aAAA,GAAAG,CAAA;EACzC;EACA,IAAI,CAAC,KAAK,EAAE,MAAM,EAAE,SAAS,CAAC,CAACY,QAAQ,CAACJ,GAAG,CAACK,MAAM,CAAC,EAAE;IAAA;IAAAhB,aAAA,GAAAiB,CAAA;IAAAjB,aAAA,GAAAG,CAAA;IACnD,OAAOU,IAAI,CAAC,CAAC;EACf,CAAC;EAAA;EAAA;IAAAb,aAAA,GAAAiB,CAAA;EAAA;;EAED;EAAAjB,aAAA,GAAAG,CAAA;EACA,IAAIQ,GAAG,CAACO,OAAO,CAAC,WAAW,CAAC,EAAE;IAAA;IAAAlB,aAAA,GAAAiB,CAAA;IAAAjB,aAAA,GAAAG,CAAA;IAC5B,OAAOU,IAAI,CAAC,CAAC;EACf,CAAC;EAAA;EAAA;IAAAb,aAAA,GAAAiB,CAAA;EAAA;EAED,MAAME,KAAK;EAAA;EAAA,CAAAnB,aAAA,GAAAG,CAAA;EAAG;EAAA,CAAAH,aAAA,GAAAiB,CAAA,UAAAN,GAAG,CAACO,OAAO,CAAC,cAAc,CAAC;EAAA;EAAA,CAAAlB,aAAA,GAAAiB,CAAA,UAAIN,GAAG,CAACH,IAAI,CAACY,KAAK;EAC3D,MAAMC,YAAY;EAAA;EAAA,CAAArB,aAAA,GAAAG,CAAA,QAAGQ,GAAG,CAACW,OAAO,CAACC,SAAS;EAAC;EAAAvB,aAAA,GAAAG,CAAA;EAE3C;EAAI;EAAA,CAAAH,aAAA,GAAAiB,CAAA,WAACE,KAAK;EAAA;EAAA,CAAAnB,aAAA,GAAAiB,CAAA,UAAI,CAACI,YAAY;EAAA;EAAA,CAAArB,aAAA,GAAAiB,CAAA,UAAIE,KAAK,KAAKE,YAAY,GAAE;IAAA;IAAArB,aAAA,GAAAiB,CAAA;IAAAjB,aAAA,GAAAG,CAAA;IACrD,OAAOS,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAC1BC,OAAO,EAAE,KAAK;MACdC,KAAK,EAAE;QACLC,IAAI,EAAE,qBAAqB;QAC3BC,OAAO,EAAE;MACX;IACF,CAAC,CAAC;EACJ,CAAC;EAAA;EAAA;IAAA7B,aAAA,GAAAiB,CAAA;EAAA;EAAAjB,aAAA,GAAAG,CAAA;EAEDU,IAAI,CAAC,CAAC;AACR,CAAC;;AAED;AAAA;AAAAb,aAAA,GAAAG,CAAA;AACA,MAAM2B,iBAAiB,GAAGA,CAACnB,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EAAA;EAAAb,aAAA,GAAAc,CAAA;EAAAd,aAAA,GAAAG,CAAA;EAC5C,IAAI,CAACQ,GAAG,CAACW,OAAO,CAACC,SAAS,EAAE;IAAA;IAAAvB,aAAA,GAAAiB,CAAA;IAAAjB,aAAA,GAAAG,CAAA;IAC1BQ,GAAG,CAACW,OAAO,CAACC,SAAS,GAAGrB,MAAM,CAAC6B,WAAW,CAAC,EAAE,CAAC,CAACC,QAAQ,CAAC,KAAK,CAAC;EAChE,CAAC;EAAA;EAAA;IAAAhC,aAAA,GAAAiB,CAAA;EAAA;EAAAjB,aAAA,GAAAG,CAAA;EACDU,IAAI,CAAC,CAAC;AACR,CAAC;;AAED;AAAA;AAAAb,aAAA,GAAAG,CAAA;AACA,MAAM8B,UAAU,GAAGA,CAACtB,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EAAA;EAAAb,aAAA,GAAAc,CAAA;EACrC,MAAMoB,MAAM;EAAA;EAAA,CAAAlC,aAAA,GAAAG,CAAA,QAAGQ,GAAG,CAACO,OAAO,CAAC,WAAW,CAAC;EAAC;EAAAlB,aAAA,GAAAG,CAAA;EAExC,IAAI,CAAC+B,MAAM,EAAE;IAAA;IAAAlC,aAAA,GAAAiB,CAAA;IAAAjB,aAAA,GAAAG,CAAA;IACX,OAAOS,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAC1BC,OAAO,EAAE,KAAK;MACdC,KAAK,EAAE;QACLC,IAAI,EAAE,kBAAkB;QACxBC,OAAO,EAAE;MACX;IACF,CAAC,CAAC;EACJ,CAAC;EAAA;EAAA;IAAA7B,aAAA,GAAAiB,CAAA;EAAA;;EAED;EACA,MAAMkB,YAAY;EAAA;EAAA,CAAAnC,aAAA,GAAAG,CAAA;EAAG;EAAA,CAAAH,aAAA,GAAAiB,CAAA,UAAAmB,OAAO,CAACC,GAAG,CAACC,cAAc,EAAEC,KAAK,CAAC,GAAG,CAAC;EAAA;EAAA,CAAAvC,aAAA,GAAAiB,CAAA,UAAI,EAAE;EAAC;EAAAjB,aAAA,GAAAG,CAAA;EAElE,IAAI,CAACgC,YAAY,CAACpB,QAAQ,CAACmB,MAAM,CAAC,EAAE;IAAA;IAAAlC,aAAA,GAAAiB,CAAA;IAAAjB,aAAA,GAAAG,CAAA;IAClC,OAAOS,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAC1BC,OAAO,EAAE,KAAK;MACdC,KAAK,EAAE;QACLC,IAAI,EAAE,iBAAiB;QACvBC,OAAO,EAAE;MACX;IACF,CAAC,CAAC;EACJ,CAAC;EAAA;EAAA;IAAA7B,aAAA,GAAAiB,CAAA;EAAA;EAAAjB,aAAA,GAAAG,CAAA;EAEDQ,GAAG,CAACsB,UAAU,GAAG,IAAI;EAAC;EAAAjC,aAAA,GAAAG,CAAA;EACtBU,IAAI,CAAC,CAAC;AACR,CAAC;;AAED;AAAA;AAAAb,aAAA,GAAAG,CAAA;AACA,MAAMqC,eAAe,GAAGA,CAACC,QAAQ,EAAEC,GAAG,EAAEb,OAAO,KAAK;EAAA;EAAA7B,aAAA,GAAAc,CAAA;EAAAd,aAAA,GAAAG,CAAA;EAClD,OAAOG,SAAS,CAAC;IACfmC,QAAQ;IACRC,GAAG;IACHb,OAAO,EAAE;MACPH,OAAO,EAAE,KAAK;MACdC,KAAK,EAAE;QACLC,IAAI,EAAE,qBAAqB;QAC3BC;MACF;IACF,CAAC;IACDc,eAAe,EAAE,IAAI;IACrBC,aAAa,EAAE;EACjB,CAAC,CAAC;AACJ,CAAC;;AAED;AACA;AACA,MAAMC,UAAU;AAAA;AAAA,CAAA7C,aAAA,GAAAG,CAAA,QAAG;EACjB;EACA2C,OAAO,EAAEN,eAAe,CACtB,EAAE,GAAG,EAAE,GAAG,IAAI;EAAE;EAChB,GAAG;EAAE;EACL,2CACF,CAAC;EAED;EACAO,IAAI,EAAEP,eAAe,CACnB,EAAE,GAAG,EAAE,GAAG,IAAI;EAAE;EAChB,EAAE;EAAE;EACJ,0DACF,CAAC;EAED;EACAQ,OAAO,EAAER,eAAe,CACtB,EAAE,GAAG,EAAE,GAAG,IAAI;EAAE;EAChB,EAAE;EAAE;EACJ,mDACF,CAAC;EAED;EACAS,KAAK,EAAET,eAAe,CACpB,EAAE,GAAG,EAAE,GAAG,IAAI;EAAE;EAChB,GAAG;EAAE;EACL,iDACF,CAAC;EAED;EACAU,WAAW,EAAEV,eAAe,CAC1B,EAAE,GAAG,IAAI;EAAE;EACX,GAAG;EAAE;EACL,uDACF;AACF,CAAC;;AAED;AACA,MAAMW,YAAY;AAAA;AAAA,CAAAnD,aAAA,GAAAG,CAAA,QAAGI,QAAQ,CAAC;EAC5BkC,QAAQ,EAAE,EAAE,GAAG,EAAE,GAAG,IAAI;EAAE;EAC1BW,UAAU,EAAE,CAAC;EAAE;EACfC,OAAO,EAAEA,CAAA,KAAM;IAAA;IAAArD,aAAA,GAAAc,CAAA;IAAAd,aAAA,GAAAG,CAAA;IAAA,UAAG;EAAD,CAAC;EAAE;EACpBmD,UAAU,EAAE,KAAK;EAAE;EACnBC,QAAQ,EAAE;IAAEF,OAAO,EAAE;EAAM,CAAC,CAAC;AAC/B,CAAC,CAAC;;AAEF;AACA,MAAMG,aAAa;AAAA;AAAA,CAAAxD,aAAA,GAAAG,CAAA,QAAG,CACpBE,aAAa,CAAC;EACZoD,WAAW,EAAE,GAAG;EAChBC,UAAU,EAAEA,CAAC;IAAE/C,GAAG;IAAEgD;EAAI,CAAC,KAAK;IAAA;IAAA3D,aAAA,GAAAc,CAAA;IAAAd,aAAA,GAAAG,CAAA;IAC5ByD,OAAO,CAACC,IAAI,CAAC,oBAAoBF,GAAG,OAAOhD,GAAG,CAACK,MAAM,IAAIL,GAAG,CAACmD,IAAI,EAAE,CAAC;EACtE;AACF,CAAC,CAAC,CACH;;AAED;AACA,MAAMC,eAAe;AAAA;AAAA,CAAA/D,aAAA,GAAAG,CAAA,QAAG;EACtB6D,KAAK,EAAExD,IAAI,CAAC,OAAO,CAAC,CACjByD,OAAO,CAAC,CAAC,CACTC,cAAc,CAAC,CAAC,CAChBC,WAAW,CAAC,sCAAsC,CAAC;EAEtDC,QAAQ,EAAE5D,IAAI,CAAC,UAAU,CAAC,CACvB6D,QAAQ,CAAC;IAAEC,GAAG,EAAE;EAAE,CAAC,CAAC,CACpBH,WAAW,CAAC,6CAA6C,CAAC,CAC1DI,OAAO,CAAC,iEAAiE,CAAC,CAC1EJ,WAAW,CAAC,kHAAkH,CAAC;EAElIK,IAAI,EAAEhE,IAAI,CAAC,MAAM,CAAC,CACfiE,IAAI,CAAC,CAAC,CACNJ,QAAQ,CAAC;IAAEC,GAAG,EAAE,CAAC;IAAE5B,GAAG,EAAE;EAAG,CAAC,CAAC,CAC7ByB,WAAW,CAAC,0CAA0C,CAAC,CACvDI,OAAO,CAAC,iBAAiB,CAAC,CAC1BJ,WAAW,CAAC,iEAAiE,CAAC;EAEjFO,KAAK,EAAElE,IAAI,CAAC,OAAO,CAAC,CACjBmE,QAAQ,CAAC,CAAC,CACVC,aAAa,CAAC,CAAC,CACfT,WAAW,CAAC,qCAAqC,CAAC;EAErDU,OAAO,EAAErE,IAAI,CAAC,SAAS,CAAC,CACrBmE,QAAQ,CAAC,CAAC,CACVF,IAAI,CAAC,CAAC,CACNJ,QAAQ,CAAC;IAAE3B,GAAG,EAAE;EAAI,CAAC,CAAC,CACtByB,WAAW,CAAC,wCAAwC,CAAC;EAExDW,KAAK,EAAEtE,IAAI,CAAC,OAAO,CAAC,CACjBuE,OAAO,CAAC;IAAET,GAAG,EAAE;EAAE,CAAC,CAAC,CACnBH,WAAW,CAAC,iCAAiC,CAAC;EAEjDa,QAAQ,EAAExE,IAAI,CAAC,UAAU,CAAC,CACvByE,KAAK,CAAC;IAAEX,GAAG,EAAE;EAAE,CAAC,CAAC,CACjBH,WAAW,CAAC,qCAAqC;AACtD,CAAC;;AAED;AAAA;AAAAnE,aAAA,GAAAG,CAAA;AACA,MAAM+E,sBAAsB,GAAGA,CAACvE,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EAAA;EAAAb,aAAA,GAAAc,CAAA;EACjD,MAAMqE,MAAM;EAAA;EAAA,CAAAnF,aAAA,GAAAG,CAAA,QAAGM,gBAAgB,CAACE,GAAG,CAAC;EAAC;EAAAX,aAAA,GAAAG,CAAA;EAErC,IAAI,CAACgF,MAAM,CAACC,OAAO,CAAC,CAAC,EAAE;IAAA;IAAApF,aAAA,GAAAiB,CAAA;IAAAjB,aAAA,GAAAG,CAAA;IACrB,OAAOS,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAC1BC,OAAO,EAAE,KAAK;MACdC,KAAK,EAAE;QACLC,IAAI,EAAE,kBAAkB;QACxBC,OAAO,EAAE,oBAAoB;QAC7BwD,OAAO,EAAEF,MAAM,CAACG,KAAK,CAAC,CAAC,CAACC,GAAG,CAAC5D,KAAK,IAAK;UAAA;UAAA3B,aAAA,GAAAc,CAAA;UAAAd,aAAA,GAAAG,CAAA;UAAA;YACpCqF,KAAK,EAAE7D,KAAK,CAACmC,IAAI;YACjBjC,OAAO,EAAEF,KAAK,CAAC8D,GAAG;YAClBC,KAAK,EAAE/D,KAAK,CAAC+D;UACf,CAAC;QAAD,CAAE;MACJ;IACF,CAAC,CAAC;EACJ,CAAC;EAAA;EAAA;IAAA1F,aAAA,GAAAiB,CAAA;EAAA;EAAAjB,aAAA,GAAAG,CAAA;EAEDU,IAAI,CAAC,CAAC;AACR,CAAC;;AAED;AAAA;AAAAb,aAAA,GAAAG,CAAA;AACA,MAAMwF,eAAe,GAAGA,CAAChF,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EAAA;EAAAb,aAAA,GAAAc,CAAA;EAAAd,aAAA,GAAAG,CAAA;EAC1C;EACAS,GAAG,CAACgF,SAAS,CAAC,wBAAwB,EAAE,SAAS,CAAC;EAAC;EAAA5F,aAAA,GAAAG,CAAA;EACnDS,GAAG,CAACgF,SAAS,CAAC,iBAAiB,EAAE,MAAM,CAAC;EAAC;EAAA5F,aAAA,GAAAG,CAAA;EACzCS,GAAG,CAACgF,SAAS,CAAC,kBAAkB,EAAE,eAAe,CAAC;EAAC;EAAA5F,aAAA,GAAAG,CAAA;EACnDS,GAAG,CAACgF,SAAS,CAAC,iBAAiB,EAAE,iCAAiC,CAAC;EAAC;EAAA5F,aAAA,GAAAG,CAAA;EACpES,GAAG,CAACgF,SAAS,CAAC,oBAAoB,EAAE,0CAA0C,CAAC;;EAE/E;EAAA;EAAA5F,aAAA,GAAAG,CAAA;EACAS,GAAG,CAACiF,YAAY,CAAC,cAAc,CAAC;EAAC;EAAA7F,aAAA,GAAAG,CAAA;EAEjCU,IAAI,CAAC,CAAC;AACR,CAAC;AAAC;AAAAb,aAAA,GAAAG,CAAA;AAEF2F,MAAM,CAACC,OAAO,GAAG;EACfrF,cAAc;EACdoB,iBAAiB;EACjBG,UAAU;EACVY,UAAU;EACVM,YAAY;EACZK,aAAa;EACbO,eAAe;EACfmB,sBAAsB;EACtBS;AACF,CAAC","ignoreList":[]}