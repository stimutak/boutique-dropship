09fded5416beab0b1b622f512fb9db69
const express = require('express');
const mongoose = require('mongoose');
const cors = require('cors');
const helmet = require('helmet');
const rateLimit = require('express-rate-limit');
const session = require('express-session');
const MongoStore = require('connect-mongo');
const path = require('path');
require('dotenv').config();

// Import logging and error handling
const {
  logger
} = require('./utils/logger');
const {
  globalErrorHandler
} = require('./middleware/errorHandler');
const {
  rateLimits,
  speedLimiter,
  sanitizeInput,
  securityHeaders
} = require('./middleware/security');
const app = express();

// Security middleware
app.use(helmet());
app.use(securityHeaders);
app.use(cors({
  origin: process.env.ALLOWED_ORIGINS?.split(',') || ['http://localhost:3000', 'http://localhost:3001', 'http://localhost:3003', 'http://localhost:5173'],
  credentials: true
}));

// Input sanitization
app.use(sanitizeInput);

// General rate limiting
app.use(rateLimits.general);

// Speed limiting for brute force protection
app.use(speedLimiter);

// Import unified session/CSRF management
const {
  createSessionConfig,
  generateCSRFToken,
  validateCSRFToken,
  enhanceGuestSession,
  cleanupGuestSession
} = require('./middleware/sessionCSRF');

// Session middleware with unified config
const mongoUrl = process.env.MONGODB_URI || 'mongodb://localhost:27017/holistic-store';
app.use(session(createSessionConfig(mongoUrl)));

// Session enhancement middleware
app.use(generateCSRFToken);
app.use(enhanceGuestSession);
app.use(cleanupGuestSession);

// Body parsing middleware
app.use(express.json({
  limit: '10mb'
}));
app.use(express.urlencoded({
  extended: true
}));

// Static files
app.use('/uploads', express.static('uploads'));
app.use(express.static('public'));

// Database connection
mongoose.connect(process.env.MONGODB_URI || 'mongodb://localhost:27017/holistic-store', {
  useNewUrlParser: true,
  useUnifiedTopology: true
}).then(() => {
  console.log('Connected to MongoDB');
}).catch(error => {
  console.warn('MongoDB connection failed:', error.message);
  console.warn('Running in development mode without database');
});

// Handle MongoDB connection events
mongoose.connection.on('error', error => {
  console.warn('MongoDB connection error:', error.message);
});
mongoose.connection.on('disconnected', () => {
  console.warn('MongoDB disconnected');
});

// Routes with specific rate limiting
app.use('/api/auth', rateLimits.auth, require('./routes/auth'));
app.use('/api/products', require('./routes/products'));
app.use('/api/cart', require('./routes/cart'));
app.use('/api/orders', require('./routes/orders'));
app.use('/api/payments', rateLimits.payment, require('./routes/payments'));
app.use('/api/wholesalers', require('./routes/wholesalers'));
app.use('/api/integration', rateLimits.integration, require('./routes/integration'));
app.use('/api/admin', rateLimits.admin, require('./routes/admin'));
app.use('/api/monitoring', require('./routes/monitoring'));

// Health check
app.get('/health', (req, res) => {
  res.json({
    status: 'OK',
    timestamp: new Date().toISOString()
  });
});

// CSRF token endpoint
app.get('/api/csrf-token', (req, res) => {
  res.json({
    success: true,
    csrfToken: req.session.csrfToken,
    sessionInfo: {
      isGuest: !req.user && !!req.session.guestId,
      hasCart: !!req.session.cart && !!req.session.cart.items && req.session.cart.items.length > 0
    }
  });
});

// Root route for API info
app.get('/', (req, res) => {
  res.json({
    message: 'Holistic Dropship Store API',
    version: '1.0.0',
    endpoints: {
      health: '/health',
      auth: '/api/auth',
      products: '/api/products',
      cart: '/api/cart',
      orders: '/api/orders',
      payments: '/api/payments'
    },
    frontend: process.env.FRONTEND_URL || 'http://localhost:3000'
  });
});

// Global error handling middleware (must be last)
app.use(globalErrorHandler);

// Serve React app in production
if (process.env.NODE_ENV === 'production') {
  app.get('*', (req, res) => {
    res.sendFile(path.join(__dirname, 'build', 'index.html'));
  });
}
const PORT = process.env.PORT || 5000;

// Only start server if not in test mode
if (process.env.NODE_ENV !== 'test') {
  app.listen(PORT, () => {
    logger.info(`Server running on port ${PORT}`);
  });
}

// Export app for testing
module.exports = app;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsIm1vbmdvb3NlIiwiY29ycyIsImhlbG1ldCIsInJhdGVMaW1pdCIsInNlc3Npb24iLCJNb25nb1N0b3JlIiwicGF0aCIsImNvbmZpZyIsImxvZ2dlciIsImdsb2JhbEVycm9ySGFuZGxlciIsInJhdGVMaW1pdHMiLCJzcGVlZExpbWl0ZXIiLCJzYW5pdGl6ZUlucHV0Iiwic2VjdXJpdHlIZWFkZXJzIiwiYXBwIiwidXNlIiwib3JpZ2luIiwicHJvY2VzcyIsImVudiIsIkFMTE9XRURfT1JJR0lOUyIsInNwbGl0IiwiY3JlZGVudGlhbHMiLCJnZW5lcmFsIiwiY3JlYXRlU2Vzc2lvbkNvbmZpZyIsImdlbmVyYXRlQ1NSRlRva2VuIiwidmFsaWRhdGVDU1JGVG9rZW4iLCJlbmhhbmNlR3Vlc3RTZXNzaW9uIiwiY2xlYW51cEd1ZXN0U2Vzc2lvbiIsIm1vbmdvVXJsIiwiTU9OR09EQl9VUkkiLCJqc29uIiwibGltaXQiLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJzdGF0aWMiLCJjb25uZWN0IiwidXNlTmV3VXJsUGFyc2VyIiwidXNlVW5pZmllZFRvcG9sb2d5IiwidGhlbiIsImNvbnNvbGUiLCJsb2ciLCJjYXRjaCIsImVycm9yIiwid2FybiIsIm1lc3NhZ2UiLCJjb25uZWN0aW9uIiwib24iLCJhdXRoIiwicGF5bWVudCIsImludGVncmF0aW9uIiwiYWRtaW4iLCJnZXQiLCJyZXEiLCJyZXMiLCJzdGF0dXMiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzdWNjZXNzIiwiY3NyZlRva2VuIiwic2Vzc2lvbkluZm8iLCJpc0d1ZXN0IiwidXNlciIsImd1ZXN0SWQiLCJoYXNDYXJ0IiwiY2FydCIsIml0ZW1zIiwibGVuZ3RoIiwidmVyc2lvbiIsImVuZHBvaW50cyIsImhlYWx0aCIsInByb2R1Y3RzIiwib3JkZXJzIiwicGF5bWVudHMiLCJmcm9udGVuZCIsIkZST05URU5EX1VSTCIsIk5PREVfRU5WIiwic2VuZEZpbGUiLCJqb2luIiwiX19kaXJuYW1lIiwiUE9SVCIsImxpc3RlbiIsImluZm8iLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsic2VydmVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7XG5jb25zdCBjb3JzID0gcmVxdWlyZSgnY29ycycpO1xuY29uc3QgaGVsbWV0ID0gcmVxdWlyZSgnaGVsbWV0Jyk7XG5jb25zdCByYXRlTGltaXQgPSByZXF1aXJlKCdleHByZXNzLXJhdGUtbGltaXQnKTtcbmNvbnN0IHNlc3Npb24gPSByZXF1aXJlKCdleHByZXNzLXNlc3Npb24nKTtcbmNvbnN0IE1vbmdvU3RvcmUgPSByZXF1aXJlKCdjb25uZWN0LW1vbmdvJyk7XG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xucmVxdWlyZSgnZG90ZW52JykuY29uZmlnKCk7XG5cbi8vIEltcG9ydCBsb2dnaW5nIGFuZCBlcnJvciBoYW5kbGluZ1xuY29uc3QgeyBsb2dnZXIgfSA9IHJlcXVpcmUoJy4vdXRpbHMvbG9nZ2VyJyk7XG5jb25zdCB7IGdsb2JhbEVycm9ySGFuZGxlciB9ID0gcmVxdWlyZSgnLi9taWRkbGV3YXJlL2Vycm9ySGFuZGxlcicpO1xuY29uc3QgeyBcbiAgcmF0ZUxpbWl0cywgXG4gIHNwZWVkTGltaXRlciwgXG4gIHNhbml0aXplSW5wdXQsIFxuICBzZWN1cml0eUhlYWRlcnMgXG59ID0gcmVxdWlyZSgnLi9taWRkbGV3YXJlL3NlY3VyaXR5Jyk7XG5cbmNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcblxuLy8gU2VjdXJpdHkgbWlkZGxld2FyZVxuYXBwLnVzZShoZWxtZXQoKSk7XG5hcHAudXNlKHNlY3VyaXR5SGVhZGVycyk7XG5hcHAudXNlKGNvcnMoe1xuICBvcmlnaW46IHByb2Nlc3MuZW52LkFMTE9XRURfT1JJR0lOUz8uc3BsaXQoJywnKSB8fCBbJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCcsICdodHRwOi8vbG9jYWxob3N0OjMwMDEnLCAnaHR0cDovL2xvY2FsaG9zdDozMDAzJywgJ2h0dHA6Ly9sb2NhbGhvc3Q6NTE3MyddLFxuICBjcmVkZW50aWFsczogdHJ1ZVxufSkpO1xuXG4vLyBJbnB1dCBzYW5pdGl6YXRpb25cbmFwcC51c2Uoc2FuaXRpemVJbnB1dCk7XG5cbi8vIEdlbmVyYWwgcmF0ZSBsaW1pdGluZ1xuYXBwLnVzZShyYXRlTGltaXRzLmdlbmVyYWwpO1xuXG4vLyBTcGVlZCBsaW1pdGluZyBmb3IgYnJ1dGUgZm9yY2UgcHJvdGVjdGlvblxuYXBwLnVzZShzcGVlZExpbWl0ZXIpO1xuXG4vLyBJbXBvcnQgdW5pZmllZCBzZXNzaW9uL0NTUkYgbWFuYWdlbWVudFxuY29uc3QgeyBcbiAgY3JlYXRlU2Vzc2lvbkNvbmZpZywgXG4gIGdlbmVyYXRlQ1NSRlRva2VuLFxuICB2YWxpZGF0ZUNTUkZUb2tlbixcbiAgZW5oYW5jZUd1ZXN0U2Vzc2lvbixcbiAgY2xlYW51cEd1ZXN0U2Vzc2lvbiBcbn0gPSByZXF1aXJlKCcuL21pZGRsZXdhcmUvc2Vzc2lvbkNTUkYnKTtcblxuLy8gU2Vzc2lvbiBtaWRkbGV3YXJlIHdpdGggdW5pZmllZCBjb25maWdcbmNvbnN0IG1vbmdvVXJsID0gcHJvY2Vzcy5lbnYuTU9OR09EQl9VUkkgfHwgJ21vbmdvZGI6Ly9sb2NhbGhvc3Q6MjcwMTcvaG9saXN0aWMtc3RvcmUnO1xuYXBwLnVzZShzZXNzaW9uKGNyZWF0ZVNlc3Npb25Db25maWcobW9uZ29VcmwpKSk7XG5cbi8vIFNlc3Npb24gZW5oYW5jZW1lbnQgbWlkZGxld2FyZVxuYXBwLnVzZShnZW5lcmF0ZUNTUkZUb2tlbik7XG5hcHAudXNlKGVuaGFuY2VHdWVzdFNlc3Npb24pO1xuYXBwLnVzZShjbGVhbnVwR3Vlc3RTZXNzaW9uKTtcblxuLy8gQm9keSBwYXJzaW5nIG1pZGRsZXdhcmVcbmFwcC51c2UoZXhwcmVzcy5qc29uKHsgbGltaXQ6ICcxMG1iJyB9KSk7XG5hcHAudXNlKGV4cHJlc3MudXJsZW5jb2RlZCh7IGV4dGVuZGVkOiB0cnVlIH0pKTtcblxuLy8gU3RhdGljIGZpbGVzXG5hcHAudXNlKCcvdXBsb2FkcycsIGV4cHJlc3Muc3RhdGljKCd1cGxvYWRzJykpO1xuYXBwLnVzZShleHByZXNzLnN0YXRpYygncHVibGljJykpO1xuXG4vLyBEYXRhYmFzZSBjb25uZWN0aW9uXG5tb25nb29zZS5jb25uZWN0KHByb2Nlc3MuZW52Lk1PTkdPREJfVVJJIHx8ICdtb25nb2RiOi8vbG9jYWxob3N0OjI3MDE3L2hvbGlzdGljLXN0b3JlJywge1xuICB1c2VOZXdVcmxQYXJzZXI6IHRydWUsXG4gIHVzZVVuaWZpZWRUb3BvbG9neTogdHJ1ZSxcbn0pLnRoZW4oKCkgPT4ge1xuICBjb25zb2xlLmxvZygnQ29ubmVjdGVkIHRvIE1vbmdvREInKTtcbn0pLmNhdGNoKChlcnJvcikgPT4ge1xuICBjb25zb2xlLndhcm4oJ01vbmdvREIgY29ubmVjdGlvbiBmYWlsZWQ6JywgZXJyb3IubWVzc2FnZSk7XG4gIGNvbnNvbGUud2FybignUnVubmluZyBpbiBkZXZlbG9wbWVudCBtb2RlIHdpdGhvdXQgZGF0YWJhc2UnKTtcbn0pO1xuXG4vLyBIYW5kbGUgTW9uZ29EQiBjb25uZWN0aW9uIGV2ZW50c1xubW9uZ29vc2UuY29ubmVjdGlvbi5vbignZXJyb3InLCAoZXJyb3IpID0+IHtcbiAgY29uc29sZS53YXJuKCdNb25nb0RCIGNvbm5lY3Rpb24gZXJyb3I6JywgZXJyb3IubWVzc2FnZSk7XG59KTtcblxubW9uZ29vc2UuY29ubmVjdGlvbi5vbignZGlzY29ubmVjdGVkJywgKCkgPT4ge1xuICBjb25zb2xlLndhcm4oJ01vbmdvREIgZGlzY29ubmVjdGVkJyk7XG59KTtcblxuLy8gUm91dGVzIHdpdGggc3BlY2lmaWMgcmF0ZSBsaW1pdGluZ1xuYXBwLnVzZSgnL2FwaS9hdXRoJywgcmF0ZUxpbWl0cy5hdXRoLCByZXF1aXJlKCcuL3JvdXRlcy9hdXRoJykpO1xuYXBwLnVzZSgnL2FwaS9wcm9kdWN0cycsIHJlcXVpcmUoJy4vcm91dGVzL3Byb2R1Y3RzJykpO1xuYXBwLnVzZSgnL2FwaS9jYXJ0JywgcmVxdWlyZSgnLi9yb3V0ZXMvY2FydCcpKTtcbmFwcC51c2UoJy9hcGkvb3JkZXJzJywgcmVxdWlyZSgnLi9yb3V0ZXMvb3JkZXJzJykpO1xuYXBwLnVzZSgnL2FwaS9wYXltZW50cycsIHJhdGVMaW1pdHMucGF5bWVudCwgcmVxdWlyZSgnLi9yb3V0ZXMvcGF5bWVudHMnKSk7XG5hcHAudXNlKCcvYXBpL3dob2xlc2FsZXJzJywgcmVxdWlyZSgnLi9yb3V0ZXMvd2hvbGVzYWxlcnMnKSk7XG5hcHAudXNlKCcvYXBpL2ludGVncmF0aW9uJywgcmF0ZUxpbWl0cy5pbnRlZ3JhdGlvbiwgcmVxdWlyZSgnLi9yb3V0ZXMvaW50ZWdyYXRpb24nKSk7XG5hcHAudXNlKCcvYXBpL2FkbWluJywgcmF0ZUxpbWl0cy5hZG1pbiwgcmVxdWlyZSgnLi9yb3V0ZXMvYWRtaW4nKSk7XG5hcHAudXNlKCcvYXBpL21vbml0b3JpbmcnLCByZXF1aXJlKCcuL3JvdXRlcy9tb25pdG9yaW5nJykpO1xuXG4vLyBIZWFsdGggY2hlY2tcbmFwcC5nZXQoJy9oZWFsdGgnLCAocmVxLCByZXMpID0+IHtcbiAgcmVzLmpzb24oeyBzdGF0dXM6ICdPSycsIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpIH0pO1xufSk7XG5cbi8vIENTUkYgdG9rZW4gZW5kcG9pbnRcbmFwcC5nZXQoJy9hcGkvY3NyZi10b2tlbicsIChyZXEsIHJlcykgPT4ge1xuICByZXMuanNvbih7IFxuICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgY3NyZlRva2VuOiByZXEuc2Vzc2lvbi5jc3JmVG9rZW4sXG4gICAgc2Vzc2lvbkluZm86IHtcbiAgICAgIGlzR3Vlc3Q6ICFyZXEudXNlciAmJiAhIXJlcS5zZXNzaW9uLmd1ZXN0SWQsXG4gICAgICBoYXNDYXJ0OiAhIXJlcS5zZXNzaW9uLmNhcnQgJiYgISFyZXEuc2Vzc2lvbi5jYXJ0Lml0ZW1zICYmIHJlcS5zZXNzaW9uLmNhcnQuaXRlbXMubGVuZ3RoID4gMFxuICAgIH1cbiAgfSk7XG59KTtcblxuLy8gUm9vdCByb3V0ZSBmb3IgQVBJIGluZm9cbmFwcC5nZXQoJy8nLCAocmVxLCByZXMpID0+IHtcbiAgcmVzLmpzb24oe1xuICAgIG1lc3NhZ2U6ICdIb2xpc3RpYyBEcm9wc2hpcCBTdG9yZSBBUEknLFxuICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgZW5kcG9pbnRzOiB7XG4gICAgICBoZWFsdGg6ICcvaGVhbHRoJyxcbiAgICAgIGF1dGg6ICcvYXBpL2F1dGgnLFxuICAgICAgcHJvZHVjdHM6ICcvYXBpL3Byb2R1Y3RzJyxcbiAgICAgIGNhcnQ6ICcvYXBpL2NhcnQnLFxuICAgICAgb3JkZXJzOiAnL2FwaS9vcmRlcnMnLFxuICAgICAgcGF5bWVudHM6ICcvYXBpL3BheW1lbnRzJ1xuICAgIH0sXG4gICAgZnJvbnRlbmQ6IHByb2Nlc3MuZW52LkZST05URU5EX1VSTCB8fCAnaHR0cDovL2xvY2FsaG9zdDozMDAwJ1xuICB9KTtcbn0pO1xuXG4vLyBHbG9iYWwgZXJyb3IgaGFuZGxpbmcgbWlkZGxld2FyZSAobXVzdCBiZSBsYXN0KVxuYXBwLnVzZShnbG9iYWxFcnJvckhhbmRsZXIpO1xuXG4vLyBTZXJ2ZSBSZWFjdCBhcHAgaW4gcHJvZHVjdGlvblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicpIHtcbiAgYXBwLmdldCgnKicsIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5zZW5kRmlsZShwYXRoLmpvaW4oX19kaXJuYW1lLCAnYnVpbGQnLCAnaW5kZXguaHRtbCcpKTtcbiAgfSk7XG59XG5cbmNvbnN0IFBPUlQgPSBwcm9jZXNzLmVudi5QT1JUIHx8IDUwMDA7XG5cbi8vIE9ubHkgc3RhcnQgc2VydmVyIGlmIG5vdCBpbiB0ZXN0IG1vZGVcbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Rlc3QnKSB7XG4gIGFwcC5saXN0ZW4oUE9SVCwgKCkgPT4ge1xuICAgIGxvZ2dlci5pbmZvKGBTZXJ2ZXIgcnVubmluZyBvbiBwb3J0ICR7UE9SVH1gKTtcbiAgfSk7XG59XG5cbi8vIEV4cG9ydCBhcHAgZm9yIHRlc3Rpbmdcbm1vZHVsZS5leHBvcnRzID0gYXBwOyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsU0FBUyxDQUFDO0FBQ2xDLE1BQU1DLFFBQVEsR0FBR0QsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUNwQyxNQUFNRSxJQUFJLEdBQUdGLE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFDNUIsTUFBTUcsTUFBTSxHQUFHSCxPQUFPLENBQUMsUUFBUSxDQUFDO0FBQ2hDLE1BQU1JLFNBQVMsR0FBR0osT0FBTyxDQUFDLG9CQUFvQixDQUFDO0FBQy9DLE1BQU1LLE9BQU8sR0FBR0wsT0FBTyxDQUFDLGlCQUFpQixDQUFDO0FBQzFDLE1BQU1NLFVBQVUsR0FBR04sT0FBTyxDQUFDLGVBQWUsQ0FBQztBQUMzQyxNQUFNTyxJQUFJLEdBQUdQLE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFDNUJBLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQ1EsTUFBTSxDQUFDLENBQUM7O0FBRTFCO0FBQ0EsTUFBTTtFQUFFQztBQUFPLENBQUMsR0FBR1QsT0FBTyxDQUFDLGdCQUFnQixDQUFDO0FBQzVDLE1BQU07RUFBRVU7QUFBbUIsQ0FBQyxHQUFHVixPQUFPLENBQUMsMkJBQTJCLENBQUM7QUFDbkUsTUFBTTtFQUNKVyxVQUFVO0VBQ1ZDLFlBQVk7RUFDWkMsYUFBYTtFQUNiQztBQUNGLENBQUMsR0FBR2QsT0FBTyxDQUFDLHVCQUF1QixDQUFDO0FBRXBDLE1BQU1lLEdBQUcsR0FBR2hCLE9BQU8sQ0FBQyxDQUFDOztBQUVyQjtBQUNBZ0IsR0FBRyxDQUFDQyxHQUFHLENBQUNiLE1BQU0sQ0FBQyxDQUFDLENBQUM7QUFDakJZLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDRixlQUFlLENBQUM7QUFDeEJDLEdB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