81c37c20e875e0dee0b97ee8172f9265
const express = require('express');
const mongoose = require('mongoose');
const cors = require('cors');
const helmet = require('helmet');
const rateLimit = require('express-rate-limit');
const session = require('express-session');
const MongoStore = require('connect-mongo');
const path = require('path');
require('dotenv').config();

// Import logging and error handling
const {
  logger
} = require('./utils/logger');
const {
  globalErrorHandler
} = require('./middleware/errorHandler');
const {
  generateCSRFToken,
  csrfProtection,
  rateLimits,
  speedLimiter,
  sanitizeInput,
  securityHeaders
} = require('./middleware/security');
const app = express();

// Security middleware
app.use(helmet());
app.use(securityHeaders);
app.use(cors({
  origin: process.env.ALLOWED_ORIGINS?.split(',') || ['http://localhost:3000', 'http://localhost:3001', 'http://localhost:3003', 'http://localhost:5173'],
  credentials: true
}));

// Input sanitization
app.use(sanitizeInput);

// General rate limiting
app.use(rateLimits.general);

// Speed limiting for brute force protection
app.use(speedLimiter);

// Import unified session/CSRF management
const {
  createSessionConfig,
  generateCSRFToken: unifiedCSRFToken,
  enhanceGuestSession,
  cleanupGuestSession
} = require('./middleware/sessionCSRF');

// Session middleware with unified config
const mongoUrl = process.env.MONGODB_URI || 'mongodb://localhost:27017/holistic-store';
app.use(session(createSessionConfig(mongoUrl)));

// Session enhancement middleware
app.use(unifiedCSRFToken);
app.use(enhanceGuestSession);
app.use(cleanupGuestSession);

// Body parsing middleware
app.use(express.json({
  limit: '10mb'
}));
app.use(express.urlencoded({
  extended: true
}));

// Static files
app.use('/uploads', express.static('uploads'));
app.use(express.static('public'));

// Database connection
mongoose.connect(process.env.MONGODB_URI || 'mongodb://localhost:27017/holistic-store', {
  useNewUrlParser: true,
  useUnifiedTopology: true
}).then(() => {
  console.log('Connected to MongoDB');
}).catch(error => {
  console.warn('MongoDB connection failed:', error.message);
  console.warn('Running in development mode without database');
});

// Handle MongoDB connection events
mongoose.connection.on('error', error => {
  console.warn('MongoDB connection error:', error.message);
});
mongoose.connection.on('disconnected', () => {
  console.warn('MongoDB disconnected');
});

// Routes with specific rate limiting
app.use('/api/auth', rateLimits.auth, require('./routes/auth'));
app.use('/api/products', require('./routes/products'));
app.use('/api/cart', csrfProtection, require('./routes/cart'));
app.use('/api/orders', csrfProtection, require('./routes/orders'));
app.use('/api/payments', rateLimits.payment, csrfProtection, require('./routes/payments'));
app.use('/api/wholesalers', require('./routes/wholesalers'));
app.use('/api/integration', rateLimits.integration, require('./routes/integration'));
app.use('/api/admin', rateLimits.admin, csrfProtection, require('./routes/admin'));
app.use('/api/monitoring', require('./routes/monitoring'));

// Health check
app.get('/health', (req, res) => {
  res.json({
    status: 'OK',
    timestamp: new Date().toISOString()
  });
});

// CSRF token endpoint
app.get('/api/csrf-token', (req, res) => {
  res.json({
    success: true,
    csrfToken: req.session.csrfToken,
    sessionInfo: {
      isGuest: !req.user && !!req.session.guestId,
      hasCart: !!req.session.cart && req.session.cart.items.length > 0
    }
  });
});

// Root route for API info
app.get('/', (req, res) => {
  res.json({
    message: 'Holistic Dropship Store API',
    version: '1.0.0',
    endpoints: {
      health: '/health',
      auth: '/api/auth',
      products: '/api/products',
      cart: '/api/cart',
      orders: '/api/orders',
      payments: '/api/payments'
    },
    frontend: process.env.FRONTEND_URL || 'http://localhost:3000'
  });
});

// Global error handling middleware (must be last)
app.use(globalErrorHandler);

// Serve React app in production
if (process.env.NODE_ENV === 'production') {
  app.get('*', (req, res) => {
    res.sendFile(path.join(__dirname, 'build', 'index.html'));
  });
}
const PORT = process.env.PORT || 5000;

// Only start server if not in test mode
if (process.env.NODE_ENV !== 'test') {
  app.listen(PORT, () => {
    logger.info(`Server running on port ${PORT}`);
  });
}

// Export app for testing
module.exports = app;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsIm1vbmdvb3NlIiwiY29ycyIsImhlbG1ldCIsInJhdGVMaW1pdCIsInNlc3Npb24iLCJNb25nb1N0b3JlIiwicGF0aCIsImNvbmZpZyIsImxvZ2dlciIsImdsb2JhbEVycm9ySGFuZGxlciIsImdlbmVyYXRlQ1NSRlRva2VuIiwiY3NyZlByb3RlY3Rpb24iLCJyYXRlTGltaXRzIiwic3BlZWRMaW1pdGVyIiwic2FuaXRpemVJbnB1dCIsInNlY3VyaXR5SGVhZGVycyIsImFwcCIsInVzZSIsIm9yaWdpbiIsInByb2Nlc3MiLCJlbnYiLCJBTExPV0VEX09SSUdJTlMiLCJzcGxpdCIsImNyZWRlbnRpYWxzIiwiZ2VuZXJhbCIsImNyZWF0ZVNlc3Npb25Db25maWciLCJ1bmlmaWVkQ1NSRlRva2VuIiwiZW5oYW5jZUd1ZXN0U2Vzc2lvbiIsImNsZWFudXBHdWVzdFNlc3Npb24iLCJtb25nb1VybCIsIk1PTkdPREJfVVJJIiwianNvbiIsImxpbWl0IiwidXJsZW5jb2RlZCIsImV4dGVuZGVkIiwic3RhdGljIiwiY29ubmVjdCIsInVzZU5ld1VybFBhcnNlciIsInVzZVVuaWZpZWRUb3BvbG9neSIsInRoZW4iLCJjb25zb2xlIiwibG9nIiwiY2F0Y2giLCJlcnJvciIsIndhcm4iLCJtZXNzYWdlIiwiY29ubmVjdGlvbiIsIm9uIiwiYXV0aCIsInBheW1lbnQiLCJpbnRlZ3JhdGlvbiIsImFkbWluIiwiZ2V0IiwicmVxIiwicmVzIiwic3RhdHVzIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwic3VjY2VzcyIsImNzcmZUb2tlbiIsInNlc3Npb25JbmZvIiwiaXNHdWVzdCIsInVzZXIiLCJndWVzdElkIiwiaGFzQ2FydCIsImNhcnQiLCJpdGVtcyIsImxlbmd0aCIsInZlcnNpb24iLCJlbmRwb2ludHMiLCJoZWFsdGgiLCJwcm9kdWN0cyIsIm9yZGVycyIsInBheW1lbnRzIiwiZnJvbnRlbmQiLCJGUk9OVEVORF9VUkwiLCJOT0RFX0VOViIsInNlbmRGaWxlIiwiam9pbiIsIl9fZGlybmFtZSIsIlBPUlQiLCJsaXN0ZW4iLCJpbmZvIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xuY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xuY29uc3QgY29ycyA9IHJlcXVpcmUoJ2NvcnMnKTtcbmNvbnN0IGhlbG1ldCA9IHJlcXVpcmUoJ2hlbG1ldCcpO1xuY29uc3QgcmF0ZUxpbWl0ID0gcmVxdWlyZSgnZXhwcmVzcy1yYXRlLWxpbWl0Jyk7XG5jb25zdCBzZXNzaW9uID0gcmVxdWlyZSgnZXhwcmVzcy1zZXNzaW9uJyk7XG5jb25zdCBNb25nb1N0b3JlID0gcmVxdWlyZSgnY29ubmVjdC1tb25nbycpO1xuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcbnJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZygpO1xuXG4vLyBJbXBvcnQgbG9nZ2luZyBhbmQgZXJyb3IgaGFuZGxpbmdcbmNvbnN0IHsgbG9nZ2VyIH0gPSByZXF1aXJlKCcuL3V0aWxzL2xvZ2dlcicpO1xuY29uc3QgeyBnbG9iYWxFcnJvckhhbmRsZXIgfSA9IHJlcXVpcmUoJy4vbWlkZGxld2FyZS9lcnJvckhhbmRsZXInKTtcbmNvbnN0IHsgXG4gIGdlbmVyYXRlQ1NSRlRva2VuLCBcbiAgY3NyZlByb3RlY3Rpb24sIFxuICByYXRlTGltaXRzLCBcbiAgc3BlZWRMaW1pdGVyLCBcbiAgc2FuaXRpemVJbnB1dCwgXG4gIHNlY3VyaXR5SGVhZGVycyBcbn0gPSByZXF1aXJlKCcuL21pZGRsZXdhcmUvc2VjdXJpdHknKTtcblxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xuXG4vLyBTZWN1cml0eSBtaWRkbGV3YXJlXG5hcHAudXNlKGhlbG1ldCgpKTtcbmFwcC51c2Uoc2VjdXJpdHlIZWFkZXJzKTtcbmFwcC51c2UoY29ycyh7XG4gIG9yaWdpbjogcHJvY2Vzcy5lbnYuQUxMT1dFRF9PUklHSU5TPy5zcGxpdCgnLCcpIHx8IFsnaHR0cDovL2xvY2FsaG9zdDozMDAwJywgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMScsICdodHRwOi8vbG9jYWxob3N0OjMwMDMnLCAnaHR0cDovL2xvY2FsaG9zdDo1MTczJ10sXG4gIGNyZWRlbnRpYWxzOiB0cnVlXG59KSk7XG5cbi8vIElucHV0IHNhbml0aXphdGlvblxuYXBwLnVzZShzYW5pdGl6ZUlucHV0KTtcblxuLy8gR2VuZXJhbCByYXRlIGxpbWl0aW5nXG5hcHAudXNlKHJhdGVMaW1pdHMuZ2VuZXJhbCk7XG5cbi8vIFNwZWVkIGxpbWl0aW5nIGZvciBicnV0ZSBmb3JjZSBwcm90ZWN0aW9uXG5hcHAudXNlKHNwZWVkTGltaXRlcik7XG5cbi8vIEltcG9ydCB1bmlmaWVkIHNlc3Npb24vQ1NSRiBtYW5hZ2VtZW50XG5jb25zdCB7IFxuICBjcmVhdGVTZXNzaW9uQ29uZmlnLCBcbiAgZ2VuZXJhdGVDU1JGVG9rZW46IHVuaWZpZWRDU1JGVG9rZW4sXG4gIGVuaGFuY2VHdWVzdFNlc3Npb24sXG4gIGNsZWFudXBHdWVzdFNlc3Npb24gXG59ID0gcmVxdWlyZSgnLi9taWRkbGV3YXJlL3Nlc3Npb25DU1JGJyk7XG5cbi8vIFNlc3Npb24gbWlkZGxld2FyZSB3aXRoIHVuaWZpZWQgY29uZmlnXG5jb25zdCBtb25nb1VybCA9IHByb2Nlc3MuZW52Lk1PTkdPREJfVVJJIHx8ICdtb25nb2RiOi8vbG9jYWxob3N0OjI3MDE3L2hvbGlzdGljLXN0b3JlJztcbmFwcC51c2Uoc2Vzc2lvbihjcmVhdGVTZXNzaW9uQ29uZmlnKG1vbmdvVXJsKSkpO1xuXG4vLyBTZXNzaW9uIGVuaGFuY2VtZW50IG1pZGRsZXdhcmVcbmFwcC51c2UodW5pZmllZENTUkZUb2tlbik7XG5hcHAudXNlKGVuaGFuY2VHdWVzdFNlc3Npb24pO1xuYXBwLnVzZShjbGVhbnVwR3Vlc3RTZXNzaW9uKTtcblxuLy8gQm9keSBwYXJzaW5nIG1pZGRsZXdhcmVcbmFwcC51c2UoZXhwcmVzcy5qc29uKHsgbGltaXQ6ICcxMG1iJyB9KSk7XG5hcHAudXNlKGV4cHJlc3MudXJsZW5jb2RlZCh7IGV4dGVuZGVkOiB0cnVlIH0pKTtcblxuLy8gU3RhdGljIGZpbGVzXG5hcHAudXNlKCcvdXBsb2FkcycsIGV4cHJlc3Muc3RhdGljKCd1cGxvYWRzJykpO1xuYXBwLnVzZShleHByZXNzLnN0YXRpYygncHVibGljJykpO1xuXG4vLyBEYXRhYmFzZSBjb25uZWN0aW9uXG5tb25nb29zZS5jb25uZWN0KHByb2Nlc3MuZW52Lk1PTkdPREJfVVJJIHx8ICdtb25nb2RiOi8vbG9jYWxob3N0OjI3MDE3L2hvbGlzdGljLXN0b3JlJywge1xuICB1c2VOZXdVcmxQYXJzZXI6IHRydWUsXG4gIHVzZVVuaWZpZWRUb3BvbG9neTogdHJ1ZSxcbn0pLnRoZW4oKCkgPT4ge1xuICBjb25zb2xlLmxvZygnQ29ubmVjdGVkIHRvIE1vbmdvREInKTtcbn0pLmNhdGNoKChlcnJvcikgPT4ge1xuICBjb25zb2xlLndhcm4oJ01vbmdvREIgY29ubmVjdGlvbiBmYWlsZWQ6JywgZXJyb3IubWVzc2FnZSk7XG4gIGNvbnNvbGUud2FybignUnVubmluZyBpbiBkZXZlbG9wbWVudCBtb2RlIHdpdGhvdXQgZGF0YWJhc2UnKTtcbn0pO1xuXG4vLyBIYW5kbGUgTW9uZ29EQiBjb25uZWN0aW9uIGV2ZW50c1xubW9uZ29vc2UuY29ubmVjdGlvbi5vbignZXJyb3InLCAoZXJyb3IpID0+IHtcbiAgY29uc29sZS53YXJuKCdNb25nb0RCIGNvbm5lY3Rpb24gZXJyb3I6JywgZXJyb3IubWVzc2FnZSk7XG59KTtcblxubW9uZ29vc2UuY29ubmVjdGlvbi5vbignZGlzY29ubmVjdGVkJywgKCkgPT4ge1xuICBjb25zb2xlLndhcm4oJ01vbmdvREIgZGlzY29ubmVjdGVkJyk7XG59KTtcblxuLy8gUm91dGVzIHdpdGggc3BlY2lmaWMgcmF0ZSBsaW1pdGluZ1xuYXBwLnVzZSgnL2FwaS9hdXRoJywgcmF0ZUxpbWl0cy5hdXRoLCByZXF1aXJlKCcuL3JvdXRlcy9hdXRoJykpO1xuYXBwLnVzZSgnL2FwaS9wcm9kdWN0cycsIHJlcXVpcmUoJy4vcm91dGVzL3Byb2R1Y3RzJykpO1xuYXBwLnVzZSgnL2FwaS9jYXJ0JywgY3NyZlByb3RlY3Rpb24sIHJlcXVpcmUoJy4vcm91dGVzL2NhcnQnKSk7XG5hcHAudXNlKCcvYXBpL29yZGVycycsIGNzcmZQcm90ZWN0aW9uLCByZXF1aXJlKCcuL3JvdXRlcy9vcmRlcnMnKSk7XG5hcHAudXNlKCcvYXBpL3BheW1lbnRzJywgcmF0ZUxpbWl0cy5wYXltZW50LCBjc3JmUHJvdGVjdGlvbiwgcmVxdWlyZSgnLi9yb3V0ZXMvcGF5bWVudHMnKSk7XG5hcHAudXNlKCcvYXBpL3dob2xlc2FsZXJzJywgcmVxdWlyZSgnLi9yb3V0ZXMvd2hvbGVzYWxlcnMnKSk7XG5hcHAudXNlKCcvYXBpL2ludGVncmF0aW9uJywgcmF0ZUxpbWl0cy5pbnRlZ3JhdGlvbiwgcmVxdWlyZSgnLi9yb3V0ZXMvaW50ZWdyYXRpb24nKSk7XG5hcHAudXNlKCcvYXBpL2FkbWluJywgcmF0ZUxpbWl0cy5hZG1pbiwgY3NyZlByb3RlY3Rpb24sIHJlcXVpcmUoJy4vcm91dGVzL2FkbWluJykpO1xuYXBwLnVzZSgnL2FwaS9tb25pdG9yaW5nJywgcmVxdWlyZSgnLi9yb3V0ZXMvbW9uaXRvcmluZycpKTtcblxuLy8gSGVhbHRoIGNoZWNrXG5hcHAuZ2V0KCcvaGVhbHRoJywgKHJlcSwgcmVzKSA9PiB7XG4gIHJlcy5qc29uKHsgc3RhdHVzOiAnT0snLCB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSB9KTtcbn0pO1xuXG4vLyBDU1JGIHRva2VuIGVuZHBvaW50XG5hcHAuZ2V0KCcvYXBpL2NzcmYtdG9rZW4nLCAocmVxLCByZXMpID0+IHtcbiAgcmVzLmpzb24oeyBcbiAgICBzdWNjZXNzOiB0cnVlLFxuICAgIGNzcmZUb2tlbjogcmVxLnNlc3Npb24uY3NyZlRva2VuLFxuICAgIHNlc3Npb25JbmZvOiB7XG4gICAgICBpc0d1ZXN0OiAhcmVxLnVzZXIgJiYgISFyZXEuc2Vzc2lvbi5ndWVzdElkLFxuICAgICAgaGFzQ2FydDogISFyZXEuc2Vzc2lvbi5jYXJ0ICYmIHJlcS5zZXNzaW9uLmNhcnQuaXRlbXMubGVuZ3RoID4gMFxuICAgIH1cbiAgfSk7XG59KTtcblxuLy8gUm9vdCByb3V0ZSBmb3IgQVBJIGluZm9cbmFwcC5nZXQoJy8nLCAocmVxLCByZXMpID0+IHtcbiAgcmVzLmpzb24oe1xuICAgIG1lc3NhZ2U6ICdIb2xpc3RpYyBEcm9wc2hpcCBTdG9yZSBBUEknLFxuICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgZW5kcG9pbnRzOiB7XG4gICAgICBoZWFsdGg6ICcvaGVhbHRoJyxcbiAgICAgIGF1dGg6ICcvYXBpL2F1dGgnLFxuICAgICAgcHJvZHVjdHM6ICcvYXBpL3Byb2R1Y3RzJyxcbiAgICAgIGNhcnQ6ICcvYXBpL2NhcnQnLFxuICAgICAgb3JkZXJzOiAnL2FwaS9vcmRlcnMnLFxuICAgICAgcGF5bWVudHM6ICcvYXBpL3BheW1lbnRzJ1xuICAgIH0sXG4gICAgZnJvbnRlbmQ6IHByb2Nlc3MuZW52LkZST05URU5EX1VSTCB8fCAnaHR0cDovL2xvY2FsaG9zdDozMDAwJ1xuICB9KTtcbn0pO1xuXG4vLyBHbG9iYWwgZXJyb3IgaGFuZGxpbmcgbWlkZGxld2FyZSAobXVzdCBiZSBsYXN0KVxuYXBwLnVzZShnbG9iYWxFcnJvckhhbmRsZXIpO1xuXG4vLyBTZXJ2ZSBSZWFjdCBhcHAgaW4gcHJvZHVjdGlvblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicpIHtcbiAgYXBwLmdldCgnKicsIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5zZW5kRmlsZShwYXRoLmpvaW4oX19kaXJuYW1lLCAnYnVpbGQnLCAnaW5kZXguaHRtbCcpKTtcbiAgfSk7XG59XG5cbmNvbnN0IFBPUlQgPSBwcm9jZXNzLmVudi5QT1JUIHx8IDUwMDA7XG5cbi8vIE9ubHkgc3RhcnQgc2VydmVyIGlmIG5vdCBpbiB0ZXN0IG1vZGVcbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Rlc3QnKSB7XG4gIGFwcC5saXN0ZW4oUE9SVCwgKCkgPT4ge1xuICAgIGxvZ2dlci5pbmZvKGBTZXJ2ZXIgcnVubmluZyBvbiBwb3J0ICR7UE9SVH1gKTtcbiAgfSk7XG59XG5cbi8vIEV4cG9ydCBhcHAgZm9yIHRlc3Rpbmdcbm1vZHVsZS5leHBvcnRzID0gYXBwOyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsU0FBUyxDQUFDO0FBQ2xDLE1BQU1DLFFBQVEsR0FBR0QsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUNwQyxNQUFNRSxJQUFJLEdBQUdGLE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFDNUIsTUFBTUcsTUFBTSxHQUFHSCxPQUFPLENBQUMsUUFBUSxDQUFDO0FBQ2hDLE1BQU1JLFNBQVMsR0FBR0osT0FBTyxDQUFDLG9CQUFvQixDQUFDO0FBQy9DLE1BQU1LLE9BQU8sR0FBR0wsT0FBTyxDQUFDLGlCQUFpQixDQUFDO0FBQzFDLE1BQU1NLFVBQVUsR0FBR04sT0FBTyxDQUFDLGVBQWUsQ0FBQztBQUMzQyxNQUFNTyxJQUFJLEdBQUdQLE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFDNUJBLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQ1EsTUFBTSxDQUFDLENBQUM7O0FBRTFCO0FBQ0EsTUFBTTtFQUFFQztBQUFPLENBQUMsR0FBR1QsT0FBTyxDQUFDLGdCQUFnQixDQUFDO0FBQzVDLE1BQU07RUFBRVU7QUFBbUIsQ0FBQyxHQUFHVixPQUFPLENBQUMsMkJBQTJCLENBQUM7QUFDbkUsTUFBTTtFQUNKVyxpQkFBaUI7RUFDakJDLGNBQWM7RUFDZEMsVUFBVTtFQUNWQyxZQUFZO0VBQ1pDLGFBQWE7RUFDYkM7QUFDRixDQUFDLEdBQUdoQixPQUFPLENBQUMsdUJBQXVCLENBQUM7QUFFcEMsTUFBTWlCLEdBQUcsR0FBR2xCLE9BQU8sQ0FBQyxDQUFDOztBQUVyQjtBQUNBa0IsR0FBRyxDQUFDQyxHQUFHLENBQUNmLE1BQU0sQ0FBQyxDQUFDLENBQUM7QUFDakJjLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDRixlQUFlLENBQUM7QUFDeEJDLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDaEIsSUFBSSxDQUFDO0VBQ1hpQixNQUFNLEVBQUVDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxlQUFlLEVBQUVDLEtBQUssQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLHVCQUF1QixFQUFFLHVCQUF1QixFQUFFLHVCQUF1QixFQUFFLHVCQUF1QixDQUFDO0VBQ3ZKQyxXQUFXLEVBQUU7QUFDZixDQUFDLENBQUMsQ0FBQzs7QUFFSDtBQUNBUCxHQUFHLENBQUNDLEdBQUcsQ0FBQ0gsYUFBYSxDQUFDOztBQUV0QjtBQUNBRSxHQUFHLENBQUNDLEdBQUcsQ0FBQ0wsVUFBVSxDQUFDWSxPQUFPLENBQUM7O0FBRTNCO0FBQ0FSLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDSixZQUFZLENBQUM7O0FBRXJCO0FBQ0EsTUFBTTtFQUNKWSxtQkFBbUI7RUFDbkJmLGlCQUFpQixFQUFFZ0IsZ0JBQWdCO0VBQ25DQyxtQkFBbUI7RUFDbkJDO0FBQ0YsQ0FBQyxHQUFHN0IsT0FBTyxDQUFDLDBCQUEwQixDQUFDOztBQUV2QztBQUNBLE1BQU04QixRQUFRLEdBQUdWLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDVSxXQUFXLElBQUksMENBQTBDO0FBQ3RGZCxHQUFHLENBQUNDLEdBQUcsQ0FBQ2IsT0FBTyxDQUFDcUIsbUJBQW1CLENBQUNJLFFBQVEsQ0FBQyxDQUFDLENBQUM7O0FBRS9DO0FBQ0FiLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDUyxnQkFBZ0IsQ0FBQztBQUN6QlYsR0FBRyxDQUFDQyxHQUFHLENBQUNVLG1CQUFtQixDQUFDO0FBQzVCWCxHQUFHLENBQUNDLEdBQUcsQ0FBQ1csbUJBQW1CLENBQUM7O0FBRTVCO0FBQ0FaLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDbkIsT0FBTyxDQUFDaUMsSUFBSSxDQUFDO0VBQUVDLEtBQUssRUFBRTtBQUFPLENBQUMsQ0FBQyxDQUFDO0FBQ3hDaEIsR0FBRyxDQUFDQyxHQUFHLENBQUNuQixPQUFPLENBQUNtQyxVQUFVLENBQUM7RUFBRUMsUUFBUSxFQUFFO0FBQUssQ0FBQyxDQUFDLENBQUM7O0FBRS9DO0FBQ0FsQixHQUFHLENBQUNDLEdBQUcsQ0FBQyxVQUFVLEVBQUVuQixPQUFPLENBQUNxQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDOUNuQixHQUFHLENBQUNDLEdBQUcsQ0FBQ25CLE9BQU8sQ0FBQ3FDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQzs7QUFFakM7QUFDQW5DLFFBQVEsQ0FBQ29DLE9BQU8sQ0FBQ2pCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDVSxXQUFXLElBQUksMENBQTBDLEVBQUU7RUFDdEZPLGVBQWUsRUFBRSxJQUFJO0VBQ3JCQyxrQkFBa0IsRUFBRTtBQUN0QixDQUFDLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLE1BQU07RUFDWkMsT0FBTyxDQUFDQyxHQUFHLENBQUMsc0JBQXNCLENBQUM7QUFDckMsQ0FBQyxDQUFDLENBQUNDLEtBQUssQ0FBRUMsS0FBSyxJQUFLO0VBQ2xCSCxPQUFPLENBQUNJLElBQUksQ0FBQyw0QkFBNEIsRUFBRUQsS0FBSyxDQUFDRSxPQUFPLENBQUM7RUFDekRMLE9BQU8sQ0FBQ0ksSUFBSSxDQUFDLDhDQUE4QyxDQUFDO0FBQzlELENBQUMsQ0FBQzs7QUFFRjtBQUNBNUMsUUFBUSxDQUFDOEMsVUFBVSxDQUFDQyxFQUFFLENBQUMsT0FBTyxFQUFHSixLQUFLLElBQUs7RUFDekNILE9BQU8sQ0FBQ0ksSUFBSSxDQUFDLDJCQUEyQixFQUFFRCxLQUFLLENBQUNFLE9BQU8sQ0FBQztBQUMxRCxDQUFDLENBQUM7QUFFRjdDLFFBQVEsQ0FBQzhDLFVBQVUsQ0FBQ0MsRUFBRSxDQUFDLGNBQWMsRUFBRSxNQUFNO0VBQzNDUCxPQUFPLENBQUNJLElBQUksQ0FBQyxzQkFBc0IsQ0FBQztBQUN0QyxDQUFDLENBQUM7O0FBRUY7QUFDQTVCLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDLFdBQVcsRUFBRUwsVUFBVSxDQUFDb0MsSUFBSSxFQUFFakQsT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBQy9EaUIsR0FBRyxDQUFDQyxHQUFHLENBQUMsZUFBZSxFQUFFbEIsT0FBTyxDQUFDLG1CQUFtQixDQUFDLENBQUM7QUFDdERpQixHQUFHLENBQUNDLEdBQUcsQ0FBQyxXQUFXLEVBQUVOLGNBQWMsRUFBRVosT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBQzlEaUIsR0FBRyxDQUFDQyxHQUFHLENBQUMsYUFBYSxFQUFFTixjQUFjLEVBQUVaLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0FBQ2xFaUIsR0FBRyxDQUFDQyxHQUFHLENBQUMsZUFBZSxFQUFFTCxVQUFVLENBQUNxQyxPQUFPLEVBQUV0QyxjQUFjLEVBQUVaLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO0FBQzFGaUIsR0FBRyxDQUFDQyxHQUFHLENBQUMsa0JBQWtCLEVBQUVsQixPQUFPLENBQUMsc0JBQXNCLENBQUMsQ0FBQztBQUM1RGlCLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDLGtCQUFrQixFQUFFTCxVQUFVLENBQUNzQyxXQUFXLEVBQUVuRCxPQUFPLENBQUMsc0JBQXNCLENBQUMsQ0FBQztBQUNwRmlCLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDLFlBQVksRUFBRUwsVUFBVSxDQUFDdUMsS0FBSyxFQUFFeEMsY0FBYyxFQUFFWixPQUFPLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztBQUNsRmlCLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDLGlCQUFpQixFQUFFbEIsT0FBTyxDQUFDLHFCQUFxQixDQUFDLENBQUM7O0FBRTFEO0FBQ0FpQixHQUFHLENBQUNvQyxHQUFHLENBQUMsU0FBUyxFQUFFLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0VBQy9CQSxHQUFHLENBQUN2QixJQUFJLENBQUM7SUFBRXdCLE1BQU0sRUFBRSxJQUFJO0lBQUVDLFNBQVMsRUFBRSxJQUFJQyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxXQUFXLENBQUM7RUFBRSxDQUFDLENBQUM7QUFDakUsQ0FBQyxDQUFDOztBQUVGO0FBQ0ExQyxHQUFHLENBQUNvQyxHQUFHLENBQUMsaUJBQWlCLEVBQUUsQ0FBQ0MsR0FBRyxFQUFFQyxHQUFHLEtBQUs7RUFDdkNBLEdBQUcsQ0FBQ3ZCLElBQUksQ0FBQztJQUNQNEIsT0FBTyxFQUFFLElBQUk7SUFDYkMsU0FBUyxFQUFFUCxHQUFHLENBQUNqRCxPQUFPLENBQUN3RCxTQUFTO0lBQ2hDQyxXQUFXLEVBQUU7TUFDWEMsT0FBTyxFQUFFLENBQUNULEdBQUcsQ0FBQ1UsSUFBSSxJQUFJLENBQUMsQ0FBQ1YsR0FBRyxDQUFDakQsT0FBTyxDQUFDNEQsT0FBTztNQUMzQ0MsT0FBTyxFQUFFLENBQUMsQ0FBQ1osR0FBRyxDQUFDakQsT0FBTyxDQUFDOEQsSUFBSSxJQUFJYixHQUFHLENBQUNqRCxPQUFPLENBQUM4RCxJQUFJLENBQUNDLEtBQUssQ0FBQ0MsTUFBTSxHQUFHO0lBQ2pFO0VBQ0YsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDOztBQUVGO0FBQ0FwRCxHQUFHLENBQUNvQyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0VBQ3pCQSxHQUFHLENBQUN2QixJQUFJLENBQUM7SUFDUGMsT0FBTyxFQUFFLDZCQUE2QjtJQUN0Q3dCLE9BQU8sRUFBRSxPQUFPO0lBQ2hCQyxTQUFTLEVBQUU7TUFDVEMsTUFBTSxFQUFFLFNBQVM7TUFDakJ2QixJQUFJLEVBQUUsV0FBVztNQUNqQndCLFFBQVEsRUFBRSxlQUFlO01BQ3pCTixJQUFJLEVBQUUsV0FBVztNQUNqQk8sTUFBTSxFQUFFLGFBQWE7TUFDckJDLFFBQVEsRUFBRTtJQUNaLENBQUM7SUFDREMsUUFBUSxFQUFFeEQsT0FBTyxDQUFDQyxHQUFHLENBQUN3RCxZQUFZLElBQUk7RUFDeEMsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDOztBQUVGO0FBQ0E1RCxHQUFHLENBQUNDLEdBQUcsQ0FBQ1Isa0JBQWtCLENBQUM7O0FBRTNCO0FBQ0EsSUFBSVUsT0FBTyxDQUFDQyxHQUFHLENBQUN5RCxRQUFRLEtBQUssWUFBWSxFQUFFO0VBQ3pDN0QsR0FBRyxDQUFDb0MsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztJQUN6QkEsR0FBRyxDQUFDd0IsUUFBUSxDQUFDeEUsSUFBSSxDQUFDeUUsSUFBSSxDQUFDQyxTQUFTLEVBQUUsT0FBTyxFQUFFLFlBQVksQ0FBQyxDQUFDO0VBQzNELENBQUMsQ0FBQztBQUNKO0FBRUEsTUFBTUMsSUFBSSxHQUFHOUQsT0FBTyxDQUFDQyxHQUFHLENBQUM2RCxJQUFJLElBQUksSUFBSTs7QUFFckM7QUFDQSxJQUFJOUQsT0FBTyxDQUFDQyxHQUFHLENBQUN5RCxRQUFRLEtBQUssTUFBTSxFQUFFO0VBQ25DN0QsR0FBRyxDQUFDa0UsTUFBTSxDQUFDRCxJQUFJLEVBQUUsTUFBTTtJQUNyQnpFLE1BQU0sQ0FBQzJFLElBQUksQ0FBQywwQkFBMEJGLElBQUksRUFBRSxDQUFDO0VBQy9DLENBQUMsQ0FBQztBQUNKOztBQUVBO0FBQ0FHLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHckUsR0FBRyIsImlnbm9yZUxpc3QiOltdfQ==